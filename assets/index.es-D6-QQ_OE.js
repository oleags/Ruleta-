const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DP9hJ037.js","assets/index-DbH5oKC4.js","assets/index-DJ80Wnr6.css"])))=>i.map(i=>d[i]);
import{m as Li,o as ec,q as Mo,t as nw,k as Lo,l as sw,v as Z0,G as Pd,_ as aw}from"./index-DbH5oKC4.js";import{i as ow,b as cw,a as hw,c as fw,d as uw,e as dw,f as lw,g as pw,h as gw,j as vw,k as be,l as bw,w as dg,r as Ha,m as mw,n as Rd,o as lg,s as Yh,x as pg,H as yw,p as gg,q as Dh,t as ww}from"./json-CTFUaiU0.js";import{r as vg}from"./___vite-browser-external_commonjs-proxy-CVMhx6uY.js";import{i as Xh}from"./inherits_browser-BlmhoU4v.js";var ep=function(r,e,t){if(t||arguments.length===2)for(var i=0,s=e.length,a;i<s;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return r.concat(a||Array.prototype.slice.call(e))},_w=function(){function r(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return r}(),Aw=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),xw=function(){function r(e,t,i,s){this.name=e,this.version=t,this.os=i,this.bot=s,this.type="bot-device"}return r}(),Iw=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),Ew=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),Mw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Sw=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,tp=3,Pw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Mw]],rp=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Rw(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Ew:typeof navigator<"u"?Cw(navigator.userAgent):Tw()}function Nw(r){return r!==""&&Pw.reduce(function(e,t){var i=t[0],s=t[1];if(e)return e;var a=s.exec(r);return!!a&&[i,a]},!1)}function Cw(r){var e=Nw(r);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new Iw;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<tp&&(s=ep(ep([],s,!0),qw(tp-s.length),!0)):s=[];var a=s.join("."),h=Ow(r),p=Sw.exec(r);return p&&p[1]?new xw(t,a,h,p[1]):new _w(t,a,h)}function Ow(r){for(var e=0,t=rp.length;e<t;e++){var i=rp[e],s=i[0],a=i[1],h=a.exec(r);if(h)return s}return null}function Tw(){var r=typeof process<"u"&&process.version;return r?new Aw(process.version.slice(1)):null}function qw(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}function bg(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Eh(r,e){e||(e=r.reduce((s,a)=>s+a.length,0));const t=bg(e);let i=0;for(const s of r)t.set(s,i),i+=s.length;return t}const ip={...ow,...cw,...hw,...fw,...uw,...dw,...lw,...pw,...gw,...vw};function mg(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const np=mg("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Su=mg("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=bg(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),yg={utf8:np,"utf-8":np,hex:ip.base16,latin1:Su,ascii:Su,binary:Su,...ip};function yr(r,e="utf8"){const t=yg[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function wr(r,e="utf8"){const t=yg[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const Dw=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Bw=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,$w=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function kw(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Lw(r);return}return e}function Lw(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function lh(r,e={}){if(typeof r!="string")return r;const t=r.trim();if(r[0]==='"'&&r.endsWith('"')&&!r.includes("\\"))return t.slice(1,-1);if(t.length<=9){const i=t.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!$w.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(Dw.test(r)||Bw.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,kw)}return JSON.parse(r)}catch(i){if(e.strict)throw i;return r}}function zw(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function mr(r,...e){try{return zw(r(...e))}catch(t){return Promise.reject(t)}}function Uw(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function jw(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Mh(r){if(Uw(r))return String(r);if(jw(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Mh(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function wg(){if(typeof Buffer>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const fd="base64:";function Fw(r){if(typeof r=="string")return r;wg();const e=Buffer.from(r).toString("base64");return fd+e}function Kw(r){return typeof r!="string"||!r.startsWith(fd)?r:(wg(),Buffer.from(r.slice(fd.length),"base64"))}function ii(r){return r?r.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Hw(...r){return ii(r.join(":"))}function ph(r){return r=ii(r),r?r+":":""}const Vw="memory",Gw=()=>{const r=new Map;return{name:Vw,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function Jw(r={}){const e={mounts:{"":r.driver||Gw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=v=>{for(const _ of e.mountpoints)if(v.startsWith(_))return{base:_,relativeKey:v.slice(_.length),driver:e.mounts[_]};return{base:"",relativeKey:v,driver:e.mounts[""]}},i=(v,_)=>e.mountpoints.filter(I=>I.startsWith(v)||_&&v.startsWith(I)).map(I=>({relativeBase:v.length>I.length?v.slice(I.length):void 0,mountpoint:I,driver:e.mounts[I]})),s=(v,_)=>{if(e.watching){_=ii(_);for(const I of e.watchListeners)I(v,_)}},a=async()=>{if(!e.watching){e.watching=!0;for(const v in e.mounts)e.unwatch[v]=await sp(e.mounts[v],s,v)}},h=async()=>{if(e.watching){for(const v in e.unwatch)await e.unwatch[v]();e.unwatch={},e.watching=!1}},p=(v,_,I)=>{const N=new Map,O=q=>{let j=N.get(q.base);return j||(j={driver:q.driver,base:q.base,items:[]},N.set(q.base,j)),j};for(const q of v){const j=typeof q=="string",K=ii(j?q:q.key),J=j?void 0:q.value,Z=j||!q.options?_:{..._,...q.options},de=t(K);O(de).items.push({key:K,value:J,relativeKey:de.relativeKey,options:Z})}return Promise.all([...N.values()].map(q=>I(q))).then(q=>q.flat())},m={hasItem(v,_={}){v=ii(v);const{relativeKey:I,driver:N}=t(v);return mr(N.hasItem,I,_)},getItem(v,_={}){v=ii(v);const{relativeKey:I,driver:N}=t(v);return mr(N.getItem,I,_).then(O=>lh(O))},getItems(v,_){return p(v,_,I=>I.driver.getItems?mr(I.driver.getItems,I.items.map(N=>({key:N.relativeKey,options:N.options})),_).then(N=>N.map(O=>({key:Hw(I.base,O.key),value:lh(O.value)}))):Promise.all(I.items.map(N=>mr(I.driver.getItem,N.relativeKey,N.options).then(O=>({key:N.key,value:lh(O)})))))},getItemRaw(v,_={}){v=ii(v);const{relativeKey:I,driver:N}=t(v);return N.getItemRaw?mr(N.getItemRaw,I,_):mr(N.getItem,I,_).then(O=>Kw(O))},async setItem(v,_,I={}){if(_===void 0)return m.removeItem(v);v=ii(v);const{relativeKey:N,driver:O}=t(v);O.setItem&&(await mr(O.setItem,N,Mh(_),I),O.watch||s("update",v))},async setItems(v,_){await p(v,_,async I=>{if(I.driver.setItems)return mr(I.driver.setItems,I.items.map(N=>({key:N.relativeKey,value:Mh(N.value),options:N.options})),_);I.driver.setItem&&await Promise.all(I.items.map(N=>mr(I.driver.setItem,N.relativeKey,Mh(N.value),N.options)))})},async setItemRaw(v,_,I={}){if(_===void 0)return m.removeItem(v,I);v=ii(v);const{relativeKey:N,driver:O}=t(v);if(O.setItemRaw)await mr(O.setItemRaw,N,_,I);else if(O.setItem)await mr(O.setItem,N,Fw(_),I);else return;O.watch||s("update",v)},async removeItem(v,_={}){typeof _=="boolean"&&(_={removeMeta:_}),v=ii(v);const{relativeKey:I,driver:N}=t(v);N.removeItem&&(await mr(N.removeItem,I,_),(_.removeMeta||_.removeMata)&&await mr(N.removeItem,I+"$",_),N.watch||s("remove",v))},async getMeta(v,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),v=ii(v);const{relativeKey:I,driver:N}=t(v),O=Object.create(null);if(N.getMeta&&Object.assign(O,await mr(N.getMeta,I,_)),!_.nativeOnly){const q=await mr(N.getItem,I+"$",_).then(j=>lh(j));q&&typeof q=="object"&&(typeof q.atime=="string"&&(q.atime=new Date(q.atime)),typeof q.mtime=="string"&&(q.mtime=new Date(q.mtime)),Object.assign(O,q))}return O},setMeta(v,_,I={}){return this.setItem(v+"$",_,I)},removeMeta(v,_={}){return this.removeItem(v+"$",_)},async getKeys(v,_={}){v=ph(v);const I=i(v,!0);let N=[];const O=[];for(const q of I){const j=await mr(q.driver.getKeys,q.relativeBase,_);for(const K of j){const J=q.mountpoint+ii(K);N.some(Z=>J.startsWith(Z))||O.push(J)}N=[q.mountpoint,...N.filter(K=>!K.startsWith(q.mountpoint))]}return v?O.filter(q=>q.startsWith(v)&&q[q.length-1]!=="$"):O.filter(q=>q[q.length-1]!=="$")},async clear(v,_={}){v=ph(v),await Promise.all(i(v,!1).map(async I=>{if(I.driver.clear)return mr(I.driver.clear,I.relativeBase,_);if(I.driver.removeItem){const N=await I.driver.getKeys(I.relativeBase||"",_);return Promise.all(N.map(O=>I.driver.removeItem(O,_)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(v=>ap(v)))},async watch(v){return await a(),e.watchListeners.push(v),async()=>{e.watchListeners=e.watchListeners.filter(_=>_!==v),e.watchListeners.length===0&&await h()}},async unwatch(){e.watchListeners=[],await h()},mount(v,_){if(v=ph(v),v&&e.mounts[v])throw new Error(`already mounted at ${v}`);return v&&(e.mountpoints.push(v),e.mountpoints.sort((I,N)=>N.length-I.length)),e.mounts[v]=_,e.watching&&Promise.resolve(sp(_,s,v)).then(I=>{e.unwatch[v]=I}).catch(console.error),m},async unmount(v,_=!0){v=ph(v),!(!v||!e.mounts[v])&&(e.watching&&v in e.unwatch&&(e.unwatch[v](),delete e.unwatch[v]),_&&await ap(e.mounts[v]),e.mountpoints=e.mountpoints.filter(I=>I!==v),delete e.mounts[v])},getMount(v=""){v=ii(v)+":";const _=t(v);return{driver:_.driver,base:_.base}},getMounts(v="",_={}){return v=ii(v),i(v,_.parents).map(N=>({driver:N.driver,base:N.mountpoint}))},keys:(v,_={})=>m.getKeys(v,_),get:(v,_={})=>m.getItem(v,_),set:(v,_,I={})=>m.setItem(v,_,I),has:(v,_={})=>m.hasItem(v,_),del:(v,_={})=>m.removeItem(v,_),remove:(v,_={})=>m.removeItem(v,_)};return m}function sp(r,e,t){return r.watch?r.watch((i,s)=>e(i,t+s)):()=>{}}async function ap(r){typeof r.dispose=="function"&&await mr(r.dispose)}function sa(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function _g(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const i=sa(t);return(s,a)=>i.then(h=>a(h.transaction(e,s).objectStore(e)))}let Pu;function tc(){return Pu||(Pu=_g("keyval-store","keyval")),Pu}function op(r,e=tc()){return e("readonly",t=>sa(t.get(r)))}function Ww(r,e,t=tc()){return t("readwrite",i=>(i.put(e,r),sa(i.transaction)))}function Qw(r,e=tc()){return e("readwrite",t=>(t.delete(r),sa(t.transaction)))}function Yw(r=tc()){return r("readwrite",e=>(e.clear(),sa(e.transaction)))}function Xw(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},sa(r.transaction)}function Zw(r=tc()){return r("readonly",e=>{if(e.getAllKeys)return sa(e.getAllKeys());const t=[];return Xw(e,i=>t.push(i.key)).then(()=>t)})}const e4=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),t4=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(i,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function ta(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return t4(r)}catch{return r}}function as(r){return typeof r=="string"?r:e4(r)||""}const r4="idb-keyval";var i4=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let i;return r.dbName&&r.storeName&&(i=_g(r.dbName,r.storeName)),{name:r4,options:r,async hasItem(s){return!(typeof await op(t(s),i)>"u")},async getItem(s){return await op(t(s),i)??null},setItem(s,a){return Ww(t(s),a,i)},removeItem(s){return Qw(t(s),i)},getKeys(){return Zw(i)},clear(){return Yw(i)}}};const n4="WALLET_CONNECT_V2_INDEXED_DB",s4="keyvaluestorage";let a4=class{constructor(){this.indexedDb=Jw({driver:i4({dbName:n4,storeName:s4})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,as(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Ru=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sh={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,i){this[t]=String(i)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ru<"u"&&Ru.localStorage?Sh.exports=Ru.localStorage:typeof window<"u"&&window.localStorage?Sh.exports=window.localStorage:Sh.exports=new e})();function o4(r){var e;return[r[0],ta((e=r[1])!=null?e:"")]}let c4=class{constructor(){this.localStorage=Sh.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(o4)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return ta(t)}async setItem(e,t){this.localStorage.setItem(e,as(t))}async removeItem(e){this.localStorage.removeItem(e)}};const h4="wc_storage_version",cp=1,f4=async(r,e,t)=>{const i=h4,s=await e.getItem(i);if(s&&s>=cp){t(e);return}const a=await r.getKeys();if(!a.length){t(e);return}const h=[];for(;a.length;){const p=a.shift();if(!p)continue;const m=p.toLowerCase();if(m.includes("wc@")||m.includes("walletconnect")||m.includes("wc_")||m.includes("wallet_connect")){const v=await r.getItem(p);await e.setItem(p,v),h.push(p)}}await e.setItem(i,cp),t(e),u4(r,h)},u4=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let d4=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new c4;this.storage=e;try{const t=new a4;f4(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};class aa{}let l4=class extends aa{constructor(e){super()}};const hp=be.FIVE_SECONDS,Va={pulse:"heartbeat_pulse"};let p4=class Ag extends l4{constructor(e){super(e),this.events=new Li.EventEmitter,this.interval=hp,this.interval=(e==null?void 0:e.interval)||hp}static async init(e){const t=new Ag(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),be.toMiliseconds(this.interval))}pulse(){this.events.emit(Va.pulse)}};const g4={level:"info"},rc="custom_context",Nd=1e3*1024;let v4=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},fp=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new v4(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},xg=class{constructor(e,t=Nd){this.level=e??"error",this.levelValue=Mo.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new fp(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Mo.levels.values.error?console.error(e):t===Mo.levels.values.warn?console.warn(e):t===Mo.levels.values.debug?console.debug(e):t===Mo.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(as({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new fp(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(as({extraMetadata:e})),new Blob(t,{type:"application/json"})}},b4=class{constructor(e,t=Nd){this.baseChunkLogger=new xg(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=t,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)}};class m4{constructor(e,t=Nd){this.baseChunkLogger=new xg(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var y4=Object.defineProperty,w4=Object.defineProperties,_4=Object.getOwnPropertyDescriptors,up=Object.getOwnPropertySymbols,A4=Object.prototype.hasOwnProperty,x4=Object.prototype.propertyIsEnumerable,dp=(r,e,t)=>e in r?y4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bh=(r,e)=>{for(var t in e||(e={}))A4.call(e,t)&&dp(r,t,e[t]);if(up)for(var t of up(e))x4.call(e,t)&&dp(r,t,e[t]);return r},$h=(r,e)=>w4(r,_4(e));function Zh(r){return $h(Bh({},r),{level:(r==null?void 0:r.level)||g4.level})}function I4(r,e=rc){return r[e]||""}function E4(r,e,t=rc){return r[t]=e,r}function fi(r,e=rc){let t="";return typeof r.bindings>"u"?t=I4(r,e):t=r.bindings().context||"",t}function M4(r,e,t=rc){const i=fi(r,t);return i.trim()?`${i}/${e}`:e}function Gr(r,e,t=rc){const i=M4(r,e,t),s=r.child({context:i});return E4(s,i,t)}function S4(r){var e,t;const i=new b4((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:ec($h(Bh({},r.opts),{level:"trace",browser:$h(Bh({},(t=r.opts)==null?void 0:t.browser),{write:s=>i.write(s)})})),chunkLoggerController:i}}function P4(r){var e;const t=new m4((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:ec($h(Bh({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function R4(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?S4(r):P4(r)}var Cd={},Ig={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=bw,t=dg;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function p(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(m,v){if(v===void 0&&(v=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=v,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&v>0;)this._buffer[this._bufferLength++]=m[_++],v--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(v>=this.blockSize&&(_=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,_,v),v%=this.blockSize);v>0;)this._buffer[this._bufferLength++]=m[_++],v--;return this},p.prototype.finish=function(m){if(!this._finished){var v=this._bytesHashed,_=this._bufferLength,I=v/536870912|0,N=v<<3,O=v%128<112?128:256;this._buffer[_]=128;for(var q=_+1;q<O-8;q++)this._buffer[q]=0;e.writeUint32BE(I,this._buffer,O-8),e.writeUint32BE(N,this._buffer,O-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,O),this._finished=!0}for(var q=0;q<this.digestLength/8;q++)e.writeUint32BE(this._stateHi[q],m,q*8),e.writeUint32BE(this._stateLo[q],m,q*8+4);return this},p.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(m){t.wipe(m.stateHi),t.wipe(m.stateLo),m.buffer&&t.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},p}();r.SHA512=i;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(p,m,v,_,I,N,O){for(var q=v[0],j=v[1],K=v[2],J=v[3],Z=v[4],de=v[5],oe=v[6],re=v[7],fe=_[0],ue=_[1],le=_[2],Ae=_[3],ht=_[4],k=_[5],b=_[6],c=_[7],d,g,A,M,S,x,u,l;O>=128;){for(var R=0;R<16;R++){var X=8*R+N;p[R]=e.readUint32BE(I,X),m[R]=e.readUint32BE(I,X+4)}for(var R=0;R<80;R++){var ee=q,E=j,W=K,D=J,L=Z,z=de,y=oe,$=re,Y=fe,se=ue,ae=le,ge=Ae,ve=ht,Te=k,nt=b,Me=c;if(d=re,g=c,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=(Z>>>14|ht<<18)^(Z>>>18|ht<<14)^(ht>>>9|Z<<23),g=(ht>>>14|Z<<18)^(ht>>>18|Z<<14)^(Z>>>9|ht<<23),S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,d=Z&de^~Z&oe,g=ht&k^~ht&b,S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,d=s[R*2],g=s[R*2+1],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,d=p[R%16],g=m[R%16],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,A=u&65535|l<<16,M=S&65535|x<<16,d=A,g=M,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=(q>>>28|fe<<4)^(fe>>>2|q<<30)^(fe>>>7|q<<25),g=(fe>>>28|q<<4)^(q>>>2|fe<<30)^(q>>>7|fe<<25),S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,d=q&j^q&K^j&K,g=fe&ue^fe&le^ue&le,S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,$=u&65535|l<<16,Me=S&65535|x<<16,d=D,g=ge,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=A,g=M,S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,D=u&65535|l<<16,ge=S&65535|x<<16,j=ee,K=E,J=W,Z=D,de=L,oe=z,re=y,q=$,ue=Y,le=se,Ae=ae,ht=ge,k=ve,b=Te,c=nt,fe=Me,R%16===15)for(var X=0;X<16;X++)d=p[X],g=m[X],S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=p[(X+9)%16],g=m[(X+9)%16],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,A=p[(X+1)%16],M=m[(X+1)%16],d=(A>>>1|M<<31)^(A>>>8|M<<24)^A>>>7,g=(M>>>1|A<<31)^(M>>>8|A<<24)^(M>>>7|A<<25),S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,A=p[(X+14)%16],M=m[(X+14)%16],d=(A>>>19|M<<13)^(M>>>29|A<<3)^A>>>6,g=(M>>>19|A<<13)^(A>>>29|M<<3)^(M>>>6|A<<26),S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,p[X]=u&65535|l<<16,m[X]=S&65535|x<<16}d=q,g=fe,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[0],g=_[0],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[0]=q=u&65535|l<<16,_[0]=fe=S&65535|x<<16,d=j,g=ue,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[1],g=_[1],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[1]=j=u&65535|l<<16,_[1]=ue=S&65535|x<<16,d=K,g=le,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[2],g=_[2],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[2]=K=u&65535|l<<16,_[2]=le=S&65535|x<<16,d=J,g=Ae,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[3],g=_[3],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[3]=J=u&65535|l<<16,_[3]=Ae=S&65535|x<<16,d=Z,g=ht,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[4],g=_[4],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[4]=Z=u&65535|l<<16,_[4]=ht=S&65535|x<<16,d=de,g=k,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[5],g=_[5],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[5]=de=u&65535|l<<16,_[5]=k=S&65535|x<<16,d=oe,g=b,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[6],g=_[6],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[6]=oe=u&65535|l<<16,_[6]=b=S&65535|x<<16,d=re,g=c,S=g&65535,x=g>>>16,u=d&65535,l=d>>>16,d=v[7],g=_[7],S+=g&65535,x+=g>>>16,u+=d&65535,l+=d>>>16,x+=S>>>16,u+=x>>>16,l+=u>>>16,v[7]=re=u&65535|l<<16,_[7]=c=S&65535|x<<16,N+=128,O-=128}return N}function h(p){var m=new i;m.update(p);var v=m.digest();return m.clean(),v}r.hash=h})(Ig);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=Ha,t=Ig,i=dg;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function s(D){const L=new Float64Array(16);if(D)for(let z=0;z<D.length;z++)L[z]=D[z];return L}const a=new Uint8Array(32);a[0]=9;const h=s(),p=s([1]),m=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function O(D,L){for(let z=0;z<16;z++)D[z]=L[z]|0}function q(D){let L=1;for(let z=0;z<16;z++){let y=D[z]+L+65535;L=Math.floor(y/65536),D[z]=y-L*65536}D[0]+=L-1+37*(L-1)}function j(D,L,z){const y=~(z-1);for(let $=0;$<16;$++){const Y=y&(D[$]^L[$]);D[$]^=Y,L[$]^=Y}}function K(D,L){const z=s(),y=s();for(let $=0;$<16;$++)y[$]=L[$];q(y),q(y),q(y);for(let $=0;$<2;$++){z[0]=y[0]-65517;for(let se=1;se<15;se++)z[se]=y[se]-65535-(z[se-1]>>16&1),z[se-1]&=65535;z[15]=y[15]-32767-(z[14]>>16&1);const Y=z[15]>>16&1;z[14]&=65535,j(y,z,1-Y)}for(let $=0;$<16;$++)D[2*$]=y[$]&255,D[2*$+1]=y[$]>>8}function J(D,L){let z=0;for(let y=0;y<32;y++)z|=D[y]^L[y];return(1&z-1>>>8)-1}function Z(D,L){const z=new Uint8Array(32),y=new Uint8Array(32);return K(z,D),K(y,L),J(z,y)}function de(D){const L=new Uint8Array(32);return K(L,D),L[0]&1}function oe(D,L){for(let z=0;z<16;z++)D[z]=L[2*z]+(L[2*z+1]<<8);D[15]&=32767}function re(D,L,z){for(let y=0;y<16;y++)D[y]=L[y]+z[y]}function fe(D,L,z){for(let y=0;y<16;y++)D[y]=L[y]-z[y]}function ue(D,L,z){let y,$,Y=0,se=0,ae=0,ge=0,ve=0,Te=0,nt=0,Me=0,Ve=0,ke=0,_e=0,je=0,Ge=0,me=0,Fe=0,De=0,we=0,We=0,Le=0,Pe=0,ot=0,ft=0,qe=0,ct=0,ut=0,Be=0,wt=0,dt=0,ze=0,At=0,Et=0,xe=z[0],Ke=z[1],Qe=z[2],Ie=z[3],Je=z[4],He=z[5],Re=z[6],st=z[7],Ye=z[8],Ne=z[9],Xe=z[10],et=z[11],Ee=z[12],Ue=z[13],at=z[14],Ce=z[15];y=L[0],Y+=y*xe,se+=y*Ke,ae+=y*Qe,ge+=y*Ie,ve+=y*Je,Te+=y*He,nt+=y*Re,Me+=y*st,Ve+=y*Ye,ke+=y*Ne,_e+=y*Xe,je+=y*et,Ge+=y*Ee,me+=y*Ue,Fe+=y*at,De+=y*Ce,y=L[1],se+=y*xe,ae+=y*Ke,ge+=y*Qe,ve+=y*Ie,Te+=y*Je,nt+=y*He,Me+=y*Re,Ve+=y*st,ke+=y*Ye,_e+=y*Ne,je+=y*Xe,Ge+=y*et,me+=y*Ee,Fe+=y*Ue,De+=y*at,we+=y*Ce,y=L[2],ae+=y*xe,ge+=y*Ke,ve+=y*Qe,Te+=y*Ie,nt+=y*Je,Me+=y*He,Ve+=y*Re,ke+=y*st,_e+=y*Ye,je+=y*Ne,Ge+=y*Xe,me+=y*et,Fe+=y*Ee,De+=y*Ue,we+=y*at,We+=y*Ce,y=L[3],ge+=y*xe,ve+=y*Ke,Te+=y*Qe,nt+=y*Ie,Me+=y*Je,Ve+=y*He,ke+=y*Re,_e+=y*st,je+=y*Ye,Ge+=y*Ne,me+=y*Xe,Fe+=y*et,De+=y*Ee,we+=y*Ue,We+=y*at,Le+=y*Ce,y=L[4],ve+=y*xe,Te+=y*Ke,nt+=y*Qe,Me+=y*Ie,Ve+=y*Je,ke+=y*He,_e+=y*Re,je+=y*st,Ge+=y*Ye,me+=y*Ne,Fe+=y*Xe,De+=y*et,we+=y*Ee,We+=y*Ue,Le+=y*at,Pe+=y*Ce,y=L[5],Te+=y*xe,nt+=y*Ke,Me+=y*Qe,Ve+=y*Ie,ke+=y*Je,_e+=y*He,je+=y*Re,Ge+=y*st,me+=y*Ye,Fe+=y*Ne,De+=y*Xe,we+=y*et,We+=y*Ee,Le+=y*Ue,Pe+=y*at,ot+=y*Ce,y=L[6],nt+=y*xe,Me+=y*Ke,Ve+=y*Qe,ke+=y*Ie,_e+=y*Je,je+=y*He,Ge+=y*Re,me+=y*st,Fe+=y*Ye,De+=y*Ne,we+=y*Xe,We+=y*et,Le+=y*Ee,Pe+=y*Ue,ot+=y*at,ft+=y*Ce,y=L[7],Me+=y*xe,Ve+=y*Ke,ke+=y*Qe,_e+=y*Ie,je+=y*Je,Ge+=y*He,me+=y*Re,Fe+=y*st,De+=y*Ye,we+=y*Ne,We+=y*Xe,Le+=y*et,Pe+=y*Ee,ot+=y*Ue,ft+=y*at,qe+=y*Ce,y=L[8],Ve+=y*xe,ke+=y*Ke,_e+=y*Qe,je+=y*Ie,Ge+=y*Je,me+=y*He,Fe+=y*Re,De+=y*st,we+=y*Ye,We+=y*Ne,Le+=y*Xe,Pe+=y*et,ot+=y*Ee,ft+=y*Ue,qe+=y*at,ct+=y*Ce,y=L[9],ke+=y*xe,_e+=y*Ke,je+=y*Qe,Ge+=y*Ie,me+=y*Je,Fe+=y*He,De+=y*Re,we+=y*st,We+=y*Ye,Le+=y*Ne,Pe+=y*Xe,ot+=y*et,ft+=y*Ee,qe+=y*Ue,ct+=y*at,ut+=y*Ce,y=L[10],_e+=y*xe,je+=y*Ke,Ge+=y*Qe,me+=y*Ie,Fe+=y*Je,De+=y*He,we+=y*Re,We+=y*st,Le+=y*Ye,Pe+=y*Ne,ot+=y*Xe,ft+=y*et,qe+=y*Ee,ct+=y*Ue,ut+=y*at,Be+=y*Ce,y=L[11],je+=y*xe,Ge+=y*Ke,me+=y*Qe,Fe+=y*Ie,De+=y*Je,we+=y*He,We+=y*Re,Le+=y*st,Pe+=y*Ye,ot+=y*Ne,ft+=y*Xe,qe+=y*et,ct+=y*Ee,ut+=y*Ue,Be+=y*at,wt+=y*Ce,y=L[12],Ge+=y*xe,me+=y*Ke,Fe+=y*Qe,De+=y*Ie,we+=y*Je,We+=y*He,Le+=y*Re,Pe+=y*st,ot+=y*Ye,ft+=y*Ne,qe+=y*Xe,ct+=y*et,ut+=y*Ee,Be+=y*Ue,wt+=y*at,dt+=y*Ce,y=L[13],me+=y*xe,Fe+=y*Ke,De+=y*Qe,we+=y*Ie,We+=y*Je,Le+=y*He,Pe+=y*Re,ot+=y*st,ft+=y*Ye,qe+=y*Ne,ct+=y*Xe,ut+=y*et,Be+=y*Ee,wt+=y*Ue,dt+=y*at,ze+=y*Ce,y=L[14],Fe+=y*xe,De+=y*Ke,we+=y*Qe,We+=y*Ie,Le+=y*Je,Pe+=y*He,ot+=y*Re,ft+=y*st,qe+=y*Ye,ct+=y*Ne,ut+=y*Xe,Be+=y*et,wt+=y*Ee,dt+=y*Ue,ze+=y*at,At+=y*Ce,y=L[15],De+=y*xe,we+=y*Ke,We+=y*Qe,Le+=y*Ie,Pe+=y*Je,ot+=y*He,ft+=y*Re,qe+=y*st,ct+=y*Ye,ut+=y*Ne,Be+=y*Xe,wt+=y*et,dt+=y*Ee,ze+=y*Ue,At+=y*at,Et+=y*Ce,Y+=38*we,se+=38*We,ae+=38*Le,ge+=38*Pe,ve+=38*ot,Te+=38*ft,nt+=38*qe,Me+=38*ct,Ve+=38*ut,ke+=38*Be,_e+=38*wt,je+=38*dt,Ge+=38*ze,me+=38*At,Fe+=38*Et,$=1,y=Y+$+65535,$=Math.floor(y/65536),Y=y-$*65536,y=se+$+65535,$=Math.floor(y/65536),se=y-$*65536,y=ae+$+65535,$=Math.floor(y/65536),ae=y-$*65536,y=ge+$+65535,$=Math.floor(y/65536),ge=y-$*65536,y=ve+$+65535,$=Math.floor(y/65536),ve=y-$*65536,y=Te+$+65535,$=Math.floor(y/65536),Te=y-$*65536,y=nt+$+65535,$=Math.floor(y/65536),nt=y-$*65536,y=Me+$+65535,$=Math.floor(y/65536),Me=y-$*65536,y=Ve+$+65535,$=Math.floor(y/65536),Ve=y-$*65536,y=ke+$+65535,$=Math.floor(y/65536),ke=y-$*65536,y=_e+$+65535,$=Math.floor(y/65536),_e=y-$*65536,y=je+$+65535,$=Math.floor(y/65536),je=y-$*65536,y=Ge+$+65535,$=Math.floor(y/65536),Ge=y-$*65536,y=me+$+65535,$=Math.floor(y/65536),me=y-$*65536,y=Fe+$+65535,$=Math.floor(y/65536),Fe=y-$*65536,y=De+$+65535,$=Math.floor(y/65536),De=y-$*65536,Y+=$-1+37*($-1),$=1,y=Y+$+65535,$=Math.floor(y/65536),Y=y-$*65536,y=se+$+65535,$=Math.floor(y/65536),se=y-$*65536,y=ae+$+65535,$=Math.floor(y/65536),ae=y-$*65536,y=ge+$+65535,$=Math.floor(y/65536),ge=y-$*65536,y=ve+$+65535,$=Math.floor(y/65536),ve=y-$*65536,y=Te+$+65535,$=Math.floor(y/65536),Te=y-$*65536,y=nt+$+65535,$=Math.floor(y/65536),nt=y-$*65536,y=Me+$+65535,$=Math.floor(y/65536),Me=y-$*65536,y=Ve+$+65535,$=Math.floor(y/65536),Ve=y-$*65536,y=ke+$+65535,$=Math.floor(y/65536),ke=y-$*65536,y=_e+$+65535,$=Math.floor(y/65536),_e=y-$*65536,y=je+$+65535,$=Math.floor(y/65536),je=y-$*65536,y=Ge+$+65535,$=Math.floor(y/65536),Ge=y-$*65536,y=me+$+65535,$=Math.floor(y/65536),me=y-$*65536,y=Fe+$+65535,$=Math.floor(y/65536),Fe=y-$*65536,y=De+$+65535,$=Math.floor(y/65536),De=y-$*65536,Y+=$-1+37*($-1),D[0]=Y,D[1]=se,D[2]=ae,D[3]=ge,D[4]=ve,D[5]=Te,D[6]=nt,D[7]=Me,D[8]=Ve,D[9]=ke,D[10]=_e,D[11]=je,D[12]=Ge,D[13]=me,D[14]=Fe,D[15]=De}function le(D,L){ue(D,L,L)}function Ae(D,L){const z=s();let y;for(y=0;y<16;y++)z[y]=L[y];for(y=253;y>=0;y--)le(z,z),y!==2&&y!==4&&ue(z,z,L);for(y=0;y<16;y++)D[y]=z[y]}function ht(D,L){const z=s();let y;for(y=0;y<16;y++)z[y]=L[y];for(y=250;y>=0;y--)le(z,z),y!==1&&ue(z,z,L);for(y=0;y<16;y++)D[y]=z[y]}function k(D,L){const z=s(),y=s(),$=s(),Y=s(),se=s(),ae=s(),ge=s(),ve=s(),Te=s();fe(z,D[1],D[0]),fe(Te,L[1],L[0]),ue(z,z,Te),re(y,D[0],D[1]),re(Te,L[0],L[1]),ue(y,y,Te),ue($,D[3],L[3]),ue($,$,v),ue(Y,D[2],L[2]),re(Y,Y,Y),fe(se,y,z),fe(ae,Y,$),re(ge,Y,$),re(ve,y,z),ue(D[0],se,ae),ue(D[1],ve,ge),ue(D[2],ge,ae),ue(D[3],se,ve)}function b(D,L,z){for(let y=0;y<4;y++)j(D[y],L[y],z)}function c(D,L){const z=s(),y=s(),$=s();Ae($,L[2]),ue(z,L[0],$),ue(y,L[1],$),K(D,y),D[31]^=de(z)<<7}function d(D,L,z){O(D[0],h),O(D[1],p),O(D[2],p),O(D[3],h);for(let y=255;y>=0;--y){const $=z[y/8|0]>>(y&7)&1;b(D,L,$),k(L,D),k(D,D),b(D,L,$)}}function g(D,L){const z=[s(),s(),s(),s()];O(z[0],_),O(z[1],I),O(z[2],p),ue(z[3],_,I),d(D,z,L)}function A(D){if(D.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const L=(0,t.hash)(D);L[0]&=248,L[31]&=127,L[31]|=64;const z=new Uint8Array(32),y=[s(),s(),s(),s()];g(y,L),c(z,y);const $=new Uint8Array(64);return $.set(D),$.set(z,32),{publicKey:z,secretKey:$}}r.generateKeyPairFromSeed=A;function M(D){const L=(0,e.randomBytes)(32,D),z=A(L);return(0,i.wipe)(L),z}r.generateKeyPair=M;function S(D){if(D.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}r.extractPublicKeyFromSecretKey=S;const x=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function u(D,L){let z,y,$,Y;for(y=63;y>=32;--y){for(z=0,$=y-32,Y=y-12;$<Y;++$)L[$]+=z-16*L[y]*x[$-(y-32)],z=Math.floor((L[$]+128)/256),L[$]-=z*256;L[$]+=z,L[y]=0}for(z=0,$=0;$<32;$++)L[$]+=z-(L[31]>>4)*x[$],z=L[$]>>8,L[$]&=255;for($=0;$<32;$++)L[$]-=z*x[$];for(y=0;y<32;y++)L[y+1]+=L[y]>>8,D[y]=L[y]&255}function l(D){const L=new Float64Array(64);for(let z=0;z<64;z++)L[z]=D[z];for(let z=0;z<64;z++)D[z]=0;u(D,L)}function R(D,L){const z=new Float64Array(64),y=[s(),s(),s(),s()],$=(0,t.hash)(D.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const Y=new Uint8Array(64);Y.set($.subarray(32),32);const se=new t.SHA512;se.update(Y.subarray(32)),se.update(L);const ae=se.digest();se.clean(),l(ae),g(y,ae),c(Y,y),se.reset(),se.update(Y.subarray(0,32)),se.update(D.subarray(32)),se.update(L);const ge=se.digest();l(ge);for(let ve=0;ve<32;ve++)z[ve]=ae[ve];for(let ve=0;ve<32;ve++)for(let Te=0;Te<32;Te++)z[ve+Te]+=ge[ve]*$[Te];return u(Y.subarray(32),z),Y}r.sign=R;function X(D,L){const z=s(),y=s(),$=s(),Y=s(),se=s(),ae=s(),ge=s();return O(D[2],p),oe(D[1],L),le($,D[1]),ue(Y,$,m),fe($,$,D[2]),re(Y,D[2],Y),le(se,Y),le(ae,se),ue(ge,ae,se),ue(z,ge,$),ue(z,z,Y),ht(z,z),ue(z,z,$),ue(z,z,Y),ue(z,z,Y),ue(D[0],z,Y),le(y,D[0]),ue(y,y,Y),Z(y,$)&&ue(D[0],D[0],N),le(y,D[0]),ue(y,y,Y),Z(y,$)?-1:(de(D[0])===L[31]>>7&&fe(D[0],h,D[0]),ue(D[3],D[0],D[1]),0)}function ee(D,L,z){const y=new Uint8Array(32),$=[s(),s(),s(),s()],Y=[s(),s(),s(),s()];if(z.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(X(Y,D))return!1;const se=new t.SHA512;se.update(z.subarray(0,32)),se.update(D),se.update(L);const ae=se.digest();return l(ae),d($,Y,ae),g(Y,z.subarray(32)),k($,Y),c(y,$),!J(z,y)}r.verify=ee;function E(D){let L=[s(),s(),s(),s()];if(X(L,D))throw new Error("Ed25519: invalid public key");let z=s(),y=s(),$=L[1];re(z,p,$),fe(y,p,$),Ae(y,y),ue(z,z,y);let Y=new Uint8Array(32);return K(Y,z),Y}r.convertPublicKeyToX25519=E;function W(D){const L=(0,t.hash)(D.subarray(0,32));L[0]&=248,L[31]&=127,L[31]|=64;const z=new Uint8Array(L.subarray(0,32));return(0,i.wipe)(L),z}r.convertSecretKeyToX25519=W})(Cd);const N4="EdDSA",C4="JWT",kh=".",ef="base64url",Eg="utf8",Mg="utf8",O4=":",T4="did",q4="key",lp="base58btc",D4="z",B4="K36",$4=32;function pp(r){return ta(wr(yr(r,ef),Eg))}function Lh(r){return wr(yr(as(r),Eg),ef)}function Sg(r){const e=yr(B4,lp),t=D4+wr(Eh([e,r]),lp);return[T4,q4,t].join(O4)}function k4(r){return wr(r,ef)}function L4(r){return yr(r,ef)}function z4(r){return yr([Lh(r.header),Lh(r.payload)].join(kh),Mg)}function U4(r){return[Lh(r.header),Lh(r.payload),k4(r.signature)].join(kh)}function ud(r){const e=r.split(kh),t=pp(e[0]),i=pp(e[1]),s=L4(e[2]),a=yr(e.slice(0,2).join(kh),Mg);return{header:t,payload:i,signature:s,data:a}}function gp(r=Ha.randomBytes($4)){return Cd.generateKeyPairFromSeed(r)}async function j4(r,e,t,i,s=be.fromMiliseconds(Date.now())){const a={alg:N4,typ:C4},h=Sg(i.publicKey),p=s+t,m={iss:h,sub:r,aud:e,iat:s,exp:p},v=z4({header:a,payload:m}),_=Cd.sign(i.secretKey,v);return U4({header:a,payload:m,signature:_})}const F4="PARSE_ERROR",K4="INVALID_REQUEST",H4="METHOD_NOT_FOUND",V4="INVALID_PARAMS",Pg="INTERNAL_ERROR",Od="SERVER_ERROR",G4=[-32700,-32600,-32601,-32602,-32603],Fo={[F4]:{code:-32700,message:"Parse error"},[K4]:{code:-32600,message:"Invalid Request"},[H4]:{code:-32601,message:"Method not found"},[V4]:{code:-32602,message:"Invalid params"},[Pg]:{code:-32603,message:"Internal error"},[Od]:{code:-32e3,message:"Server error"}},Rg=Od;function J4(r){return G4.includes(r)}function vp(r){return Object.keys(Fo).includes(r)?Fo[r]:Fo[Rg]}function W4(r){const e=Object.values(Fo).find(t=>t.code===r);return e||Fo[Rg]}function Ng(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}function As(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Ws(r=6){return BigInt(As(r))}function Qs(r,e,t){return{id:t||As(),jsonrpc:"2.0",method:r,params:e}}function tf(r,e){return{id:r,jsonrpc:"2.0",result:e}}function rf(r,e,t){return{id:r,jsonrpc:"2.0",error:Q4(e)}}function Q4(r,e){return typeof r>"u"?vp(Pg):(typeof r=="string"&&(r=Object.assign(Object.assign({},vp(Od)),{message:r})),J4(r.code)&&(r=W4(r.code)),r)}class Y4{}let X4=class extends Y4{constructor(){super()}},Z4=class extends X4{constructor(e){super()}};const e8="^https?:",t8="^wss?:";function r8(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Cg(r,e){const t=r8(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function bp(r){return Cg(r,e8)}function mp(r){return Cg(r,t8)}function i8(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Og(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function Td(r){return Og(r)&&"method"in r}function nf(r){return Og(r)&&(wn(r)||Bi(r))}function wn(r){return"result"in r}function Bi(r){return"error"in r}class un extends Z4{constructor(e){super(e),this.events=new Li.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Qs(e.method,e.params||[],e.id||Ws().toString()),t)}async requestStrict(e,t){return new Promise(async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(a){s(a)}this.events.on(`${e.id}`,a=>{Bi(a)?s(a.error):i(a.result)});try{await this.connection.send(e,t)}catch(a){s(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),nf(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const n8=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),s8=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",yp=r=>r.split("?")[0],wp=10,a8=n8();let o8=class{constructor(e){if(this.url=e,this.events=new Li.EventEmitter,this.registering=!1,!mp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(as(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!mp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const s=new URLSearchParams(e).get("origin"),a=nw.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!i8(e)},h=new a8(e,[],a);s8()?h.onerror=p=>{const m=p;i(this.emitError(m.error))}:h.on("error",p=>{i(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),t(h)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ta(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),s=i.message||i.toString(),a=rf(e,s);this.events.emit("payload",a)}parseError(e,t=this.url){return Ng(e,yp(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>wp&&this.events.setMaxListeners(wp)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${yp(this.url)}`));return this.events.emit("register_error",t),t}};var zh={exports:{}};zh.exports;(function(r,e){var t=200,i="__lodash_hash_undefined__",s=1,a=2,h=9007199254740991,p="[object Arguments]",m="[object Array]",v="[object AsyncFunction]",_="[object Boolean]",I="[object Date]",N="[object Error]",O="[object Function]",q="[object GeneratorFunction]",j="[object Map]",K="[object Number]",J="[object Null]",Z="[object Object]",de="[object Promise]",oe="[object Proxy]",re="[object RegExp]",fe="[object Set]",ue="[object String]",le="[object Symbol]",Ae="[object Undefined]",ht="[object WeakMap]",k="[object ArrayBuffer]",b="[object DataView]",c="[object Float32Array]",d="[object Float64Array]",g="[object Int8Array]",A="[object Int16Array]",M="[object Int32Array]",S="[object Uint8Array]",x="[object Uint8ClampedArray]",u="[object Uint16Array]",l="[object Uint32Array]",R=/[\\^$.*+?()[\]{}|]/g,X=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,E={};E[c]=E[d]=E[g]=E[A]=E[M]=E[S]=E[x]=E[u]=E[l]=!0,E[p]=E[m]=E[k]=E[_]=E[b]=E[I]=E[N]=E[O]=E[j]=E[K]=E[Z]=E[re]=E[fe]=E[ue]=E[ht]=!1;var W=typeof Lo=="object"&&Lo&&Lo.Object===Object&&Lo,D=typeof self=="object"&&self&&self.Object===Object&&self,L=W||D||Function("return this")(),z=e&&!e.nodeType&&e,y=z&&!0&&r&&!r.nodeType&&r,$=y&&y.exports===z,Y=$&&W.process,se=function(){try{return Y&&Y.binding&&Y.binding("util")}catch{}}(),ae=se&&se.isTypedArray;function ge(B,H){for(var ce=-1,Se=B==null?0:B.length,Ut=0,pt=[];++ce<Se;){var Vt=B[ce];H(Vt,ce,B)&&(pt[Ut++]=Vt)}return pt}function ve(B,H){for(var ce=-1,Se=H.length,Ut=B.length;++ce<Se;)B[Ut+ce]=H[ce];return B}function Te(B,H){for(var ce=-1,Se=B==null?0:B.length;++ce<Se;)if(H(B[ce],ce,B))return!0;return!1}function nt(B,H){for(var ce=-1,Se=Array(B);++ce<B;)Se[ce]=H(ce);return Se}function Me(B){return function(H){return B(H)}}function Ve(B,H){return B.has(H)}function ke(B,H){return B==null?void 0:B[H]}function _e(B){var H=-1,ce=Array(B.size);return B.forEach(function(Se,Ut){ce[++H]=[Ut,Se]}),ce}function je(B,H){return function(ce){return B(H(ce))}}function Ge(B){var H=-1,ce=Array(B.size);return B.forEach(function(Se){ce[++H]=Se}),ce}var me=Array.prototype,Fe=Function.prototype,De=Object.prototype,we=L["__core-js_shared__"],We=Fe.toString,Le=De.hasOwnProperty,Pe=function(){var B=/[^.]+$/.exec(we&&we.keys&&we.keys.IE_PROTO||"");return B?"Symbol(src)_1."+B:""}(),ot=De.toString,ft=RegExp("^"+We.call(Le).replace(R,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=$?L.Buffer:void 0,ct=L.Symbol,ut=L.Uint8Array,Be=De.propertyIsEnumerable,wt=me.splice,dt=ct?ct.toStringTag:void 0,ze=Object.getOwnPropertySymbols,At=qe?qe.isBuffer:void 0,Et=je(Object.keys,Object),xe=ui(L,"DataView"),Ke=ui(L,"Map"),Qe=ui(L,"Promise"),Ie=ui(L,"Set"),Je=ui(L,"WeakMap"),He=ui(Object,"create"),Re=jn(xe),st=jn(Ke),Ye=jn(Qe),Ne=jn(Ie),Xe=jn(Je),et=ct?ct.prototype:void 0,Ee=et?et.valueOf:void 0;function Ue(B){var H=-1,ce=B==null?0:B.length;for(this.clear();++H<ce;){var Se=B[H];this.set(Se[0],Se[1])}}function at(){this.__data__=He?He(null):{},this.size=0}function Ce(B){var H=this.has(B)&&delete this.__data__[B];return this.size-=H?1:0,H}function Ot(B){var H=this.__data__;if(He){var ce=H[B];return ce===i?void 0:ce}return Le.call(H,B)?H[B]:void 0}function Tt(B){var H=this.__data__;return He?H[B]!==void 0:Le.call(H,B)}function tt(B,H){var ce=this.__data__;return this.size+=this.has(B)?0:1,ce[B]=He&&H===void 0?i:H,this}Ue.prototype.clear=at,Ue.prototype.delete=Ce,Ue.prototype.get=Ot,Ue.prototype.has=Tt,Ue.prototype.set=tt;function bt(B){var H=-1,ce=B==null?0:B.length;for(this.clear();++H<ce;){var Se=B[H];this.set(Se[0],Se[1])}}function Rr(){this.__data__=[],this.size=0}function Nr(B){var H=this.__data__,ce=Os(H,B);if(ce<0)return!1;var Se=H.length-1;return ce==Se?H.pop():wt.call(H,ce,1),--this.size,!0}function Cr(B){var H=this.__data__,ce=Os(H,B);return ce<0?void 0:H[ce][1]}function Or(B){return Os(this.__data__,B)>-1}function Tr(B,H){var ce=this.__data__,Se=Os(ce,B);return Se<0?(++this.size,ce.push([B,H])):ce[Se][1]=H,this}bt.prototype.clear=Rr,bt.prototype.delete=Nr,bt.prototype.get=Cr,bt.prototype.has=Or,bt.prototype.set=Tr;function Yt(B){var H=-1,ce=B==null?0:B.length;for(this.clear();++H<ce;){var Se=B[H];this.set(Se[0],Se[1])}}function Jr(){this.size=0,this.__data__={hash:new Ue,map:new(Ke||bt),string:new Ue}}function ji(B){var H=fs(this,B).delete(B);return this.size-=H?1:0,H}function Wr(B){return fs(this,B).get(B)}function Fi(B){return fs(this,B).has(B)}function Ki(B,H){var ce=fs(this,B),Se=ce.size;return ce.set(B,H),this.size+=ce.size==Se?0:1,this}Yt.prototype.clear=Jr,Yt.prototype.delete=ji,Yt.prototype.get=Wr,Yt.prototype.has=Fi,Yt.prototype.set=Ki;function Qr(B){var H=-1,ce=B==null?0:B.length;for(this.__data__=new Yt;++H<ce;)this.add(B[H])}function _i(B){return this.__data__.set(B,i),this}function Ai(B){return this.__data__.has(B)}Qr.prototype.add=Qr.prototype.push=_i,Qr.prototype.has=Ai;function hr(B){var H=this.__data__=new bt(B);this.size=H.size}function Hi(){this.__data__=new bt,this.size=0}function Vi(B){var H=this.__data__,ce=H.delete(B);return this.size=H.size,ce}function Gi(B){return this.__data__.get(B)}function Cs(B){return this.__data__.has(B)}function uc(B,H){var ce=this.__data__;if(ce instanceof bt){var Se=ce.__data__;if(!Ke||Se.length<t-1)return Se.push([B,H]),this.size=++ce.size,this;ce=this.__data__=new Yt(Se)}return ce.set(B,H),this.size=ce.size,this}hr.prototype.clear=Hi,hr.prototype.delete=Vi,hr.prototype.get=Gi,hr.prototype.has=Cs,hr.prototype.set=uc;function dc(B,H){var ce=ga(B),Se=!ce&&Ic(B),Ut=!ce&&!Se&&co(B),pt=!ce&&!Se&&!Ut&&Sc(B),Vt=ce||Se||Ut||pt,or=Vt?nt(B.length,String):[],Nt=or.length;for(var jt in B)Le.call(B,jt)&&!(Vt&&(jt=="length"||Ut&&(jt=="offset"||jt=="parent")||pt&&(jt=="buffer"||jt=="byteLength"||jt=="byteOffset")||yc(jt,Nt)))&&or.push(jt);return or}function Os(B,H){for(var ce=B.length;ce--;)if(xc(B[ce][0],H))return ce;return-1}function ao(B,H,ce){var Se=H(B);return ga(B)?Se:ve(Se,ce(B))}function Ts(B){return B==null?B===void 0?Ae:J:dt&&dt in Object(B)?bc(B):wf(B)}function oo(B){return Ds(B)&&Ts(B)==p}function qs(B,H,ce,Se,Ut){return B===H?!0:B==null||H==null||!Ds(B)&&!Ds(H)?B!==B&&H!==H:lc(B,H,ce,Se,qs,Ut)}function lc(B,H,ce,Se,Ut,pt){var Vt=ga(B),or=ga(H),Nt=Vt?m:ln(B),jt=or?m:ln(H);Nt=Nt==p?Z:Nt,jt=jt==p?Z:jt;var rr=Nt==Z,Yr=jt==Z,cr=Nt==jt;if(cr&&co(B)){if(!co(H))return!1;Vt=!0,rr=!1}if(cr&&!rr)return pt||(pt=new hr),Vt||Sc(B)?la(B,H,ce,Se,Ut,pt):yf(B,H,Nt,ce,Se,Ut,pt);if(!(ce&s)){var Gt=rr&&Le.call(B,"__wrapped__"),kr=Yr&&Le.call(H,"__wrapped__");if(Gt||kr){var Ji=Gt?B.value():B,xi=kr?H.value():H;return pt||(pt=new hr),Ut(Ji,xi,ce,Se,pt)}}return cr?(pt||(pt=new hr),vc(B,H,ce,Se,Ut,pt)):!1}function mf(B){if(!Mc(B)||_c(B))return!1;var H=va(B)?ft:X;return H.test(jn(B))}function pc(B){return Ds(B)&&Ec(B.length)&&!!E[Ts(B)]}function gc(B){if(!Ac(B))return Et(B);var H=[];for(var ce in Object(B))Le.call(B,ce)&&ce!="constructor"&&H.push(ce);return H}function la(B,H,ce,Se,Ut,pt){var Vt=ce&s,or=B.length,Nt=H.length;if(or!=Nt&&!(Vt&&Nt>or))return!1;var jt=pt.get(B);if(jt&&pt.get(H))return jt==H;var rr=-1,Yr=!0,cr=ce&a?new Qr:void 0;for(pt.set(B,H),pt.set(H,B);++rr<or;){var Gt=B[rr],kr=H[rr];if(Se)var Ji=Vt?Se(kr,Gt,rr,H,B,pt):Se(Gt,kr,rr,B,H,pt);if(Ji!==void 0){if(Ji)continue;Yr=!1;break}if(cr){if(!Te(H,function(xi,pn){if(!Ve(cr,pn)&&(Gt===xi||Ut(Gt,xi,ce,Se,pt)))return cr.push(pn)})){Yr=!1;break}}else if(!(Gt===kr||Ut(Gt,kr,ce,Se,pt))){Yr=!1;break}}return pt.delete(B),pt.delete(H),Yr}function yf(B,H,ce,Se,Ut,pt,Vt){switch(ce){case b:if(B.byteLength!=H.byteLength||B.byteOffset!=H.byteOffset)return!1;B=B.buffer,H=H.buffer;case k:return!(B.byteLength!=H.byteLength||!pt(new ut(B),new ut(H)));case _:case I:case K:return xc(+B,+H);case N:return B.name==H.name&&B.message==H.message;case re:case ue:return B==H+"";case j:var or=_e;case fe:var Nt=Se&s;if(or||(or=Ge),B.size!=H.size&&!Nt)return!1;var jt=Vt.get(B);if(jt)return jt==H;Se|=a,Vt.set(B,H);var rr=la(or(B),or(H),Se,Ut,pt,Vt);return Vt.delete(B),rr;case le:if(Ee)return Ee.call(B)==Ee.call(H)}return!1}function vc(B,H,ce,Se,Ut,pt){var Vt=ce&s,or=pa(B),Nt=or.length,jt=pa(H),rr=jt.length;if(Nt!=rr&&!Vt)return!1;for(var Yr=Nt;Yr--;){var cr=or[Yr];if(!(Vt?cr in H:Le.call(H,cr)))return!1}var Gt=pt.get(B);if(Gt&&pt.get(H))return Gt==H;var kr=!0;pt.set(B,H),pt.set(H,B);for(var Ji=Vt;++Yr<Nt;){cr=or[Yr];var xi=B[cr],pn=H[cr];if(Se)var ho=Vt?Se(pn,xi,cr,H,B,pt):Se(xi,pn,cr,B,H,pt);if(!(ho===void 0?xi===pn||Ut(xi,pn,ce,Se,pt):ho)){kr=!1;break}Ji||(Ji=cr=="constructor")}if(kr&&!Ji){var Bs=B.constructor,pr=H.constructor;Bs!=pr&&"constructor"in B&&"constructor"in H&&!(typeof Bs=="function"&&Bs instanceof Bs&&typeof pr=="function"&&pr instanceof pr)&&(kr=!1)}return pt.delete(B),pt.delete(H),kr}function pa(B){return ao(B,xf,mc)}function fs(B,H){var ce=B.__data__;return wc(H)?ce[typeof H=="string"?"string":"hash"]:ce.map}function ui(B,H){var ce=ke(B,H);return mf(ce)?ce:void 0}function bc(B){var H=Le.call(B,dt),ce=B[dt];try{B[dt]=void 0;var Se=!0}catch{}var Ut=ot.call(B);return Se&&(H?B[dt]=ce:delete B[dt]),Ut}var mc=ze?function(B){return B==null?[]:(B=Object(B),ge(ze(B),function(H){return Be.call(B,H)}))}:zt,ln=Ts;(xe&&ln(new xe(new ArrayBuffer(1)))!=b||Ke&&ln(new Ke)!=j||Qe&&ln(Qe.resolve())!=de||Ie&&ln(new Ie)!=fe||Je&&ln(new Je)!=ht)&&(ln=function(B){var H=Ts(B),ce=H==Z?B.constructor:void 0,Se=ce?jn(ce):"";if(Se)switch(Se){case Re:return b;case st:return j;case Ye:return de;case Ne:return fe;case Xe:return ht}return H});function yc(B,H){return H=H??h,!!H&&(typeof B=="number"||ee.test(B))&&B>-1&&B%1==0&&B<H}function wc(B){var H=typeof B;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?B!=="__proto__":B===null}function _c(B){return!!Pe&&Pe in B}function Ac(B){var H=B&&B.constructor,ce=typeof H=="function"&&H.prototype||De;return B===ce}function wf(B){return ot.call(B)}function jn(B){if(B!=null){try{return We.call(B)}catch{}try{return B+""}catch{}}return""}function xc(B,H){return B===H||B!==B&&H!==H}var Ic=oo(function(){return arguments}())?oo:function(B){return Ds(B)&&Le.call(B,"callee")&&!Be.call(B,"callee")},ga=Array.isArray;function _f(B){return B!=null&&Ec(B.length)&&!va(B)}var co=At||Lt;function Af(B,H){return qs(B,H)}function va(B){if(!Mc(B))return!1;var H=Ts(B);return H==O||H==q||H==v||H==oe}function Ec(B){return typeof B=="number"&&B>-1&&B%1==0&&B<=h}function Mc(B){var H=typeof B;return B!=null&&(H=="object"||H=="function")}function Ds(B){return B!=null&&typeof B=="object"}var Sc=ae?Me(ae):pc;function xf(B){return _f(B)?dc(B):gc(B)}function zt(){return[]}function Lt(){return!1}r.exports=Af})(zh,zh.exports);var c8=zh.exports;const h8=sw(c8);var f8=Object.defineProperty,u8=Object.defineProperties,d8=Object.getOwnPropertyDescriptors,_p=Object.getOwnPropertySymbols,l8=Object.prototype.hasOwnProperty,p8=Object.prototype.propertyIsEnumerable,Ap=(r,e,t)=>e in r?f8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xp=(r,e)=>{for(var t in e||(e={}))l8.call(e,t)&&Ap(r,t,e[t]);if(_p)for(var t of _p(e))p8.call(e,t)&&Ap(r,t,e[t]);return r},Ip=(r,e)=>u8(r,d8(e));const g8={Accept:"application/json","Content-Type":"application/json"},v8="POST",Ep={headers:g8,method:v8},Mp=10;let kn=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Li.EventEmitter,this.isAvailable=!1,this.registering=!1,!bp(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=as(e),i=await(await Z0(this.url,Ip(xp({},Ep),{body:t}))).json();this.onPayload({data:i})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!bp(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=as({id:1,jsonrpc:"2.0",method:"test",params:[]});await Z0(e,Ip(xp({},Ep),{body:t}))}this.onOpen()}catch(t){const i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ta(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),s=i.message||i.toString(),a=rf(e,s);this.events.emit("payload",a)}parseError(e,t=this.url){return Ng(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Mp&&this.events.setMaxListeners(Mp)}};var Tg={};const b8="elliptic",m8="6.5.7",y8="EC cryptography",w8="lib/elliptic.js",_8=["lib"],A8={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},x8={type:"git",url:"git@github.com:indutny/elliptic"},I8=["EC","Elliptic","curve","Cryptography"],E8="Fedor Indutny <fedor@indutny.com>",M8="MIT",S8={url:"https://github.com/indutny/elliptic/issues"},P8="https://github.com/indutny/elliptic",R8={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},N8={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},C8={name:b8,version:m8,description:y8,main:w8,files:_8,scripts:A8,repository:x8,keywords:I8,author:E8,license:M8,bugs:S8,homepage:P8,devDependencies:R8,dependencies:N8};var wi={},qd={exports:{}};qd.exports;(function(r){(function(e,t){function i(k,b){if(!k)throw new Error(b||"Assertion failed")}function s(k,b){k.super_=b;var c=function(){};c.prototype=b.prototype,k.prototype=new c,k.prototype.constructor=k}function a(k,b,c){if(a.isBN(k))return k;this.negative=0,this.words=null,this.length=0,this.red=null,k!==null&&((b==="le"||b==="be")&&(c=b,b=10),this._init(k||0,b||10,c||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=vg.Buffer}catch{}a.isBN=function(b){return b instanceof a?!0:b!==null&&typeof b=="object"&&b.constructor.wordSize===a.wordSize&&Array.isArray(b.words)},a.max=function(b,c){return b.cmp(c)>0?b:c},a.min=function(b,c){return b.cmp(c)<0?b:c},a.prototype._init=function(b,c,d){if(typeof b=="number")return this._initNumber(b,c,d);if(typeof b=="object")return this._initArray(b,c,d);c==="hex"&&(c=16),i(c===(c|0)&&c>=2&&c<=36),b=b.toString().replace(/\s+/g,"");var g=0;b[0]==="-"&&(g++,this.negative=1),g<b.length&&(c===16?this._parseHex(b,g,d):(this._parseBase(b,c,g),d==="le"&&this._initArray(this.toArray(),c,d)))},a.prototype._initNumber=function(b,c,d){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(i(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),c,d)},a.prototype._initArray=function(b,c,d){if(i(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var A,M,S=0;if(d==="be")for(g=b.length-1,A=0;g>=0;g-=3)M=b[g]|b[g-1]<<8|b[g-2]<<16,this.words[A]|=M<<S&67108863,this.words[A+1]=M>>>26-S&67108863,S+=24,S>=26&&(S-=26,A++);else if(d==="le")for(g=0,A=0;g<b.length;g+=3)M=b[g]|b[g+1]<<8|b[g+2]<<16,this.words[A]|=M<<S&67108863,this.words[A+1]=M>>>26-S&67108863,S+=24,S>=26&&(S-=26,A++);return this.strip()};function p(k,b){var c=k.charCodeAt(b);return c>=65&&c<=70?c-55:c>=97&&c<=102?c-87:c-48&15}function m(k,b,c){var d=p(k,c);return c-1>=b&&(d|=p(k,c-1)<<4),d}a.prototype._parseHex=function(b,c,d){this.length=Math.ceil((b.length-c)/6),this.words=new Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var A=0,M=0,S;if(d==="be")for(g=b.length-1;g>=c;g-=2)S=m(b,c,g)<<A,this.words[M]|=S&67108863,A>=18?(A-=18,M+=1,this.words[M]|=S>>>26):A+=8;else{var x=b.length-c;for(g=x%2===0?c+1:c;g<b.length;g+=2)S=m(b,c,g)<<A,this.words[M]|=S&67108863,A>=18?(A-=18,M+=1,this.words[M]|=S>>>26):A+=8}this.strip()};function v(k,b,c,d){for(var g=0,A=Math.min(k.length,c),M=b;M<A;M++){var S=k.charCodeAt(M)-48;g*=d,S>=49?g+=S-49+10:S>=17?g+=S-17+10:g+=S}return g}a.prototype._parseBase=function(b,c,d){this.words=[0],this.length=1;for(var g=0,A=1;A<=67108863;A*=c)g++;g--,A=A/c|0;for(var M=b.length-d,S=M%g,x=Math.min(M,M-S)+d,u=0,l=d;l<x;l+=g)u=v(b,l,l+g,c),this.imuln(A),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(S!==0){var R=1;for(u=v(b,l,b.length,c),l=0;l<S;l++)R*=c;this.imuln(R),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},a.prototype.copy=function(b){b.words=new Array(this.length);for(var c=0;c<this.length;c++)b.words[c]=this.words[c];b.length=this.length,b.negative=this.negative,b.red=this.red},a.prototype.clone=function(){var b=new a(null);return this.copy(b),b},a.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var _=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],I=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],N=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(b,c){b=b||10,c=c|0||1;var d;if(b===16||b==="hex"){d="";for(var g=0,A=0,M=0;M<this.length;M++){var S=this.words[M],x=((S<<g|A)&16777215).toString(16);A=S>>>24-g&16777215,A!==0||M!==this.length-1?d=_[6-x.length]+x+d:d=x+d,g+=2,g>=26&&(g-=26,M--)}for(A!==0&&(d=A.toString(16)+d);d.length%c!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(b===(b|0)&&b>=2&&b<=36){var u=I[b],l=N[b];d="";var R=this.clone();for(R.negative=0;!R.isZero();){var X=R.modn(l).toString(b);R=R.idivn(l),R.isZero()?d=X+d:d=_[u-X.length]+X+d}for(this.isZero()&&(d="0"+d);d.length%c!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=this.words[1]*67108864:this.length===3&&this.words[2]===1?b+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(b,c){return i(typeof h<"u"),this.toArrayLike(h,b,c)},a.prototype.toArray=function(b,c){return this.toArrayLike(Array,b,c)},a.prototype.toArrayLike=function(b,c,d){var g=this.byteLength(),A=d||Math.max(1,g);i(g<=A,"byte array longer than desired length"),i(A>0,"Requested array length <= 0"),this.strip();var M=c==="le",S=new b(A),x,u,l=this.clone();if(M){for(u=0;!l.isZero();u++)x=l.andln(255),l.iushrn(8),S[u]=x;for(;u<A;u++)S[u]=0}else{for(u=0;u<A-g;u++)S[u]=0;for(u=0;!l.isZero();u++)x=l.andln(255),l.iushrn(8),S[A-u-1]=x}return S},Math.clz32?a.prototype._countBits=function(b){return 32-Math.clz32(b)}:a.prototype._countBits=function(b){var c=b,d=0;return c>=4096&&(d+=13,c>>>=13),c>=64&&(d+=7,c>>>=7),c>=8&&(d+=4,c>>>=4),c>=2&&(d+=2,c>>>=2),d+c},a.prototype._zeroBits=function(b){if(b===0)return 26;var c=b,d=0;return c&8191||(d+=13,c>>>=13),c&127||(d+=7,c>>>=7),c&15||(d+=4,c>>>=4),c&3||(d+=2,c>>>=2),c&1||d++,d},a.prototype.bitLength=function(){var b=this.words[this.length-1],c=this._countBits(b);return(this.length-1)*26+c};function O(k){for(var b=new Array(k.bitLength()),c=0;c<b.length;c++){var d=c/26|0,g=c%26;b[c]=(k.words[d]&1<<g)>>>g}return b}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,c=0;c<this.length;c++){var d=this._zeroBits(this.words[c]);if(b+=d,d!==26)break}return b},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},a.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var c=0;c<b.length;c++)this.words[c]=this.words[c]|b.words[c];return this.strip()},a.prototype.ior=function(b){return i((this.negative|b.negative)===0),this.iuor(b)},a.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},a.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},a.prototype.iuand=function(b){var c;this.length>b.length?c=b:c=this;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]&b.words[d];return this.length=c.length,this.strip()},a.prototype.iand=function(b){return i((this.negative|b.negative)===0),this.iuand(b)},a.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},a.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},a.prototype.iuxor=function(b){var c,d;this.length>b.length?(c=this,d=b):(c=b,d=this);for(var g=0;g<d.length;g++)this.words[g]=c.words[g]^d.words[g];if(this!==c)for(;g<c.length;g++)this.words[g]=c.words[g];return this.length=c.length,this.strip()},a.prototype.ixor=function(b){return i((this.negative|b.negative)===0),this.iuxor(b)},a.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},a.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},a.prototype.inotn=function(b){i(typeof b=="number"&&b>=0);var c=Math.ceil(b/26)|0,d=b%26;this._expand(c),d>0&&c--;for(var g=0;g<c;g++)this.words[g]=~this.words[g]&67108863;return d>0&&(this.words[g]=~this.words[g]&67108863>>26-d),this.strip()},a.prototype.notn=function(b){return this.clone().inotn(b)},a.prototype.setn=function(b,c){i(typeof b=="number"&&b>=0);var d=b/26|0,g=b%26;return this._expand(d+1),c?this.words[d]=this.words[d]|1<<g:this.words[d]=this.words[d]&~(1<<g),this.strip()},a.prototype.iadd=function(b){var c;if(this.negative!==0&&b.negative===0)return this.negative=0,c=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,c=this.isub(b),b.negative=1,c._normSign();var d,g;this.length>b.length?(d=this,g=b):(d=b,g=this);for(var A=0,M=0;M<g.length;M++)c=(d.words[M]|0)+(g.words[M]|0)+A,this.words[M]=c&67108863,A=c>>>26;for(;A!==0&&M<d.length;M++)c=(d.words[M]|0)+A,this.words[M]=c&67108863,A=c>>>26;if(this.length=d.length,A!==0)this.words[this.length]=A,this.length++;else if(d!==this)for(;M<d.length;M++)this.words[M]=d.words[M];return this},a.prototype.add=function(b){var c;return b.negative!==0&&this.negative===0?(b.negative=0,c=this.sub(b),b.negative^=1,c):b.negative===0&&this.negative!==0?(this.negative=0,c=b.sub(this),this.negative=1,c):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},a.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var c=this.iadd(b);return b.negative=1,c._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var d=this.cmp(b);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var g,A;d>0?(g=this,A=b):(g=b,A=this);for(var M=0,S=0;S<A.length;S++)c=(g.words[S]|0)-(A.words[S]|0)+M,M=c>>26,this.words[S]=c&67108863;for(;M!==0&&S<g.length;S++)c=(g.words[S]|0)+M,M=c>>26,this.words[S]=c&67108863;if(M===0&&S<g.length&&g!==this)for(;S<g.length;S++)this.words[S]=g.words[S];return this.length=Math.max(this.length,S),g!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(b){return this.clone().isub(b)};function q(k,b,c){c.negative=b.negative^k.negative;var d=k.length+b.length|0;c.length=d,d=d-1|0;var g=k.words[0]|0,A=b.words[0]|0,M=g*A,S=M&67108863,x=M/67108864|0;c.words[0]=S;for(var u=1;u<d;u++){for(var l=x>>>26,R=x&67108863,X=Math.min(u,b.length-1),ee=Math.max(0,u-k.length+1);ee<=X;ee++){var E=u-ee|0;g=k.words[E]|0,A=b.words[ee]|0,M=g*A+R,l+=M/67108864|0,R=M&67108863}c.words[u]=R|0,x=l|0}return x!==0?c.words[u]=x|0:c.length--,c.strip()}var j=function(b,c,d){var g=b.words,A=c.words,M=d.words,S=0,x,u,l,R=g[0]|0,X=R&8191,ee=R>>>13,E=g[1]|0,W=E&8191,D=E>>>13,L=g[2]|0,z=L&8191,y=L>>>13,$=g[3]|0,Y=$&8191,se=$>>>13,ae=g[4]|0,ge=ae&8191,ve=ae>>>13,Te=g[5]|0,nt=Te&8191,Me=Te>>>13,Ve=g[6]|0,ke=Ve&8191,_e=Ve>>>13,je=g[7]|0,Ge=je&8191,me=je>>>13,Fe=g[8]|0,De=Fe&8191,we=Fe>>>13,We=g[9]|0,Le=We&8191,Pe=We>>>13,ot=A[0]|0,ft=ot&8191,qe=ot>>>13,ct=A[1]|0,ut=ct&8191,Be=ct>>>13,wt=A[2]|0,dt=wt&8191,ze=wt>>>13,At=A[3]|0,Et=At&8191,xe=At>>>13,Ke=A[4]|0,Qe=Ke&8191,Ie=Ke>>>13,Je=A[5]|0,He=Je&8191,Re=Je>>>13,st=A[6]|0,Ye=st&8191,Ne=st>>>13,Xe=A[7]|0,et=Xe&8191,Ee=Xe>>>13,Ue=A[8]|0,at=Ue&8191,Ce=Ue>>>13,Ot=A[9]|0,Tt=Ot&8191,tt=Ot>>>13;d.negative=b.negative^c.negative,d.length=19,x=Math.imul(X,ft),u=Math.imul(X,qe),u=u+Math.imul(ee,ft)|0,l=Math.imul(ee,qe);var bt=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(bt>>>26)|0,bt&=67108863,x=Math.imul(W,ft),u=Math.imul(W,qe),u=u+Math.imul(D,ft)|0,l=Math.imul(D,qe),x=x+Math.imul(X,ut)|0,u=u+Math.imul(X,Be)|0,u=u+Math.imul(ee,ut)|0,l=l+Math.imul(ee,Be)|0;var Rr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Rr>>>26)|0,Rr&=67108863,x=Math.imul(z,ft),u=Math.imul(z,qe),u=u+Math.imul(y,ft)|0,l=Math.imul(y,qe),x=x+Math.imul(W,ut)|0,u=u+Math.imul(W,Be)|0,u=u+Math.imul(D,ut)|0,l=l+Math.imul(D,Be)|0,x=x+Math.imul(X,dt)|0,u=u+Math.imul(X,ze)|0,u=u+Math.imul(ee,dt)|0,l=l+Math.imul(ee,ze)|0;var Nr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,x=Math.imul(Y,ft),u=Math.imul(Y,qe),u=u+Math.imul(se,ft)|0,l=Math.imul(se,qe),x=x+Math.imul(z,ut)|0,u=u+Math.imul(z,Be)|0,u=u+Math.imul(y,ut)|0,l=l+Math.imul(y,Be)|0,x=x+Math.imul(W,dt)|0,u=u+Math.imul(W,ze)|0,u=u+Math.imul(D,dt)|0,l=l+Math.imul(D,ze)|0,x=x+Math.imul(X,Et)|0,u=u+Math.imul(X,xe)|0,u=u+Math.imul(ee,Et)|0,l=l+Math.imul(ee,xe)|0;var Cr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,x=Math.imul(ge,ft),u=Math.imul(ge,qe),u=u+Math.imul(ve,ft)|0,l=Math.imul(ve,qe),x=x+Math.imul(Y,ut)|0,u=u+Math.imul(Y,Be)|0,u=u+Math.imul(se,ut)|0,l=l+Math.imul(se,Be)|0,x=x+Math.imul(z,dt)|0,u=u+Math.imul(z,ze)|0,u=u+Math.imul(y,dt)|0,l=l+Math.imul(y,ze)|0,x=x+Math.imul(W,Et)|0,u=u+Math.imul(W,xe)|0,u=u+Math.imul(D,Et)|0,l=l+Math.imul(D,xe)|0,x=x+Math.imul(X,Qe)|0,u=u+Math.imul(X,Ie)|0,u=u+Math.imul(ee,Qe)|0,l=l+Math.imul(ee,Ie)|0;var Or=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Or>>>26)|0,Or&=67108863,x=Math.imul(nt,ft),u=Math.imul(nt,qe),u=u+Math.imul(Me,ft)|0,l=Math.imul(Me,qe),x=x+Math.imul(ge,ut)|0,u=u+Math.imul(ge,Be)|0,u=u+Math.imul(ve,ut)|0,l=l+Math.imul(ve,Be)|0,x=x+Math.imul(Y,dt)|0,u=u+Math.imul(Y,ze)|0,u=u+Math.imul(se,dt)|0,l=l+Math.imul(se,ze)|0,x=x+Math.imul(z,Et)|0,u=u+Math.imul(z,xe)|0,u=u+Math.imul(y,Et)|0,l=l+Math.imul(y,xe)|0,x=x+Math.imul(W,Qe)|0,u=u+Math.imul(W,Ie)|0,u=u+Math.imul(D,Qe)|0,l=l+Math.imul(D,Ie)|0,x=x+Math.imul(X,He)|0,u=u+Math.imul(X,Re)|0,u=u+Math.imul(ee,He)|0,l=l+Math.imul(ee,Re)|0;var Tr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Tr>>>26)|0,Tr&=67108863,x=Math.imul(ke,ft),u=Math.imul(ke,qe),u=u+Math.imul(_e,ft)|0,l=Math.imul(_e,qe),x=x+Math.imul(nt,ut)|0,u=u+Math.imul(nt,Be)|0,u=u+Math.imul(Me,ut)|0,l=l+Math.imul(Me,Be)|0,x=x+Math.imul(ge,dt)|0,u=u+Math.imul(ge,ze)|0,u=u+Math.imul(ve,dt)|0,l=l+Math.imul(ve,ze)|0,x=x+Math.imul(Y,Et)|0,u=u+Math.imul(Y,xe)|0,u=u+Math.imul(se,Et)|0,l=l+Math.imul(se,xe)|0,x=x+Math.imul(z,Qe)|0,u=u+Math.imul(z,Ie)|0,u=u+Math.imul(y,Qe)|0,l=l+Math.imul(y,Ie)|0,x=x+Math.imul(W,He)|0,u=u+Math.imul(W,Re)|0,u=u+Math.imul(D,He)|0,l=l+Math.imul(D,Re)|0,x=x+Math.imul(X,Ye)|0,u=u+Math.imul(X,Ne)|0,u=u+Math.imul(ee,Ye)|0,l=l+Math.imul(ee,Ne)|0;var Yt=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,x=Math.imul(Ge,ft),u=Math.imul(Ge,qe),u=u+Math.imul(me,ft)|0,l=Math.imul(me,qe),x=x+Math.imul(ke,ut)|0,u=u+Math.imul(ke,Be)|0,u=u+Math.imul(_e,ut)|0,l=l+Math.imul(_e,Be)|0,x=x+Math.imul(nt,dt)|0,u=u+Math.imul(nt,ze)|0,u=u+Math.imul(Me,dt)|0,l=l+Math.imul(Me,ze)|0,x=x+Math.imul(ge,Et)|0,u=u+Math.imul(ge,xe)|0,u=u+Math.imul(ve,Et)|0,l=l+Math.imul(ve,xe)|0,x=x+Math.imul(Y,Qe)|0,u=u+Math.imul(Y,Ie)|0,u=u+Math.imul(se,Qe)|0,l=l+Math.imul(se,Ie)|0,x=x+Math.imul(z,He)|0,u=u+Math.imul(z,Re)|0,u=u+Math.imul(y,He)|0,l=l+Math.imul(y,Re)|0,x=x+Math.imul(W,Ye)|0,u=u+Math.imul(W,Ne)|0,u=u+Math.imul(D,Ye)|0,l=l+Math.imul(D,Ne)|0,x=x+Math.imul(X,et)|0,u=u+Math.imul(X,Ee)|0,u=u+Math.imul(ee,et)|0,l=l+Math.imul(ee,Ee)|0;var Jr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,x=Math.imul(De,ft),u=Math.imul(De,qe),u=u+Math.imul(we,ft)|0,l=Math.imul(we,qe),x=x+Math.imul(Ge,ut)|0,u=u+Math.imul(Ge,Be)|0,u=u+Math.imul(me,ut)|0,l=l+Math.imul(me,Be)|0,x=x+Math.imul(ke,dt)|0,u=u+Math.imul(ke,ze)|0,u=u+Math.imul(_e,dt)|0,l=l+Math.imul(_e,ze)|0,x=x+Math.imul(nt,Et)|0,u=u+Math.imul(nt,xe)|0,u=u+Math.imul(Me,Et)|0,l=l+Math.imul(Me,xe)|0,x=x+Math.imul(ge,Qe)|0,u=u+Math.imul(ge,Ie)|0,u=u+Math.imul(ve,Qe)|0,l=l+Math.imul(ve,Ie)|0,x=x+Math.imul(Y,He)|0,u=u+Math.imul(Y,Re)|0,u=u+Math.imul(se,He)|0,l=l+Math.imul(se,Re)|0,x=x+Math.imul(z,Ye)|0,u=u+Math.imul(z,Ne)|0,u=u+Math.imul(y,Ye)|0,l=l+Math.imul(y,Ne)|0,x=x+Math.imul(W,et)|0,u=u+Math.imul(W,Ee)|0,u=u+Math.imul(D,et)|0,l=l+Math.imul(D,Ee)|0,x=x+Math.imul(X,at)|0,u=u+Math.imul(X,Ce)|0,u=u+Math.imul(ee,at)|0,l=l+Math.imul(ee,Ce)|0;var ji=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(ji>>>26)|0,ji&=67108863,x=Math.imul(Le,ft),u=Math.imul(Le,qe),u=u+Math.imul(Pe,ft)|0,l=Math.imul(Pe,qe),x=x+Math.imul(De,ut)|0,u=u+Math.imul(De,Be)|0,u=u+Math.imul(we,ut)|0,l=l+Math.imul(we,Be)|0,x=x+Math.imul(Ge,dt)|0,u=u+Math.imul(Ge,ze)|0,u=u+Math.imul(me,dt)|0,l=l+Math.imul(me,ze)|0,x=x+Math.imul(ke,Et)|0,u=u+Math.imul(ke,xe)|0,u=u+Math.imul(_e,Et)|0,l=l+Math.imul(_e,xe)|0,x=x+Math.imul(nt,Qe)|0,u=u+Math.imul(nt,Ie)|0,u=u+Math.imul(Me,Qe)|0,l=l+Math.imul(Me,Ie)|0,x=x+Math.imul(ge,He)|0,u=u+Math.imul(ge,Re)|0,u=u+Math.imul(ve,He)|0,l=l+Math.imul(ve,Re)|0,x=x+Math.imul(Y,Ye)|0,u=u+Math.imul(Y,Ne)|0,u=u+Math.imul(se,Ye)|0,l=l+Math.imul(se,Ne)|0,x=x+Math.imul(z,et)|0,u=u+Math.imul(z,Ee)|0,u=u+Math.imul(y,et)|0,l=l+Math.imul(y,Ee)|0,x=x+Math.imul(W,at)|0,u=u+Math.imul(W,Ce)|0,u=u+Math.imul(D,at)|0,l=l+Math.imul(D,Ce)|0,x=x+Math.imul(X,Tt)|0,u=u+Math.imul(X,tt)|0,u=u+Math.imul(ee,Tt)|0,l=l+Math.imul(ee,tt)|0;var Wr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Wr>>>26)|0,Wr&=67108863,x=Math.imul(Le,ut),u=Math.imul(Le,Be),u=u+Math.imul(Pe,ut)|0,l=Math.imul(Pe,Be),x=x+Math.imul(De,dt)|0,u=u+Math.imul(De,ze)|0,u=u+Math.imul(we,dt)|0,l=l+Math.imul(we,ze)|0,x=x+Math.imul(Ge,Et)|0,u=u+Math.imul(Ge,xe)|0,u=u+Math.imul(me,Et)|0,l=l+Math.imul(me,xe)|0,x=x+Math.imul(ke,Qe)|0,u=u+Math.imul(ke,Ie)|0,u=u+Math.imul(_e,Qe)|0,l=l+Math.imul(_e,Ie)|0,x=x+Math.imul(nt,He)|0,u=u+Math.imul(nt,Re)|0,u=u+Math.imul(Me,He)|0,l=l+Math.imul(Me,Re)|0,x=x+Math.imul(ge,Ye)|0,u=u+Math.imul(ge,Ne)|0,u=u+Math.imul(ve,Ye)|0,l=l+Math.imul(ve,Ne)|0,x=x+Math.imul(Y,et)|0,u=u+Math.imul(Y,Ee)|0,u=u+Math.imul(se,et)|0,l=l+Math.imul(se,Ee)|0,x=x+Math.imul(z,at)|0,u=u+Math.imul(z,Ce)|0,u=u+Math.imul(y,at)|0,l=l+Math.imul(y,Ce)|0,x=x+Math.imul(W,Tt)|0,u=u+Math.imul(W,tt)|0,u=u+Math.imul(D,Tt)|0,l=l+Math.imul(D,tt)|0;var Fi=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Fi>>>26)|0,Fi&=67108863,x=Math.imul(Le,dt),u=Math.imul(Le,ze),u=u+Math.imul(Pe,dt)|0,l=Math.imul(Pe,ze),x=x+Math.imul(De,Et)|0,u=u+Math.imul(De,xe)|0,u=u+Math.imul(we,Et)|0,l=l+Math.imul(we,xe)|0,x=x+Math.imul(Ge,Qe)|0,u=u+Math.imul(Ge,Ie)|0,u=u+Math.imul(me,Qe)|0,l=l+Math.imul(me,Ie)|0,x=x+Math.imul(ke,He)|0,u=u+Math.imul(ke,Re)|0,u=u+Math.imul(_e,He)|0,l=l+Math.imul(_e,Re)|0,x=x+Math.imul(nt,Ye)|0,u=u+Math.imul(nt,Ne)|0,u=u+Math.imul(Me,Ye)|0,l=l+Math.imul(Me,Ne)|0,x=x+Math.imul(ge,et)|0,u=u+Math.imul(ge,Ee)|0,u=u+Math.imul(ve,et)|0,l=l+Math.imul(ve,Ee)|0,x=x+Math.imul(Y,at)|0,u=u+Math.imul(Y,Ce)|0,u=u+Math.imul(se,at)|0,l=l+Math.imul(se,Ce)|0,x=x+Math.imul(z,Tt)|0,u=u+Math.imul(z,tt)|0,u=u+Math.imul(y,Tt)|0,l=l+Math.imul(y,tt)|0;var Ki=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Ki>>>26)|0,Ki&=67108863,x=Math.imul(Le,Et),u=Math.imul(Le,xe),u=u+Math.imul(Pe,Et)|0,l=Math.imul(Pe,xe),x=x+Math.imul(De,Qe)|0,u=u+Math.imul(De,Ie)|0,u=u+Math.imul(we,Qe)|0,l=l+Math.imul(we,Ie)|0,x=x+Math.imul(Ge,He)|0,u=u+Math.imul(Ge,Re)|0,u=u+Math.imul(me,He)|0,l=l+Math.imul(me,Re)|0,x=x+Math.imul(ke,Ye)|0,u=u+Math.imul(ke,Ne)|0,u=u+Math.imul(_e,Ye)|0,l=l+Math.imul(_e,Ne)|0,x=x+Math.imul(nt,et)|0,u=u+Math.imul(nt,Ee)|0,u=u+Math.imul(Me,et)|0,l=l+Math.imul(Me,Ee)|0,x=x+Math.imul(ge,at)|0,u=u+Math.imul(ge,Ce)|0,u=u+Math.imul(ve,at)|0,l=l+Math.imul(ve,Ce)|0,x=x+Math.imul(Y,Tt)|0,u=u+Math.imul(Y,tt)|0,u=u+Math.imul(se,Tt)|0,l=l+Math.imul(se,tt)|0;var Qr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Qr>>>26)|0,Qr&=67108863,x=Math.imul(Le,Qe),u=Math.imul(Le,Ie),u=u+Math.imul(Pe,Qe)|0,l=Math.imul(Pe,Ie),x=x+Math.imul(De,He)|0,u=u+Math.imul(De,Re)|0,u=u+Math.imul(we,He)|0,l=l+Math.imul(we,Re)|0,x=x+Math.imul(Ge,Ye)|0,u=u+Math.imul(Ge,Ne)|0,u=u+Math.imul(me,Ye)|0,l=l+Math.imul(me,Ne)|0,x=x+Math.imul(ke,et)|0,u=u+Math.imul(ke,Ee)|0,u=u+Math.imul(_e,et)|0,l=l+Math.imul(_e,Ee)|0,x=x+Math.imul(nt,at)|0,u=u+Math.imul(nt,Ce)|0,u=u+Math.imul(Me,at)|0,l=l+Math.imul(Me,Ce)|0,x=x+Math.imul(ge,Tt)|0,u=u+Math.imul(ge,tt)|0,u=u+Math.imul(ve,Tt)|0,l=l+Math.imul(ve,tt)|0;var _i=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(_i>>>26)|0,_i&=67108863,x=Math.imul(Le,He),u=Math.imul(Le,Re),u=u+Math.imul(Pe,He)|0,l=Math.imul(Pe,Re),x=x+Math.imul(De,Ye)|0,u=u+Math.imul(De,Ne)|0,u=u+Math.imul(we,Ye)|0,l=l+Math.imul(we,Ne)|0,x=x+Math.imul(Ge,et)|0,u=u+Math.imul(Ge,Ee)|0,u=u+Math.imul(me,et)|0,l=l+Math.imul(me,Ee)|0,x=x+Math.imul(ke,at)|0,u=u+Math.imul(ke,Ce)|0,u=u+Math.imul(_e,at)|0,l=l+Math.imul(_e,Ce)|0,x=x+Math.imul(nt,Tt)|0,u=u+Math.imul(nt,tt)|0,u=u+Math.imul(Me,Tt)|0,l=l+Math.imul(Me,tt)|0;var Ai=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Ai>>>26)|0,Ai&=67108863,x=Math.imul(Le,Ye),u=Math.imul(Le,Ne),u=u+Math.imul(Pe,Ye)|0,l=Math.imul(Pe,Ne),x=x+Math.imul(De,et)|0,u=u+Math.imul(De,Ee)|0,u=u+Math.imul(we,et)|0,l=l+Math.imul(we,Ee)|0,x=x+Math.imul(Ge,at)|0,u=u+Math.imul(Ge,Ce)|0,u=u+Math.imul(me,at)|0,l=l+Math.imul(me,Ce)|0,x=x+Math.imul(ke,Tt)|0,u=u+Math.imul(ke,tt)|0,u=u+Math.imul(_e,Tt)|0,l=l+Math.imul(_e,tt)|0;var hr=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(hr>>>26)|0,hr&=67108863,x=Math.imul(Le,et),u=Math.imul(Le,Ee),u=u+Math.imul(Pe,et)|0,l=Math.imul(Pe,Ee),x=x+Math.imul(De,at)|0,u=u+Math.imul(De,Ce)|0,u=u+Math.imul(we,at)|0,l=l+Math.imul(we,Ce)|0,x=x+Math.imul(Ge,Tt)|0,u=u+Math.imul(Ge,tt)|0,u=u+Math.imul(me,Tt)|0,l=l+Math.imul(me,tt)|0;var Hi=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,x=Math.imul(Le,at),u=Math.imul(Le,Ce),u=u+Math.imul(Pe,at)|0,l=Math.imul(Pe,Ce),x=x+Math.imul(De,Tt)|0,u=u+Math.imul(De,tt)|0,u=u+Math.imul(we,Tt)|0,l=l+Math.imul(we,tt)|0;var Vi=(S+x|0)+((u&8191)<<13)|0;S=(l+(u>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,x=Math.imul(Le,Tt),u=Math.imul(Le,tt),u=u+Math.imul(Pe,Tt)|0,l=Math.imul(Pe,tt);var Gi=(S+x|0)+((u&8191)<<13)|0;return S=(l+(u>>>13)|0)+(Gi>>>26)|0,Gi&=67108863,M[0]=bt,M[1]=Rr,M[2]=Nr,M[3]=Cr,M[4]=Or,M[5]=Tr,M[6]=Yt,M[7]=Jr,M[8]=ji,M[9]=Wr,M[10]=Fi,M[11]=Ki,M[12]=Qr,M[13]=_i,M[14]=Ai,M[15]=hr,M[16]=Hi,M[17]=Vi,M[18]=Gi,S!==0&&(M[19]=S,d.length++),d};Math.imul||(j=q);function K(k,b,c){c.negative=b.negative^k.negative,c.length=k.length+b.length;for(var d=0,g=0,A=0;A<c.length-1;A++){var M=g;g=0;for(var S=d&67108863,x=Math.min(A,b.length-1),u=Math.max(0,A-k.length+1);u<=x;u++){var l=A-u,R=k.words[l]|0,X=b.words[u]|0,ee=R*X,E=ee&67108863;M=M+(ee/67108864|0)|0,E=E+S|0,S=E&67108863,M=M+(E>>>26)|0,g+=M>>>26,M&=67108863}c.words[A]=S,d=M,M=g}return d!==0?c.words[A]=d:c.length--,c.strip()}function J(k,b,c){var d=new Z;return d.mulp(k,b,c)}a.prototype.mulTo=function(b,c){var d,g=this.length+b.length;return this.length===10&&b.length===10?d=j(this,b,c):g<63?d=q(this,b,c):g<1024?d=K(this,b,c):d=J(this,b,c),d};function Z(k,b){this.x=k,this.y=b}Z.prototype.makeRBT=function(b){for(var c=new Array(b),d=a.prototype._countBits(b)-1,g=0;g<b;g++)c[g]=this.revBin(g,d,b);return c},Z.prototype.revBin=function(b,c,d){if(b===0||b===d-1)return b;for(var g=0,A=0;A<c;A++)g|=(b&1)<<c-A-1,b>>=1;return g},Z.prototype.permute=function(b,c,d,g,A,M){for(var S=0;S<M;S++)g[S]=c[b[S]],A[S]=d[b[S]]},Z.prototype.transform=function(b,c,d,g,A,M){this.permute(M,b,c,d,g,A);for(var S=1;S<A;S<<=1)for(var x=S<<1,u=Math.cos(2*Math.PI/x),l=Math.sin(2*Math.PI/x),R=0;R<A;R+=x)for(var X=u,ee=l,E=0;E<S;E++){var W=d[R+E],D=g[R+E],L=d[R+E+S],z=g[R+E+S],y=X*L-ee*z;z=X*z+ee*L,L=y,d[R+E]=W+L,g[R+E]=D+z,d[R+E+S]=W-L,g[R+E+S]=D-z,E!==x&&(y=u*X-l*ee,ee=u*ee+l*X,X=y)}},Z.prototype.guessLen13b=function(b,c){var d=Math.max(c,b)|1,g=d&1,A=0;for(d=d/2|0;d;d=d>>>1)A++;return 1<<A+1+g},Z.prototype.conjugate=function(b,c,d){if(!(d<=1))for(var g=0;g<d/2;g++){var A=b[g];b[g]=b[d-g-1],b[d-g-1]=A,A=c[g],c[g]=-c[d-g-1],c[d-g-1]=-A}},Z.prototype.normalize13b=function(b,c){for(var d=0,g=0;g<c/2;g++){var A=Math.round(b[2*g+1]/c)*8192+Math.round(b[2*g]/c)+d;b[g]=A&67108863,A<67108864?d=0:d=A/67108864|0}return b},Z.prototype.convert13b=function(b,c,d,g){for(var A=0,M=0;M<c;M++)A=A+(b[M]|0),d[2*M]=A&8191,A=A>>>13,d[2*M+1]=A&8191,A=A>>>13;for(M=2*c;M<g;++M)d[M]=0;i(A===0),i((A&-8192)===0)},Z.prototype.stub=function(b){for(var c=new Array(b),d=0;d<b;d++)c[d]=0;return c},Z.prototype.mulp=function(b,c,d){var g=2*this.guessLen13b(b.length,c.length),A=this.makeRBT(g),M=this.stub(g),S=new Array(g),x=new Array(g),u=new Array(g),l=new Array(g),R=new Array(g),X=new Array(g),ee=d.words;ee.length=g,this.convert13b(b.words,b.length,S,g),this.convert13b(c.words,c.length,l,g),this.transform(S,M,x,u,g,A),this.transform(l,M,R,X,g,A);for(var E=0;E<g;E++){var W=x[E]*R[E]-u[E]*X[E];u[E]=x[E]*X[E]+u[E]*R[E],x[E]=W}return this.conjugate(x,u,g),this.transform(x,u,ee,M,g,A),this.conjugate(ee,M,g),this.normalize13b(ee,g),d.negative=b.negative^c.negative,d.length=b.length+c.length,d.strip()},a.prototype.mul=function(b){var c=new a(null);return c.words=new Array(this.length+b.length),this.mulTo(b,c)},a.prototype.mulf=function(b){var c=new a(null);return c.words=new Array(this.length+b.length),J(this,b,c)},a.prototype.imul=function(b){return this.clone().mulTo(b,this)},a.prototype.imuln=function(b){i(typeof b=="number"),i(b<67108864);for(var c=0,d=0;d<this.length;d++){var g=(this.words[d]|0)*b,A=(g&67108863)+(c&67108863);c>>=26,c+=g/67108864|0,c+=A>>>26,this.words[d]=A&67108863}return c!==0&&(this.words[d]=c,this.length++),this},a.prototype.muln=function(b){return this.clone().imuln(b)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(b){var c=O(b);if(c.length===0)return new a(1);for(var d=this,g=0;g<c.length&&c[g]===0;g++,d=d.sqr());if(++g<c.length)for(var A=d.sqr();g<c.length;g++,A=A.sqr())c[g]!==0&&(d=d.mul(A));return d},a.prototype.iushln=function(b){i(typeof b=="number"&&b>=0);var c=b%26,d=(b-c)/26,g=67108863>>>26-c<<26-c,A;if(c!==0){var M=0;for(A=0;A<this.length;A++){var S=this.words[A]&g,x=(this.words[A]|0)-S<<c;this.words[A]=x|M,M=S>>>26-c}M&&(this.words[A]=M,this.length++)}if(d!==0){for(A=this.length-1;A>=0;A--)this.words[A+d]=this.words[A];for(A=0;A<d;A++)this.words[A]=0;this.length+=d}return this.strip()},a.prototype.ishln=function(b){return i(this.negative===0),this.iushln(b)},a.prototype.iushrn=function(b,c,d){i(typeof b=="number"&&b>=0);var g;c?g=(c-c%26)/26:g=0;var A=b%26,M=Math.min((b-A)/26,this.length),S=67108863^67108863>>>A<<A,x=d;if(g-=M,g=Math.max(0,g),x){for(var u=0;u<M;u++)x.words[u]=this.words[u];x.length=M}if(M!==0)if(this.length>M)for(this.length-=M,u=0;u<this.length;u++)this.words[u]=this.words[u+M];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(l!==0||u>=g);u--){var R=this.words[u]|0;this.words[u]=l<<26-A|R>>>A,l=R&S}return x&&l!==0&&(x.words[x.length++]=l),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(b,c,d){return i(this.negative===0),this.iushrn(b,c,d)},a.prototype.shln=function(b){return this.clone().ishln(b)},a.prototype.ushln=function(b){return this.clone().iushln(b)},a.prototype.shrn=function(b){return this.clone().ishrn(b)},a.prototype.ushrn=function(b){return this.clone().iushrn(b)},a.prototype.testn=function(b){i(typeof b=="number"&&b>=0);var c=b%26,d=(b-c)/26,g=1<<c;if(this.length<=d)return!1;var A=this.words[d];return!!(A&g)},a.prototype.imaskn=function(b){i(typeof b=="number"&&b>=0);var c=b%26,d=(b-c)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(c!==0&&d++,this.length=Math.min(d,this.length),c!==0){var g=67108863^67108863>>>c<<c;this.words[this.length-1]&=g}return this.strip()},a.prototype.maskn=function(b){return this.clone().imaskn(b)},a.prototype.iaddn=function(b){return i(typeof b=="number"),i(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},a.prototype._iaddn=function(b){this.words[0]+=b;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},a.prototype.isubn=function(b){if(i(typeof b=="number"),i(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this.strip()},a.prototype.addn=function(b){return this.clone().iaddn(b)},a.prototype.subn=function(b){return this.clone().isubn(b)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(b,c,d){var g=b.length+d,A;this._expand(g);var M,S=0;for(A=0;A<b.length;A++){M=(this.words[A+d]|0)+S;var x=(b.words[A]|0)*c;M-=x&67108863,S=(M>>26)-(x/67108864|0),this.words[A+d]=M&67108863}for(;A<this.length-d;A++)M=(this.words[A+d]|0)+S,S=M>>26,this.words[A+d]=M&67108863;if(S===0)return this.strip();for(i(S===-1),S=0,A=0;A<this.length;A++)M=-(this.words[A]|0)+S,S=M>>26,this.words[A]=M&67108863;return this.negative=1,this.strip()},a.prototype._wordDiv=function(b,c){var d=this.length-b.length,g=this.clone(),A=b,M=A.words[A.length-1]|0,S=this._countBits(M);d=26-S,d!==0&&(A=A.ushln(d),g.iushln(d),M=A.words[A.length-1]|0);var x=g.length-A.length,u;if(c!=="mod"){u=new a(null),u.length=x+1,u.words=new Array(u.length);for(var l=0;l<u.length;l++)u.words[l]=0}var R=g.clone()._ishlnsubmul(A,1,x);R.negative===0&&(g=R,u&&(u.words[x]=1));for(var X=x-1;X>=0;X--){var ee=(g.words[A.length+X]|0)*67108864+(g.words[A.length+X-1]|0);for(ee=Math.min(ee/M|0,67108863),g._ishlnsubmul(A,ee,X);g.negative!==0;)ee--,g.negative=0,g._ishlnsubmul(A,1,X),g.isZero()||(g.negative^=1);u&&(u.words[X]=ee)}return u&&u.strip(),g.strip(),c!=="div"&&d!==0&&g.iushrn(d),{div:u||null,mod:g}},a.prototype.divmod=function(b,c,d){if(i(!b.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var g,A,M;return this.negative!==0&&b.negative===0?(M=this.neg().divmod(b,c),c!=="mod"&&(g=M.div.neg()),c!=="div"&&(A=M.mod.neg(),d&&A.negative!==0&&A.iadd(b)),{div:g,mod:A}):this.negative===0&&b.negative!==0?(M=this.divmod(b.neg(),c),c!=="mod"&&(g=M.div.neg()),{div:g,mod:M.mod}):this.negative&b.negative?(M=this.neg().divmod(b.neg(),c),c!=="div"&&(A=M.mod.neg(),d&&A.negative!==0&&A.isub(b)),{div:M.div,mod:A}):b.length>this.length||this.cmp(b)<0?{div:new a(0),mod:this}:b.length===1?c==="div"?{div:this.divn(b.words[0]),mod:null}:c==="mod"?{div:null,mod:new a(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new a(this.modn(b.words[0]))}:this._wordDiv(b,c)},a.prototype.div=function(b){return this.divmod(b,"div",!1).div},a.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},a.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},a.prototype.divRound=function(b){var c=this.divmod(b);if(c.mod.isZero())return c.div;var d=c.div.negative!==0?c.mod.isub(b):c.mod,g=b.ushrn(1),A=b.andln(1),M=d.cmp(g);return M<0||A===1&&M===0?c.div:c.div.negative!==0?c.div.isubn(1):c.div.iaddn(1)},a.prototype.modn=function(b){i(b<=67108863);for(var c=(1<<26)%b,d=0,g=this.length-1;g>=0;g--)d=(c*d+(this.words[g]|0))%b;return d},a.prototype.idivn=function(b){i(b<=67108863);for(var c=0,d=this.length-1;d>=0;d--){var g=(this.words[d]|0)+c*67108864;this.words[d]=g/b|0,c=g%b}return this.strip()},a.prototype.divn=function(b){return this.clone().idivn(b)},a.prototype.egcd=function(b){i(b.negative===0),i(!b.isZero());var c=this,d=b.clone();c.negative!==0?c=c.umod(b):c=c.clone();for(var g=new a(1),A=new a(0),M=new a(0),S=new a(1),x=0;c.isEven()&&d.isEven();)c.iushrn(1),d.iushrn(1),++x;for(var u=d.clone(),l=c.clone();!c.isZero();){for(var R=0,X=1;!(c.words[0]&X)&&R<26;++R,X<<=1);if(R>0)for(c.iushrn(R);R-- >0;)(g.isOdd()||A.isOdd())&&(g.iadd(u),A.isub(l)),g.iushrn(1),A.iushrn(1);for(var ee=0,E=1;!(d.words[0]&E)&&ee<26;++ee,E<<=1);if(ee>0)for(d.iushrn(ee);ee-- >0;)(M.isOdd()||S.isOdd())&&(M.iadd(u),S.isub(l)),M.iushrn(1),S.iushrn(1);c.cmp(d)>=0?(c.isub(d),g.isub(M),A.isub(S)):(d.isub(c),M.isub(g),S.isub(A))}return{a:M,b:S,gcd:d.iushln(x)}},a.prototype._invmp=function(b){i(b.negative===0),i(!b.isZero());var c=this,d=b.clone();c.negative!==0?c=c.umod(b):c=c.clone();for(var g=new a(1),A=new a(0),M=d.clone();c.cmpn(1)>0&&d.cmpn(1)>0;){for(var S=0,x=1;!(c.words[0]&x)&&S<26;++S,x<<=1);if(S>0)for(c.iushrn(S);S-- >0;)g.isOdd()&&g.iadd(M),g.iushrn(1);for(var u=0,l=1;!(d.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(d.iushrn(u);u-- >0;)A.isOdd()&&A.iadd(M),A.iushrn(1);c.cmp(d)>=0?(c.isub(d),g.isub(A)):(d.isub(c),A.isub(g))}var R;return c.cmpn(1)===0?R=g:R=A,R.cmpn(0)<0&&R.iadd(b),R},a.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var c=this.clone(),d=b.clone();c.negative=0,d.negative=0;for(var g=0;c.isEven()&&d.isEven();g++)c.iushrn(1),d.iushrn(1);do{for(;c.isEven();)c.iushrn(1);for(;d.isEven();)d.iushrn(1);var A=c.cmp(d);if(A<0){var M=c;c=d,d=M}else if(A===0||d.cmpn(1)===0)break;c.isub(d)}while(!0);return d.iushln(g)},a.prototype.invm=function(b){return this.egcd(b).a.umod(b)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(b){return this.words[0]&b},a.prototype.bincn=function(b){i(typeof b=="number");var c=b%26,d=(b-c)/26,g=1<<c;if(this.length<=d)return this._expand(d+1),this.words[d]|=g,this;for(var A=g,M=d;A!==0&&M<this.length;M++){var S=this.words[M]|0;S+=A,A=S>>>26,S&=67108863,this.words[M]=S}return A!==0&&(this.words[M]=A,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(b){var c=b<0;if(this.negative!==0&&!c)return-1;if(this.negative===0&&c)return 1;this.strip();var d;if(this.length>1)d=1;else{c&&(b=-b),i(b<=67108863,"Number is too big");var g=this.words[0]|0;d=g===b?0:g<b?-1:1}return this.negative!==0?-d|0:d},a.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var c=this.ucmp(b);return this.negative!==0?-c|0:c},a.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var c=0,d=this.length-1;d>=0;d--){var g=this.words[d]|0,A=b.words[d]|0;if(g!==A){g<A?c=-1:g>A&&(c=1);break}}return c},a.prototype.gtn=function(b){return this.cmpn(b)===1},a.prototype.gt=function(b){return this.cmp(b)===1},a.prototype.gten=function(b){return this.cmpn(b)>=0},a.prototype.gte=function(b){return this.cmp(b)>=0},a.prototype.ltn=function(b){return this.cmpn(b)===-1},a.prototype.lt=function(b){return this.cmp(b)===-1},a.prototype.lten=function(b){return this.cmpn(b)<=0},a.prototype.lte=function(b){return this.cmp(b)<=0},a.prototype.eqn=function(b){return this.cmpn(b)===0},a.prototype.eq=function(b){return this.cmp(b)===0},a.red=function(b){return new Ae(b)},a.prototype.toRed=function(b){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(b){return this.red=b,this},a.prototype.forceRed=function(b){return i(!this.red,"Already a number in reduction context"),this._forceRed(b)},a.prototype.redAdd=function(b){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},a.prototype.redIAdd=function(b){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},a.prototype.redSub=function(b){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},a.prototype.redISub=function(b){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},a.prototype.redShl=function(b){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},a.prototype.redMul=function(b){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},a.prototype.redIMul=function(b){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(b){return i(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var de={k256:null,p224:null,p192:null,p25519:null};function oe(k,b){this.name=k,this.p=new a(b,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}oe.prototype._tmp=function(){var b=new a(null);return b.words=new Array(Math.ceil(this.n/13)),b},oe.prototype.ireduce=function(b){var c=b,d;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),d=c.bitLength();while(d>this.n);var g=d<this.n?-1:c.ucmp(this.p);return g===0?(c.words[0]=0,c.length=1):g>0?c.isub(this.p):c.strip!==void 0?c.strip():c._strip(),c},oe.prototype.split=function(b,c){b.iushrn(this.n,0,c)},oe.prototype.imulK=function(b){return b.imul(this.k)};function re(){oe.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(re,oe),re.prototype.split=function(b,c){for(var d=4194303,g=Math.min(b.length,9),A=0;A<g;A++)c.words[A]=b.words[A];if(c.length=g,b.length<=9){b.words[0]=0,b.length=1;return}var M=b.words[9];for(c.words[c.length++]=M&d,A=10;A<b.length;A++){var S=b.words[A]|0;b.words[A-10]=(S&d)<<4|M>>>22,M=S}M>>>=22,b.words[A-10]=M,M===0&&b.length>10?b.length-=10:b.length-=9},re.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var c=0,d=0;d<b.length;d++){var g=b.words[d]|0;c+=g*977,b.words[d]=c&67108863,c=g*64+(c/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function fe(){oe.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(fe,oe);function ue(){oe.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(ue,oe);function le(){oe.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(le,oe),le.prototype.imulK=function(b){for(var c=0,d=0;d<b.length;d++){var g=(b.words[d]|0)*19+c,A=g&67108863;g>>>=26,b.words[d]=A,c=g}return c!==0&&(b.words[b.length++]=c),b},a._prime=function(b){if(de[b])return de[b];var c;if(b==="k256")c=new re;else if(b==="p224")c=new fe;else if(b==="p192")c=new ue;else if(b==="p25519")c=new le;else throw new Error("Unknown prime "+b);return de[b]=c,c};function Ae(k){if(typeof k=="string"){var b=a._prime(k);this.m=b.p,this.prime=b}else i(k.gtn(1),"modulus must be greater than 1"),this.m=k,this.prime=null}Ae.prototype._verify1=function(b){i(b.negative===0,"red works only with positives"),i(b.red,"red works only with red numbers")},Ae.prototype._verify2=function(b,c){i((b.negative|c.negative)===0,"red works only with positives"),i(b.red&&b.red===c.red,"red works only with red numbers")},Ae.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},Ae.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},Ae.prototype.add=function(b,c){this._verify2(b,c);var d=b.add(c);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},Ae.prototype.iadd=function(b,c){this._verify2(b,c);var d=b.iadd(c);return d.cmp(this.m)>=0&&d.isub(this.m),d},Ae.prototype.sub=function(b,c){this._verify2(b,c);var d=b.sub(c);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},Ae.prototype.isub=function(b,c){this._verify2(b,c);var d=b.isub(c);return d.cmpn(0)<0&&d.iadd(this.m),d},Ae.prototype.shl=function(b,c){return this._verify1(b),this.imod(b.ushln(c))},Ae.prototype.imul=function(b,c){return this._verify2(b,c),this.imod(b.imul(c))},Ae.prototype.mul=function(b,c){return this._verify2(b,c),this.imod(b.mul(c))},Ae.prototype.isqr=function(b){return this.imul(b,b.clone())},Ae.prototype.sqr=function(b){return this.mul(b,b)},Ae.prototype.sqrt=function(b){if(b.isZero())return b.clone();var c=this.m.andln(3);if(i(c%2===1),c===3){var d=this.m.add(new a(1)).iushrn(2);return this.pow(b,d)}for(var g=this.m.subn(1),A=0;!g.isZero()&&g.andln(1)===0;)A++,g.iushrn(1);i(!g.isZero());var M=new a(1).toRed(this),S=M.redNeg(),x=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new a(2*u*u).toRed(this);this.pow(u,x).cmp(S)!==0;)u.redIAdd(S);for(var l=this.pow(u,g),R=this.pow(b,g.addn(1).iushrn(1)),X=this.pow(b,g),ee=A;X.cmp(M)!==0;){for(var E=X,W=0;E.cmp(M)!==0;W++)E=E.redSqr();i(W<ee);var D=this.pow(l,new a(1).iushln(ee-W-1));R=R.redMul(D),l=D.redSqr(),X=X.redMul(l),ee=W}return R},Ae.prototype.invm=function(b){var c=b._invmp(this.m);return c.negative!==0?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},Ae.prototype.pow=function(b,c){if(c.isZero())return new a(1).toRed(this);if(c.cmpn(1)===0)return b.clone();var d=4,g=new Array(1<<d);g[0]=new a(1).toRed(this),g[1]=b;for(var A=2;A<g.length;A++)g[A]=this.mul(g[A-1],b);var M=g[0],S=0,x=0,u=c.bitLength()%26;for(u===0&&(u=26),A=c.length-1;A>=0;A--){for(var l=c.words[A],R=u-1;R>=0;R--){var X=l>>R&1;if(M!==g[0]&&(M=this.sqr(M)),X===0&&S===0){x=0;continue}S<<=1,S|=X,x++,!(x!==d&&(A!==0||R!==0))&&(M=this.mul(M,g[S]),x=0,S=0)}u=26}return M},Ae.prototype.convertTo=function(b){var c=b.umod(this.m);return c===b?c.clone():c},Ae.prototype.convertFrom=function(b){var c=b.clone();return c.red=null,c},a.mont=function(b){return new ht(b)};function ht(k){Ae.call(this,k),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(ht,Ae),ht.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},ht.prototype.convertFrom=function(b){var c=this.imod(b.mul(this.rinv));return c.red=null,c},ht.prototype.imul=function(b,c){if(b.isZero()||c.isZero())return b.words[0]=0,b.length=1,b;var d=b.imul(c),g=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),A=d.isub(g).iushrn(this.shift),M=A;return A.cmp(this.m)>=0?M=A.isub(this.m):A.cmpn(0)<0&&(M=A.iadd(this.m)),M._forceRed(this)},ht.prototype.mul=function(b,c){if(b.isZero()||c.isZero())return new a(0)._forceRed(this);var d=b.mul(c),g=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),A=d.isub(g).iushrn(this.shift),M=A;return A.cmp(this.m)>=0?M=A.isub(this.m):A.cmpn(0)<0&&(M=A.iadd(this.m)),M._forceRed(this)},ht.prototype.invm=function(b){var c=this.imod(b._invmp(this.m).mul(this.r2));return c._forceRed(this)}})(r,Lo)})(qd);var hs=qd.exports,oa=qg;function qg(r,e){if(!r)throw new Error(e||"Assertion failed")}qg.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)};var Dd={};(function(r){var e=r;function t(a,h){if(Array.isArray(a))return a.slice();if(!a)return[];var p=[];if(typeof a!="string"){for(var m=0;m<a.length;m++)p[m]=a[m]|0;return p}if(h==="hex"){a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a);for(var m=0;m<a.length;m+=2)p.push(parseInt(a[m]+a[m+1],16))}else for(var m=0;m<a.length;m++){var v=a.charCodeAt(m),_=v>>8,I=v&255;_?p.push(_,I):p.push(I)}return p}e.toArray=t;function i(a){return a.length===1?"0"+a:a}e.zero2=i;function s(a){for(var h="",p=0;p<a.length;p++)h+=i(a[p].toString(16));return h}e.toHex=s,e.encode=function(h,p){return p==="hex"?s(h):h}})(Dd);(function(r){var e=r,t=hs,i=oa,s=Dd;e.assert=i,e.toArray=s.toArray,e.zero2=s.zero2,e.toHex=s.toHex,e.encode=s.encode;function a(_,I,N){var O=new Array(Math.max(_.bitLength(),N)+1),q;for(q=0;q<O.length;q+=1)O[q]=0;var j=1<<I+1,K=_.clone();for(q=0;q<O.length;q++){var J,Z=K.andln(j-1);K.isOdd()?(Z>(j>>1)-1?J=(j>>1)-Z:J=Z,K.isubn(J)):J=0,O[q]=J,K.iushrn(1)}return O}e.getNAF=a;function h(_,I){var N=[[],[]];_=_.clone(),I=I.clone();for(var O=0,q=0,j;_.cmpn(-O)>0||I.cmpn(-q)>0;){var K=_.andln(3)+O&3,J=I.andln(3)+q&3;K===3&&(K=-1),J===3&&(J=-1);var Z;K&1?(j=_.andln(7)+O&7,(j===3||j===5)&&J===2?Z=-K:Z=K):Z=0,N[0].push(Z);var de;J&1?(j=I.andln(7)+q&7,(j===3||j===5)&&K===2?de=-J:de=J):de=0,N[1].push(de),2*O===Z+1&&(O=1-O),2*q===de+1&&(q=1-q),_.iushrn(1),I.iushrn(1)}return N}e.getJSF=h;function p(_,I,N){var O="_"+I;_.prototype[I]=function(){return this[O]!==void 0?this[O]:this[O]=N.call(this)}}e.cachedProperty=p;function m(_){return typeof _=="string"?e.toArray(_,"hex"):_}e.parseBytes=m;function v(_){return new t(_,"hex","le")}e.intFromLE=v})(wi);var Bd={exports:{}},Nu;Bd.exports=function(e){return Nu||(Nu=new Ss(null)),Nu.generate(e)};function Ss(r){this.rand=r}Bd.exports.Rand=Ss;Ss.prototype.generate=function(e){return this._rand(e)};Ss.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Ss.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?Ss.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(Ss.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Sp=vg;if(typeof Sp.randomBytes!="function")throw new Error("Not supported");Ss.prototype._rand=function(e){return Sp.randomBytes(e)}}catch{}var Dg=Bd.exports,$d={},Hs=hs,ic=wi,Uh=ic.getNAF,O8=ic.getJSF,jh=ic.assert;function Ns(r,e){this.type=r,this.p=new Hs(e.p,16),this.red=e.prime?Hs.red(e.prime):Hs.mont(this.p),this.zero=new Hs(0).toRed(this.red),this.one=new Hs(1).toRed(this.red),this.two=new Hs(2).toRed(this.red),this.n=e.n&&new Hs(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var sf=Ns;Ns.prototype.point=function(){throw new Error("Not implemented")};Ns.prototype.validate=function(){throw new Error("Not implemented")};Ns.prototype._fixedNafMul=function(e,t){jh(e.precomputed);var i=e._getDoubles(),s=Uh(t,1,this._bitLength),a=(1<<i.step+1)-(i.step%2===0?2:1);a/=3;var h=[],p,m;for(p=0;p<s.length;p+=i.step){m=0;for(var v=p+i.step-1;v>=p;v--)m=(m<<1)+s[v];h.push(m)}for(var _=this.jpoint(null,null,null),I=this.jpoint(null,null,null),N=a;N>0;N--){for(p=0;p<h.length;p++)m=h[p],m===N?I=I.mixedAdd(i.points[p]):m===-N&&(I=I.mixedAdd(i.points[p].neg()));_=_.add(I)}return _.toP()};Ns.prototype._wnafMul=function(e,t){var i=4,s=e._getNAFPoints(i);i=s.wnd;for(var a=s.points,h=Uh(t,i,this._bitLength),p=this.jpoint(null,null,null),m=h.length-1;m>=0;m--){for(var v=0;m>=0&&h[m]===0;m--)v++;if(m>=0&&v++,p=p.dblp(v),m<0)break;var _=h[m];jh(_!==0),e.type==="affine"?_>0?p=p.mixedAdd(a[_-1>>1]):p=p.mixedAdd(a[-_-1>>1].neg()):_>0?p=p.add(a[_-1>>1]):p=p.add(a[-_-1>>1].neg())}return e.type==="affine"?p.toP():p};Ns.prototype._wnafMulAdd=function(e,t,i,s,a){var h=this._wnafT1,p=this._wnafT2,m=this._wnafT3,v=0,_,I,N;for(_=0;_<s;_++){N=t[_];var O=N._getNAFPoints(e);h[_]=O.wnd,p[_]=O.points}for(_=s-1;_>=1;_-=2){var q=_-1,j=_;if(h[q]!==1||h[j]!==1){m[q]=Uh(i[q],h[q],this._bitLength),m[j]=Uh(i[j],h[j],this._bitLength),v=Math.max(m[q].length,v),v=Math.max(m[j].length,v);continue}var K=[t[q],null,null,t[j]];t[q].y.cmp(t[j].y)===0?(K[1]=t[q].add(t[j]),K[2]=t[q].toJ().mixedAdd(t[j].neg())):t[q].y.cmp(t[j].y.redNeg())===0?(K[1]=t[q].toJ().mixedAdd(t[j]),K[2]=t[q].add(t[j].neg())):(K[1]=t[q].toJ().mixedAdd(t[j]),K[2]=t[q].toJ().mixedAdd(t[j].neg()));var J=[-3,-1,-5,-7,0,7,5,1,3],Z=O8(i[q],i[j]);for(v=Math.max(Z[0].length,v),m[q]=new Array(v),m[j]=new Array(v),I=0;I<v;I++){var de=Z[0][I]|0,oe=Z[1][I]|0;m[q][I]=J[(de+1)*3+(oe+1)],m[j][I]=0,p[q]=K}}var re=this.jpoint(null,null,null),fe=this._wnafT4;for(_=v;_>=0;_--){for(var ue=0;_>=0;){var le=!0;for(I=0;I<s;I++)fe[I]=m[I][_]|0,fe[I]!==0&&(le=!1);if(!le)break;ue++,_--}if(_>=0&&ue++,re=re.dblp(ue),_<0)break;for(I=0;I<s;I++){var Ae=fe[I];Ae!==0&&(Ae>0?N=p[I][Ae-1>>1]:Ae<0&&(N=p[I][-Ae-1>>1].neg()),N.type==="affine"?re=re.mixedAdd(N):re=re.add(N))}}for(_=0;_<s;_++)p[_]=null;return a?re:re.toP()};function zi(r,e){this.curve=r,this.type=e,this.precomputed=null}Ns.BasePoint=zi;zi.prototype.eq=function(){throw new Error("Not implemented")};zi.prototype.validate=function(){return this.curve.validate(this)};Ns.prototype.decodePoint=function(e,t){e=ic.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?jh(e[e.length-1]%2===0):e[0]===7&&jh(e[e.length-1]%2===1);var s=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return s}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};zi.prototype.encodeCompressed=function(e){return this.encode(e,!0)};zi.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};zi.prototype.encode=function(e,t){return ic.encode(this._encode(t),e)};zi.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};zi.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};zi.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],s=this,a=0;a<t;a+=e){for(var h=0;h<e;h++)s=s.dbl();i.push(s)}return{step:e,points:i}};zi.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,s=i===1?null:this.dbl(),a=1;a<i;a++)t[a]=t[a-1].add(s);return{wnd:e,points:t}};zi.prototype._getBeta=function(){return null};zi.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t};var T8=wi,tr=hs,kd=Xh,Ga=sf,q8=T8.assert;function Ui(r){Ga.call(this,"short",r),this.a=new tr(r.a,16).toRed(this.red),this.b=new tr(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}kd(Ui,Ga);var D8=Ui;Ui.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new tr(e.beta,16).toRed(this.red);else{var s=this._getEndoRoots(this.p);t=s[0].cmp(s[1])<0?s[0]:s[1],t=t.toRed(this.red)}if(e.lambda)i=new tr(e.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))===0?i=a[0]:(i=a[1],q8(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var h;return e.basis?h=e.basis.map(function(p){return{a:new tr(p.a,16),b:new tr(p.b,16)}}):h=this._getEndoBasis(i),{beta:t,lambda:i,basis:h}}};Ui.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:tr.mont(e),i=new tr(2).toRed(t).redInvm(),s=i.redNeg(),a=new tr(3).toRed(t).redNeg().redSqrt().redMul(i),h=s.redAdd(a).fromRed(),p=s.redSub(a).fromRed();return[h,p]};Ui.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,s=this.n.clone(),a=new tr(1),h=new tr(0),p=new tr(0),m=new tr(1),v,_,I,N,O,q,j,K=0,J,Z;i.cmpn(0)!==0;){var de=s.div(i);J=s.sub(de.mul(i)),Z=p.sub(de.mul(a));var oe=m.sub(de.mul(h));if(!I&&J.cmp(t)<0)v=j.neg(),_=a,I=J.neg(),N=Z;else if(I&&++K===2)break;j=J,s=i,i=J,p=a,a=Z,m=h,h=oe}O=J.neg(),q=Z;var re=I.sqr().add(N.sqr()),fe=O.sqr().add(q.sqr());return fe.cmp(re)>=0&&(O=v,q=_),I.negative&&(I=I.neg(),N=N.neg()),O.negative&&(O=O.neg(),q=q.neg()),[{a:I,b:N},{a:O,b:q}]};Ui.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],s=t[1],a=s.b.mul(e).divRound(this.n),h=i.b.neg().mul(e).divRound(this.n),p=a.mul(i.a),m=h.mul(s.a),v=a.mul(i.b),_=h.mul(s.b),I=e.sub(p).sub(m),N=v.add(_).neg();return{k1:I,k2:N}};Ui.prototype.pointFromX=function(e,t){e=new tr(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),s=i.redSqrt();if(s.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var a=s.fromRed().isOdd();return(t&&!a||!t&&a)&&(s=s.redNeg()),this.point(e,s)};Ui.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,s=this.a.redMul(t),a=t.redSqr().redMul(t).redIAdd(s).redIAdd(this.b);return i.redSqr().redISub(a).cmpn(0)===0};Ui.prototype._endoWnafMulAdd=function(e,t,i){for(var s=this._endoWnafT1,a=this._endoWnafT2,h=0;h<e.length;h++){var p=this._endoSplit(t[h]),m=e[h],v=m._getBeta();p.k1.negative&&(p.k1.ineg(),m=m.neg(!0)),p.k2.negative&&(p.k2.ineg(),v=v.neg(!0)),s[h*2]=m,s[h*2+1]=v,a[h*2]=p.k1,a[h*2+1]=p.k2}for(var _=this._wnafMulAdd(1,s,a,h*2,i),I=0;I<h*2;I++)s[I]=null,a[I]=null;return _};function xr(r,e,t,i){Ga.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new tr(e,16),this.y=new tr(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}kd(xr,Ga.BasePoint);Ui.prototype.point=function(e,t,i){return new xr(this,e,t,i)};Ui.prototype.pointFromJSON=function(e,t){return xr.fromJSON(this,e,t)};xr.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,s=function(a){return i.point(a.x.redMul(i.endo.beta),a.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(s)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(s)}}}return t}};xr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};xr.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var s=e.point(t[0],t[1],i);if(!t[2])return s;function a(p){return e.point(p[0],p[1],i)}var h=t[2];return s.precomputed={beta:null,doubles:h.doubles&&{step:h.doubles.step,points:[s].concat(h.doubles.points.map(a))},naf:h.naf&&{wnd:h.naf.wnd,points:[s].concat(h.naf.points.map(a))}},s};xr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};xr.prototype.isInfinity=function(){return this.inf};xr.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),s=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)};xr.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),s=e.redInvm(),a=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(s),h=a.redSqr().redISub(this.x.redAdd(this.x)),p=a.redMul(this.x.redSub(h)).redISub(this.y);return this.curve.point(h,p)};xr.prototype.getX=function(){return this.x.fromRed()};xr.prototype.getY=function(){return this.y.fromRed()};xr.prototype.mul=function(e){return e=new tr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};xr.prototype.mulAdd=function(e,t,i){var s=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(s,a):this.curve._wnafMulAdd(1,s,a,2)};xr.prototype.jmulAdd=function(e,t,i){var s=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(s,a,!0):this.curve._wnafMulAdd(1,s,a,2,!0)};xr.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};xr.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,s=function(a){return a.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(s)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(s)}}}return t};xr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Sr(r,e,t,i){Ga.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new tr(0)):(this.x=new tr(e,16),this.y=new tr(t,16),this.z=new tr(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}kd(Sr,Ga.BasePoint);Ui.prototype.jpoint=function(e,t,i){return new Sr(this,e,t,i)};Sr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),s=this.y.redMul(t).redMul(e);return this.curve.point(i,s)};Sr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Sr.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),s=this.x.redMul(t),a=e.x.redMul(i),h=this.y.redMul(t.redMul(e.z)),p=e.y.redMul(i.redMul(this.z)),m=s.redSub(a),v=h.redSub(p);if(m.cmpn(0)===0)return v.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var _=m.redSqr(),I=_.redMul(m),N=s.redMul(_),O=v.redSqr().redIAdd(I).redISub(N).redISub(N),q=v.redMul(N.redISub(O)).redISub(h.redMul(I)),j=this.z.redMul(e.z).redMul(m);return this.curve.jpoint(O,q,j)};Sr.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,s=e.x.redMul(t),a=this.y,h=e.y.redMul(t).redMul(this.z),p=i.redSub(s),m=a.redSub(h);if(p.cmpn(0)===0)return m.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var v=p.redSqr(),_=v.redMul(p),I=i.redMul(v),N=m.redSqr().redIAdd(_).redISub(I).redISub(I),O=m.redMul(I.redISub(N)).redISub(a.redMul(_)),q=this.z.redMul(p);return this.curve.jpoint(N,O,q)};Sr.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var s=this.curve.a,a=this.curve.tinv,h=this.x,p=this.y,m=this.z,v=m.redSqr().redSqr(),_=p.redAdd(p);for(t=0;t<e;t++){var I=h.redSqr(),N=_.redSqr(),O=N.redSqr(),q=I.redAdd(I).redIAdd(I).redIAdd(s.redMul(v)),j=h.redMul(N),K=q.redSqr().redISub(j.redAdd(j)),J=j.redISub(K),Z=q.redMul(J);Z=Z.redIAdd(Z).redISub(O);var de=_.redMul(m);t+1<e&&(v=v.redMul(O)),h=K,m=de,_=Z}return this.curve.jpoint(h,_.redMul(a),m)};Sr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Sr.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var s=this.x.redSqr(),a=this.y.redSqr(),h=a.redSqr(),p=this.x.redAdd(a).redSqr().redISub(s).redISub(h);p=p.redIAdd(p);var m=s.redAdd(s).redIAdd(s),v=m.redSqr().redISub(p).redISub(p),_=h.redIAdd(h);_=_.redIAdd(_),_=_.redIAdd(_),e=v,t=m.redMul(p.redISub(v)).redISub(_),i=this.y.redAdd(this.y)}else{var I=this.x.redSqr(),N=this.y.redSqr(),O=N.redSqr(),q=this.x.redAdd(N).redSqr().redISub(I).redISub(O);q=q.redIAdd(q);var j=I.redAdd(I).redIAdd(I),K=j.redSqr(),J=O.redIAdd(O);J=J.redIAdd(J),J=J.redIAdd(J),e=K.redISub(q).redISub(q),t=j.redMul(q.redISub(e)).redISub(J),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};Sr.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var s=this.x.redSqr(),a=this.y.redSqr(),h=a.redSqr(),p=this.x.redAdd(a).redSqr().redISub(s).redISub(h);p=p.redIAdd(p);var m=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),v=m.redSqr().redISub(p).redISub(p);e=v;var _=h.redIAdd(h);_=_.redIAdd(_),_=_.redIAdd(_),t=m.redMul(p.redISub(v)).redISub(_),i=this.y.redAdd(this.y)}else{var I=this.z.redSqr(),N=this.y.redSqr(),O=this.x.redMul(N),q=this.x.redSub(I).redMul(this.x.redAdd(I));q=q.redAdd(q).redIAdd(q);var j=O.redIAdd(O);j=j.redIAdd(j);var K=j.redAdd(j);e=q.redSqr().redISub(K),i=this.y.redAdd(this.z).redSqr().redISub(N).redISub(I);var J=N.redSqr();J=J.redIAdd(J),J=J.redIAdd(J),J=J.redIAdd(J),t=q.redMul(j.redISub(e)).redISub(J)}return this.curve.jpoint(e,t,i)};Sr.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,s=this.z,a=s.redSqr().redSqr(),h=t.redSqr(),p=i.redSqr(),m=h.redAdd(h).redIAdd(h).redIAdd(e.redMul(a)),v=t.redAdd(t);v=v.redIAdd(v);var _=v.redMul(p),I=m.redSqr().redISub(_.redAdd(_)),N=_.redISub(I),O=p.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var q=m.redMul(N).redISub(O),j=i.redAdd(i).redMul(s);return this.curve.jpoint(I,q,j)};Sr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),s=t.redSqr(),a=e.redAdd(e).redIAdd(e),h=a.redSqr(),p=this.x.redAdd(t).redSqr().redISub(e).redISub(s);p=p.redIAdd(p),p=p.redAdd(p).redIAdd(p),p=p.redISub(h);var m=p.redSqr(),v=s.redIAdd(s);v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v);var _=a.redIAdd(p).redSqr().redISub(h).redISub(m).redISub(v),I=t.redMul(_);I=I.redIAdd(I),I=I.redIAdd(I);var N=this.x.redMul(m).redISub(I);N=N.redIAdd(N),N=N.redIAdd(N);var O=this.y.redMul(_.redMul(v.redISub(_)).redISub(p.redMul(m)));O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var q=this.z.redAdd(p).redSqr().redISub(i).redISub(m);return this.curve.jpoint(N,O,q)};Sr.prototype.mul=function(e,t){return e=new tr(e,t),this.curve._wnafMul(this,e)};Sr.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var s=t.redMul(this.z),a=i.redMul(e.z);return this.y.redMul(a).redISub(e.y.redMul(s)).cmpn(0)===0};Sr.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var s=e.clone(),a=this.curve.redN.redMul(t);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(a),this.x.cmp(i)===0)return!0}};Sr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Sr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var qa=hs,Bg=Xh,af=sf,B8=wi;function Ja(r){af.call(this,"mont",r),this.a=new qa(r.a,16).toRed(this.red),this.b=new qa(r.b,16).toRed(this.red),this.i4=new qa(4).toRed(this.red).redInvm(),this.two=new qa(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Bg(Ja,af);var $8=Ja;Ja.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),s=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),a=s.redSqrt();return a.redSqr().cmp(s)===0};function Ar(r,e,t){af.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new qa(e,16),this.z=new qa(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Bg(Ar,af.BasePoint);Ja.prototype.decodePoint=function(e,t){return this.point(B8.toArray(e,t),1)};Ja.prototype.point=function(e,t){return new Ar(this,e,t)};Ja.prototype.pointFromJSON=function(e){return Ar.fromJSON(this,e)};Ar.prototype.precompute=function(){};Ar.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Ar.fromJSON=function(e,t){return new Ar(e,t[0],t[1]||e.one)};Ar.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ar.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Ar.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),s=i.redSqr(),a=t.redSub(s),h=t.redMul(s),p=a.redMul(s.redAdd(this.curve.a24.redMul(a)));return this.curve.point(h,p)};Ar.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Ar.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),s=this.x.redSub(this.z),a=e.x.redAdd(e.z),h=e.x.redSub(e.z),p=h.redMul(i),m=a.redMul(s),v=t.z.redMul(p.redAdd(m).redSqr()),_=t.x.redMul(p.redISub(m).redSqr());return this.curve.point(v,_)};Ar.prototype.mul=function(e){for(var t=e.clone(),i=this,s=this.curve.point(null,null),a=this,h=[];t.cmpn(0)!==0;t.iushrn(1))h.push(t.andln(1));for(var p=h.length-1;p>=0;p--)h[p]===0?(i=i.diffAdd(s,a),s=s.dbl()):(s=i.diffAdd(s,a),i=i.dbl());return s};Ar.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Ar.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Ar.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Ar.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Ar.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var k8=wi,ns=hs,$g=Xh,of=sf,L8=k8.assert;function Ln(r){this.twisted=(r.a|0)!==1,this.mOneA=this.twisted&&(r.a|0)===-1,this.extended=this.mOneA,of.call(this,"edwards",r),this.a=new ns(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new ns(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new ns(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),L8(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)===1}$g(Ln,of);var z8=Ln;Ln.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Ln.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Ln.prototype.jpoint=function(e,t,i,s){return this.point(e,t,i,s)};Ln.prototype.pointFromX=function(e,t){e=new ns(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),s=this.c2.redSub(this.a.redMul(i)),a=this.one.redSub(this.c2.redMul(this.d).redMul(i)),h=s.redMul(a.redInvm()),p=h.redSqrt();if(p.redSqr().redSub(h).cmp(this.zero)!==0)throw new Error("invalid point");var m=p.fromRed().isOdd();return(t&&!m||!t&&m)&&(p=p.redNeg()),this.point(e,p)};Ln.prototype.pointFromY=function(e,t){e=new ns(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),s=i.redSub(this.c2),a=i.redMul(this.d).redMul(this.c2).redSub(this.a),h=s.redMul(a.redInvm());if(h.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var p=h.redSqrt();if(p.redSqr().redSub(h).cmp(this.zero)!==0)throw new Error("invalid point");return p.fromRed().isOdd()!==t&&(p=p.redNeg()),this.point(p,e)};Ln.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),s=t.redMul(this.a).redAdd(i),a=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return s.cmp(a)===0};function Ht(r,e,t,i,s){of.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new ns(e,16),this.y=new ns(t,16),this.z=i?new ns(i,16):this.curve.one,this.t=s&&new ns(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}$g(Ht,of.BasePoint);Ln.prototype.pointFromJSON=function(e){return Ht.fromJSON(this,e)};Ln.prototype.point=function(e,t,i,s){return new Ht(this,e,t,i,s)};Ht.fromJSON=function(e,t){return new Ht(e,t[0],t[1],t[2])};Ht.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ht.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Ht.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var s=this.curve._mulA(e),a=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),h=s.redAdd(t),p=h.redSub(i),m=s.redSub(t),v=a.redMul(p),_=h.redMul(m),I=a.redMul(m),N=p.redMul(h);return this.curve.point(v,_,N,I)};Ht.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),s,a,h,p,m,v;if(this.curve.twisted){p=this.curve._mulA(t);var _=p.redAdd(i);this.zOne?(s=e.redSub(t).redSub(i).redMul(_.redSub(this.curve.two)),a=_.redMul(p.redSub(i)),h=_.redSqr().redSub(_).redSub(_)):(m=this.z.redSqr(),v=_.redSub(m).redISub(m),s=e.redSub(t).redISub(i).redMul(v),a=_.redMul(p.redSub(i)),h=_.redMul(v))}else p=t.redAdd(i),m=this.curve._mulC(this.z).redSqr(),v=p.redSub(m).redSub(m),s=this.curve._mulC(e.redISub(p)).redMul(v),a=this.curve._mulC(p).redMul(t.redISub(i)),h=p.redMul(v);return this.curve.point(s,a,h)};Ht.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Ht.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),s=this.t.redMul(this.curve.dd).redMul(e.t),a=this.z.redMul(e.z.redAdd(e.z)),h=i.redSub(t),p=a.redSub(s),m=a.redAdd(s),v=i.redAdd(t),_=h.redMul(p),I=m.redMul(v),N=h.redMul(v),O=p.redMul(m);return this.curve.point(_,I,O,N)};Ht.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),s=this.x.redMul(e.x),a=this.y.redMul(e.y),h=this.curve.d.redMul(s).redMul(a),p=i.redSub(h),m=i.redAdd(h),v=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(a),_=t.redMul(p).redMul(v),I,N;return this.curve.twisted?(I=t.redMul(m).redMul(a.redSub(this.curve._mulA(s))),N=p.redMul(m)):(I=t.redMul(m).redMul(a.redSub(s)),N=this.curve._mulC(p).redMul(m)),this.curve.point(_,I,N)};Ht.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};Ht.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};Ht.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};Ht.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};Ht.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};Ht.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Ht.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Ht.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Ht.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};Ht.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(s),this.x.cmp(t)===0)return!0}};Ht.prototype.toP=Ht.prototype.normalize;Ht.prototype.mixedAdd=Ht.prototype.add;(function(r){var e=r;e.base=sf,e.short=D8,e.mont=$8,e.edwards=z8})($d);var cf={},hf={},Pt={},U8=oa,j8=Xh;Pt.inherits=j8;function F8(r,e){return(r.charCodeAt(e)&64512)!==55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)===56320}function K8(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),s=0;s<r.length;s+=2)t.push(parseInt(r[s]+r[s+1],16))}else for(var i=0,s=0;s<r.length;s++){var a=r.charCodeAt(s);a<128?t[i++]=a:a<2048?(t[i++]=a>>6|192,t[i++]=a&63|128):F8(r,s)?(a=65536+((a&1023)<<10)+(r.charCodeAt(++s)&1023),t[i++]=a>>18|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128,t[i++]=a&63|128):(t[i++]=a>>12|224,t[i++]=a>>6&63|128,t[i++]=a&63|128)}else for(s=0;s<r.length;s++)t[s]=r[s]|0;return t}Pt.toArray=K8;function H8(r){for(var e="",t=0;t<r.length;t++)e+=Lg(r[t].toString(16));return e}Pt.toHex=H8;function kg(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}Pt.htonl=kg;function V8(r,e){for(var t="",i=0;i<r.length;i++){var s=r[i];e==="little"&&(s=kg(s)),t+=zg(s.toString(16))}return t}Pt.toHex32=V8;function Lg(r){return r.length===1?"0"+r:r}Pt.zero2=Lg;function zg(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}Pt.zero8=zg;function G8(r,e,t,i){var s=t-e;U8(s%4===0);for(var a=new Array(s/4),h=0,p=e;h<a.length;h++,p+=4){var m;i==="big"?m=r[p]<<24|r[p+1]<<16|r[p+2]<<8|r[p+3]:m=r[p+3]<<24|r[p+2]<<16|r[p+1]<<8|r[p],a[h]=m>>>0}return a}Pt.join32=G8;function J8(r,e){for(var t=new Array(r.length*4),i=0,s=0;i<r.length;i++,s+=4){var a=r[i];e==="big"?(t[s]=a>>>24,t[s+1]=a>>>16&255,t[s+2]=a>>>8&255,t[s+3]=a&255):(t[s+3]=a>>>24,t[s+2]=a>>>16&255,t[s+1]=a>>>8&255,t[s]=a&255)}return t}Pt.split32=J8;function W8(r,e){return r>>>e|r<<32-e}Pt.rotr32=W8;function Q8(r,e){return r<<e|r>>>32-e}Pt.rotl32=Q8;function Y8(r,e){return r+e>>>0}Pt.sum32=Y8;function X8(r,e,t){return r+e+t>>>0}Pt.sum32_3=X8;function Z8(r,e,t,i){return r+e+t+i>>>0}Pt.sum32_4=Z8;function e7(r,e,t,i,s){return r+e+t+i+s>>>0}Pt.sum32_5=e7;function t7(r,e,t,i){var s=r[e],a=r[e+1],h=i+a>>>0,p=(h<i?1:0)+t+s;r[e]=p>>>0,r[e+1]=h}Pt.sum64=t7;function r7(r,e,t,i){var s=e+i>>>0,a=(s<e?1:0)+r+t;return a>>>0}Pt.sum64_hi=r7;function i7(r,e,t,i){var s=e+i;return s>>>0}Pt.sum64_lo=i7;function n7(r,e,t,i,s,a,h,p){var m=0,v=e;v=v+i>>>0,m+=v<e?1:0,v=v+a>>>0,m+=v<a?1:0,v=v+p>>>0,m+=v<p?1:0;var _=r+t+s+h+m;return _>>>0}Pt.sum64_4_hi=n7;function s7(r,e,t,i,s,a,h,p){var m=e+i+a+p;return m>>>0}Pt.sum64_4_lo=s7;function a7(r,e,t,i,s,a,h,p,m,v){var _=0,I=e;I=I+i>>>0,_+=I<e?1:0,I=I+a>>>0,_+=I<a?1:0,I=I+p>>>0,_+=I<p?1:0,I=I+v>>>0,_+=I<v?1:0;var N=r+t+s+h+m+_;return N>>>0}Pt.sum64_5_hi=a7;function o7(r,e,t,i,s,a,h,p,m,v){var _=e+i+a+p+v;return _>>>0}Pt.sum64_5_lo=o7;function c7(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}Pt.rotr64_hi=c7;function h7(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Pt.rotr64_lo=h7;function f7(r,e,t){return r>>>t}Pt.shr64_hi=f7;function u7(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Pt.shr64_lo=u7;var Wa={},Pp=Pt,d7=oa;function ff(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Wa.BlockHash=ff;ff.prototype.update=function(e,t){if(e=Pp.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Pp.join32(e,0,e.length-i,this.endian);for(var s=0;s<e.length;s+=this._delta32)this._update(e,s,s+this._delta32)}return this};ff.prototype.digest=function(e){return this.update(this._pad()),d7(this.pending===null),this._digest(e)};ff.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,s=new Array(i+this.padLength);s[0]=128;for(var a=1;a<i;a++)s[a]=0;if(e<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)s[a++]=0;s[a++]=0,s[a++]=0,s[a++]=0,s[a++]=0,s[a++]=e>>>24&255,s[a++]=e>>>16&255,s[a++]=e>>>8&255,s[a++]=e&255}else for(s[a++]=e&255,s[a++]=e>>>8&255,s[a++]=e>>>16&255,s[a++]=e>>>24&255,s[a++]=0,s[a++]=0,s[a++]=0,s[a++]=0,h=8;h<this.padLength;h++)s[a++]=0;return s};var Qa={},zn={},l7=Pt,Mn=l7.rotr32;function p7(r,e,t,i){if(r===0)return Ug(e,t,i);if(r===1||r===3)return Fg(e,t,i);if(r===2)return jg(e,t,i)}zn.ft_1=p7;function Ug(r,e,t){return r&e^~r&t}zn.ch32=Ug;function jg(r,e,t){return r&e^r&t^e&t}zn.maj32=jg;function Fg(r,e,t){return r^e^t}zn.p32=Fg;function g7(r){return Mn(r,2)^Mn(r,13)^Mn(r,22)}zn.s0_256=g7;function v7(r){return Mn(r,6)^Mn(r,11)^Mn(r,25)}zn.s1_256=v7;function b7(r){return Mn(r,7)^Mn(r,18)^r>>>3}zn.g0_256=b7;function m7(r){return Mn(r,17)^Mn(r,19)^r>>>10}zn.g1_256=m7;var La=Pt,y7=Wa,w7=zn,Cu=La.rotl32,So=La.sum32,_7=La.sum32_5,A7=w7.ft_1,Kg=y7.BlockHash,x7=[1518500249,1859775393,2400959708,3395469782];function Tn(){if(!(this instanceof Tn))return new Tn;Kg.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}La.inherits(Tn,Kg);var I7=Tn;Tn.blockSize=512;Tn.outSize=160;Tn.hmacStrength=80;Tn.padLength=64;Tn.prototype._update=function(e,t){for(var i=this.W,s=0;s<16;s++)i[s]=e[t+s];for(;s<i.length;s++)i[s]=Cu(i[s-3]^i[s-8]^i[s-14]^i[s-16],1);var a=this.h[0],h=this.h[1],p=this.h[2],m=this.h[3],v=this.h[4];for(s=0;s<i.length;s++){var _=~~(s/20),I=_7(Cu(a,5),A7(_,h,p,m),v,i[s],x7[_]);v=m,m=p,p=Cu(h,30),h=a,a=I}this.h[0]=So(this.h[0],a),this.h[1]=So(this.h[1],h),this.h[2]=So(this.h[2],p),this.h[3]=So(this.h[3],m),this.h[4]=So(this.h[4],v)};Tn.prototype._digest=function(e){return e==="hex"?La.toHex32(this.h,"big"):La.split32(this.h,"big")};var za=Pt,E7=Wa,Ya=zn,M7=oa,Zi=za.sum32,S7=za.sum32_4,P7=za.sum32_5,R7=Ya.ch32,N7=Ya.maj32,C7=Ya.s0_256,O7=Ya.s1_256,T7=Ya.g0_256,q7=Ya.g1_256,Hg=E7.BlockHash,D7=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function qn(){if(!(this instanceof qn))return new qn;Hg.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=D7,this.W=new Array(64)}za.inherits(qn,Hg);var Vg=qn;qn.blockSize=512;qn.outSize=256;qn.hmacStrength=192;qn.padLength=64;qn.prototype._update=function(e,t){for(var i=this.W,s=0;s<16;s++)i[s]=e[t+s];for(;s<i.length;s++)i[s]=S7(q7(i[s-2]),i[s-7],T7(i[s-15]),i[s-16]);var a=this.h[0],h=this.h[1],p=this.h[2],m=this.h[3],v=this.h[4],_=this.h[5],I=this.h[6],N=this.h[7];for(M7(this.k.length===i.length),s=0;s<i.length;s++){var O=P7(N,O7(v),R7(v,_,I),this.k[s],i[s]),q=Zi(C7(a),N7(a,h,p));N=I,I=_,_=v,v=Zi(m,O),m=p,p=h,h=a,a=Zi(O,q)}this.h[0]=Zi(this.h[0],a),this.h[1]=Zi(this.h[1],h),this.h[2]=Zi(this.h[2],p),this.h[3]=Zi(this.h[3],m),this.h[4]=Zi(this.h[4],v),this.h[5]=Zi(this.h[5],_),this.h[6]=Zi(this.h[6],I),this.h[7]=Zi(this.h[7],N)};qn.prototype._digest=function(e){return e==="hex"?za.toHex32(this.h,"big"):za.split32(this.h,"big")};var dd=Pt,Gg=Vg;function os(){if(!(this instanceof os))return new os;Gg.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}dd.inherits(os,Gg);var B7=os;os.blockSize=512;os.outSize=224;os.hmacStrength=192;os.padLength=64;os.prototype._digest=function(e){return e==="hex"?dd.toHex32(this.h.slice(0,7),"big"):dd.split32(this.h.slice(0,7),"big")};var oi=Pt,$7=Wa,k7=oa,Sn=oi.rotr64_hi,Pn=oi.rotr64_lo,Jg=oi.shr64_hi,Wg=oi.shr64_lo,ws=oi.sum64,Ou=oi.sum64_hi,Tu=oi.sum64_lo,L7=oi.sum64_4_hi,z7=oi.sum64_4_lo,U7=oi.sum64_5_hi,j7=oi.sum64_5_lo,Qg=$7.BlockHash,F7=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function hn(){if(!(this instanceof hn))return new hn;Qg.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=F7,this.W=new Array(160)}oi.inherits(hn,Qg);var Yg=hn;hn.blockSize=1024;hn.outSize=512;hn.hmacStrength=192;hn.padLength=128;hn.prototype._prepareBlock=function(e,t){for(var i=this.W,s=0;s<32;s++)i[s]=e[t+s];for(;s<i.length;s+=2){var a=e9(i[s-4],i[s-3]),h=t9(i[s-4],i[s-3]),p=i[s-14],m=i[s-13],v=X7(i[s-30],i[s-29]),_=Z7(i[s-30],i[s-29]),I=i[s-32],N=i[s-31];i[s]=L7(a,h,p,m,v,_,I,N),i[s+1]=z7(a,h,p,m,v,_,I,N)}};hn.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,s=this.h[0],a=this.h[1],h=this.h[2],p=this.h[3],m=this.h[4],v=this.h[5],_=this.h[6],I=this.h[7],N=this.h[8],O=this.h[9],q=this.h[10],j=this.h[11],K=this.h[12],J=this.h[13],Z=this.h[14],de=this.h[15];k7(this.k.length===i.length);for(var oe=0;oe<i.length;oe+=2){var re=Z,fe=de,ue=Q7(N,O),le=Y7(N,O),Ae=K7(N,O,q,j,K),ht=H7(N,O,q,j,K,J),k=this.k[oe],b=this.k[oe+1],c=i[oe],d=i[oe+1],g=U7(re,fe,ue,le,Ae,ht,k,b,c,d),A=j7(re,fe,ue,le,Ae,ht,k,b,c,d);re=J7(s,a),fe=W7(s,a),ue=V7(s,a,h,p,m),le=G7(s,a,h,p,m,v);var M=Ou(re,fe,ue,le),S=Tu(re,fe,ue,le);Z=K,de=J,K=q,J=j,q=N,j=O,N=Ou(_,I,g,A),O=Tu(I,I,g,A),_=m,I=v,m=h,v=p,h=s,p=a,s=Ou(g,A,M,S),a=Tu(g,A,M,S)}ws(this.h,0,s,a),ws(this.h,2,h,p),ws(this.h,4,m,v),ws(this.h,6,_,I),ws(this.h,8,N,O),ws(this.h,10,q,j),ws(this.h,12,K,J),ws(this.h,14,Z,de)};hn.prototype._digest=function(e){return e==="hex"?oi.toHex32(this.h,"big"):oi.split32(this.h,"big")};function K7(r,e,t,i,s){var a=r&t^~r&s;return a<0&&(a+=4294967296),a}function H7(r,e,t,i,s,a){var h=e&i^~e&a;return h<0&&(h+=4294967296),h}function V7(r,e,t,i,s){var a=r&t^r&s^t&s;return a<0&&(a+=4294967296),a}function G7(r,e,t,i,s,a){var h=e&i^e&a^i&a;return h<0&&(h+=4294967296),h}function J7(r,e){var t=Sn(r,e,28),i=Sn(e,r,2),s=Sn(e,r,7),a=t^i^s;return a<0&&(a+=4294967296),a}function W7(r,e){var t=Pn(r,e,28),i=Pn(e,r,2),s=Pn(e,r,7),a=t^i^s;return a<0&&(a+=4294967296),a}function Q7(r,e){var t=Sn(r,e,14),i=Sn(r,e,18),s=Sn(e,r,9),a=t^i^s;return a<0&&(a+=4294967296),a}function Y7(r,e){var t=Pn(r,e,14),i=Pn(r,e,18),s=Pn(e,r,9),a=t^i^s;return a<0&&(a+=4294967296),a}function X7(r,e){var t=Sn(r,e,1),i=Sn(r,e,8),s=Jg(r,e,7),a=t^i^s;return a<0&&(a+=4294967296),a}function Z7(r,e){var t=Pn(r,e,1),i=Pn(r,e,8),s=Wg(r,e,7),a=t^i^s;return a<0&&(a+=4294967296),a}function e9(r,e){var t=Sn(r,e,19),i=Sn(e,r,29),s=Jg(r,e,6),a=t^i^s;return a<0&&(a+=4294967296),a}function t9(r,e){var t=Pn(r,e,19),i=Pn(e,r,29),s=Wg(r,e,6),a=t^i^s;return a<0&&(a+=4294967296),a}var ld=Pt,Xg=Yg;function cs(){if(!(this instanceof cs))return new cs;Xg.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}ld.inherits(cs,Xg);var r9=cs;cs.blockSize=1024;cs.outSize=384;cs.hmacStrength=192;cs.padLength=128;cs.prototype._digest=function(e){return e==="hex"?ld.toHex32(this.h.slice(0,12),"big"):ld.split32(this.h.slice(0,12),"big")};Qa.sha1=I7;Qa.sha224=B7;Qa.sha256=Vg;Qa.sha384=r9;Qa.sha512=Yg;var Zg={},ra=Pt,i9=Wa,gh=ra.rotl32,Rp=ra.sum32,Po=ra.sum32_3,Np=ra.sum32_4,ev=i9.BlockHash;function Dn(){if(!(this instanceof Dn))return new Dn;ev.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}ra.inherits(Dn,ev);Zg.ripemd160=Dn;Dn.blockSize=512;Dn.outSize=160;Dn.hmacStrength=192;Dn.padLength=64;Dn.prototype._update=function(e,t){for(var i=this.h[0],s=this.h[1],a=this.h[2],h=this.h[3],p=this.h[4],m=i,v=s,_=a,I=h,N=p,O=0;O<80;O++){var q=Rp(gh(Np(i,Cp(O,s,a,h),e[a9[O]+t],n9(O)),c9[O]),p);i=p,p=h,h=gh(a,10),a=s,s=q,q=Rp(gh(Np(m,Cp(79-O,v,_,I),e[o9[O]+t],s9(O)),h9[O]),N),m=N,N=I,I=gh(_,10),_=v,v=q}q=Po(this.h[1],a,I),this.h[1]=Po(this.h[2],h,N),this.h[2]=Po(this.h[3],p,m),this.h[3]=Po(this.h[4],i,v),this.h[4]=Po(this.h[0],s,_),this.h[0]=q};Dn.prototype._digest=function(e){return e==="hex"?ra.toHex32(this.h,"little"):ra.split32(this.h,"little")};function Cp(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function n9(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function s9(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var a9=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],o9=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c9=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h9=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],f9=Pt,u9=oa;function Ua(r,e,t){if(!(this instanceof Ua))return new Ua(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(f9.toArray(e,t))}var d9=Ua;Ua.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),u9(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};Ua.prototype.update=function(e,t){return this.inner.update(e,t),this};Ua.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(r){var e=r;e.utils=Pt,e.common=Wa,e.sha=Qa,e.ripemd=Zg,e.hmac=d9,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(hf);var qu,Op;function l9(){return Op||(Op=1,qu={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),qu}(function(r){var e=r,t=hf,i=$d,s=wi,a=s.assert;function h(v){v.type==="short"?this.curve=new i.short(v):v.type==="edwards"?this.curve=new i.edwards(v):this.curve=new i.mont(v),this.g=this.curve.g,this.n=this.curve.n,this.hash=v.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=h;function p(v,_){Object.defineProperty(e,v,{configurable:!0,enumerable:!0,get:function(){var I=new h(_);return Object.defineProperty(e,v,{configurable:!0,enumerable:!0,value:I}),I}})}p("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:t.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),p("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:t.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),p("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:t.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),p("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:t.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),p("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:t.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),p("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["9"]}),p("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var m;try{m=l9()}catch{m=void 0}p("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:t.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",m]})})(cf);var p9=hf,Xs=Dd,tv=oa;function Rs(r){if(!(this instanceof Rs))return new Rs(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Xs.toArray(r.entropy,r.entropyEnc||"hex"),t=Xs.toArray(r.nonce,r.nonceEnc||"hex"),i=Xs.toArray(r.pers,r.persEnc||"hex");tv(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var g9=Rs;Rs.prototype._init=function(e,t,i){var s=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656};Rs.prototype._hmac=function(){return new p9.hmac(this.hash,this.K)};Rs.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Rs.prototype.reseed=function(e,t,i,s){typeof t!="string"&&(s=i,i=t,t=null),e=Xs.toArray(e,t),i=Xs.toArray(i,s),tv(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};Rs.prototype.generate=function(e,t,i,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(s=i,i=t,t=null),i&&(i=Xs.toArray(i,s||"hex"),this._update(i));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var h=a.slice(0,e);return this._update(i),this._reseed++,Xs.encode(h,t)};var v9=hs,b9=wi,pd=b9.assert;function $r(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var m9=$r;$r.fromPublic=function(e,t,i){return t instanceof $r?t:new $r(e,{pub:t,pubEnc:i})};$r.fromPrivate=function(e,t,i){return t instanceof $r?t:new $r(e,{priv:t,privEnc:i})};$r.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};$r.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};$r.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};$r.prototype._importPrivate=function(e,t){this.priv=new v9(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};$r.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?pd(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&pd(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};$r.prototype.derive=function(e){return e.validate()||pd(e.validate(),"public point not validated"),e.mul(this.priv).getX()};$r.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};$r.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};$r.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Fh=hs,Ld=wi,y9=Ld.assert;function uf(r,e){if(r instanceof uf)return r;this._importDER(r,e)||(y9(r.r&&r.s,"Signature without r or s"),this.r=new Fh(r.r,16),this.s=new Fh(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var w9=uf;function _9(){this.place=0}function Du(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4||r[e.place]===0)return!1;for(var s=0,a=0,h=e.place;a<i;a++,h++)s<<=8,s|=r[h],s>>>=0;return s<=127?!1:(e.place=h,s)}function Tp(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}uf.prototype._importDER=function(e,t){e=Ld.toArray(e,t);var i=new _9;if(e[i.place++]!==48)return!1;var s=Du(e,i);if(s===!1||s+i.place!==e.length||e[i.place++]!==2)return!1;var a=Du(e,i);if(a===!1||e[i.place]&128)return!1;var h=e.slice(i.place,a+i.place);if(i.place+=a,e[i.place++]!==2)return!1;var p=Du(e,i);if(p===!1||e.length!==p+i.place||e[i.place]&128)return!1;var m=e.slice(i.place,p+i.place);if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;if(m[0]===0)if(m[1]&128)m=m.slice(1);else return!1;return this.r=new Fh(h),this.s=new Fh(m),this.recoveryParam=null,!0};function Bu(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}uf.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=Tp(t),i=Tp(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var s=[2];Bu(s,t.length),s=s.concat(t),s.push(2),Bu(s,i.length);var a=s.concat(i),h=[48];return Bu(h,a.length),h=h.concat(a),Ld.encode(h,e)};var Zs=hs,rv=g9,A9=wi,$u=cf,x9=Dg,iv=A9.assert,zd=m9,df=w9;function ki(r){if(!(this instanceof ki))return new ki(r);typeof r=="string"&&(iv(Object.prototype.hasOwnProperty.call($u,r),"Unknown curve "+r),r=$u[r]),r instanceof $u.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var I9=ki;ki.prototype.keyPair=function(e){return new zd(this,e)};ki.prototype.keyFromPrivate=function(e,t){return zd.fromPrivate(this,e,t)};ki.prototype.keyFromPublic=function(e,t){return zd.fromPublic(this,e,t)};ki.prototype.genKeyPair=function(e){e||(e={});for(var t=new rv({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||x9(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),s=this.n.sub(new Zs(2));;){var a=new Zs(t.generate(i));if(!(a.cmp(s)>0))return a.iaddn(1),this.keyFromPrivate(a)}};ki.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};ki.prototype.sign=function(e,t,i,s){typeof i=="object"&&(s=i,i=null),s||(s={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new Zs(e,16));for(var a=this.n.byteLength(),h=t.getPrivate().toArray("be",a),p=e.toArray("be",a),m=new rv({hash:this.hash,entropy:h,nonce:p,pers:s.pers,persEnc:s.persEnc||"utf8"}),v=this.n.sub(new Zs(1)),_=0;;_++){var I=s.k?s.k(_):new Zs(m.generate(this.n.byteLength()));if(I=this._truncateToN(I,!0),!(I.cmpn(1)<=0||I.cmp(v)>=0)){var N=this.g.mul(I);if(!N.isInfinity()){var O=N.getX(),q=O.umod(this.n);if(q.cmpn(0)!==0){var j=I.invm(this.n).mul(q.mul(t.getPrivate()).iadd(e));if(j=j.umod(this.n),j.cmpn(0)!==0){var K=(N.getY().isOdd()?1:0)|(O.cmp(q)!==0?2:0);return s.canonical&&j.cmp(this.nh)>0&&(j=this.n.sub(j),K^=1),new df({r:q,s:j,recoveryParam:K})}}}}}};ki.prototype.verify=function(e,t,i,s){e=this._truncateToN(new Zs(e,16)),i=this.keyFromPublic(i,s),t=new df(t,"hex");var a=t.r,h=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||h.cmpn(1)<0||h.cmp(this.n)>=0)return!1;var p=h.invm(this.n),m=p.mul(e).umod(this.n),v=p.mul(a).umod(this.n),_;return this.curve._maxwellTrick?(_=this.g.jmulAdd(m,i.getPublic(),v),_.isInfinity()?!1:_.eqXToP(a)):(_=this.g.mulAdd(m,i.getPublic(),v),_.isInfinity()?!1:_.getX().umod(this.n).cmp(a)===0)};ki.prototype.recoverPubKey=function(r,e,t,i){iv((3&t)===t,"The recovery param is more than two bits"),e=new df(e,i);var s=this.n,a=new Zs(r),h=e.r,p=e.s,m=t&1,v=t>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&v)throw new Error("Unable to find sencond key candinate");v?h=this.curve.pointFromX(h.add(this.curve.n),m):h=this.curve.pointFromX(h,m);var _=e.r.invm(s),I=s.sub(a).mul(_).umod(s),N=p.mul(_).umod(s);return this.g.mulAdd(I,h,N)};ki.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new df(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var s=0;s<4;s++){var a;try{a=this.recoverPubKey(r,e,s)}catch{continue}if(a.eq(t))return s}throw new Error("Unable to find valid recovery factor")};var nc=wi,nv=nc.assert,qp=nc.parseBytes,Xa=nc.cachedProperty;function _r(r,e){this.eddsa=r,this._secret=qp(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=qp(e.pub)}_r.fromPublic=function(e,t){return t instanceof _r?t:new _r(e,{pub:t})};_r.fromSecret=function(e,t){return t instanceof _r?t:new _r(e,{secret:t})};_r.prototype.secret=function(){return this._secret};Xa(_r,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Xa(_r,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Xa(_r,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,s=t.slice(0,e.encodingLength);return s[0]&=248,s[i]&=127,s[i]|=64,s});Xa(_r,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Xa(_r,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Xa(_r,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});_r.prototype.sign=function(e){return nv(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};_r.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};_r.prototype.getSecret=function(e){return nv(this._secret,"KeyPair is public only"),nc.encode(this.secret(),e)};_r.prototype.getPublic=function(e){return nc.encode(this.pubBytes(),e)};var E9=_r,M9=hs,lf=wi,Dp=lf.assert,pf=lf.cachedProperty,S9=lf.parseBytes;function ca(r,e){this.eddsa=r,typeof e!="object"&&(e=S9(e)),Array.isArray(e)&&(Dp(e.length===r.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),Dp(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof M9&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}pf(ca,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});pf(ca,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});pf(ca,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});pf(ca,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});ca.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};ca.prototype.toHex=function(){return lf.encode(this.toBytes(),"hex").toUpperCase()};var P9=ca,R9=hf,N9=cf,ja=wi,C9=ja.assert,sv=ja.parseBytes,av=E9,Bp=P9;function ci(r){if(C9(r==="ed25519","only tested with ed25519 so far"),!(this instanceof ci))return new ci(r);r=N9[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=R9.sha512}var O9=ci;ci.prototype.sign=function(e,t){e=sv(e);var i=this.keyFromSecret(t),s=this.hashInt(i.messagePrefix(),e),a=this.g.mul(s),h=this.encodePoint(a),p=this.hashInt(h,i.pubBytes(),e).mul(i.priv()),m=s.add(p).umod(this.curve.n);return this.makeSignature({R:a,S:m,Rencoded:h})};ci.prototype.verify=function(e,t,i){if(e=sv(e),t=this.makeSignature(t),t.S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var s=this.keyFromPublic(i),a=this.hashInt(t.Rencoded(),s.pubBytes(),e),h=this.g.mul(t.S()),p=t.R().add(s.pub().mul(a));return p.eq(h)};ci.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return ja.intFromLE(e.digest()).umod(this.curve.n)};ci.prototype.keyFromPublic=function(e){return av.fromPublic(this,e)};ci.prototype.keyFromSecret=function(e){return av.fromSecret(this,e)};ci.prototype.makeSignature=function(e){return e instanceof Bp?e:new Bp(this,e)};ci.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};ci.prototype.decodePoint=function(e){e=ja.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&-129),s=(e[t]&128)!==0,a=ja.intFromLE(i);return this.curve.pointFromY(a,s)};ci.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};ci.prototype.decodeInt=function(e){return ja.intFromLE(e)};ci.prototype.isPoint=function(e){return e instanceof this.pointClass};(function(r){var e=r;e.version=C8.version,e.utils=wi,e.rand=Dg,e.curve=$d,e.curves=cf,e.ec=I9,e.eddsa=O9})(Tg);const T9={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},q9=":";function Ko(r){const[e,t]=r.split(q9);return{namespace:e,reference:t}}function $p(r,e=[]){const t=[];return Object.keys(r).forEach(i=>{if(e.length&&!e.includes(i))return;const s=r[i];t.push(...s.accounts)}),t}function ov(r,e){return r.includes(":")?[r]:e.chains||[]}var D9=Object.defineProperty,kp=Object.getOwnPropertySymbols,B9=Object.prototype.hasOwnProperty,$9=Object.prototype.propertyIsEnumerable,Lp=(r,e,t)=>e in r?D9(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zp=(r,e)=>{for(var t in e||(e={}))B9.call(e,t)&&Lp(r,t,e[t]);if(kp)for(var t of kp(e))$9.call(e,t)&&Lp(r,t,e[t]);return r};const k9="ReactNative",bi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},L9="js";function Wo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Za(){return!Rd()&&!!lg()&&navigator.product===k9}function sc(){return!Wo()&&!!lg()&&!!Rd()}function ac(){return Za()?bi.reactNative:Wo()?bi.node:sc()?bi.browser:bi.unknown}function z9(){var r;try{return Za()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function U9(r,e){let t=Dh.parse(r);return t=zp(zp({},t),e),r=Dh.stringify(t),r}function j9(){return mw()||{name:"",description:"",url:"",icons:[""]}}function F9(){if(ac()===bi.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:i}=global.Platform;return[t,i].join("-")}const r=Rw();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function K9(){var r;const e=ac();return e===bi.browser?[e,((r=ww())==null?void 0:r.host)||"unknown"].join(":"):e}function H9(r,e,t){const i=F9(),s=K9();return[[r,e].join("-"),[L9,t].join("-"),i,s].join("/")}function V9({protocol:r,version:e,relayUrl:t,sdkVersion:i,auth:s,projectId:a,useOnCloseEvent:h,bundleId:p}){const m=t.split("?"),v=H9(r,e,i),_={auth:s,ua:v,projectId:a,useOnCloseEvent:h||void 0,origin:p||void 0},I=U9(m[1]||"",_);return m[0]+"?"+I}function Ys(r,e){return r.filter(t=>e.includes(t)).length===r.length}function cv(r){return Object.fromEntries(r.entries())}function hv(r){return new Map(Object.entries(r))}function Js(r=be.FIVE_MINUTES,e){const t=be.toMiliseconds(r||be.FIVE_MINUTES);let i,s,a;return{resolve:h=>{a&&i&&(clearTimeout(a),i(h))},reject:h=>{a&&s&&(clearTimeout(a),s(h))},done:()=>new Promise((h,p)=>{a=setTimeout(()=>{p(new Error(e))},t),i=h,s=p})}}function Ba(r,e,t){return new Promise(async(i,s)=>{const a=setTimeout(()=>s(new Error(t)),e);try{const h=await r;i(h)}catch(h){s(h)}clearTimeout(a)})}function fv(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function G9(r){return fv("topic",r)}function J9(r){return fv("id",r)}function uv(r){const[e,t]=r.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function lr(r,e){return be.fromMiliseconds(Date.now()+be.toMiliseconds(r))}function xs(r){return Date.now()>=be.toMiliseconds(r)}function It(r,e){return`${r}${e?`:${e}`:""}`}function Ph(r=[],e=[]){return[...new Set([...r,...e])]}async function W9({id:r,topic:e,wcDeepLink:t}){var i;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${r}&sessionTopic=${e}`,p=ac();if(p===bi.browser){if(!((i=Rd())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}h.startsWith("https://")||h.startsWith("http://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener")}else p===bi.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(s){console.error(s)}}async function Q9(r,e){try{return await r.getItem(e)||(sc()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}function Up(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),i=t.indexOf(e);return t[i+2]}function Y9(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}var dv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function X9(r){var e=r.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),t}var lv={exports:{}};/**
* [js-sha3]{@link https://github.com/emn178/js-sha3}
*
* @version 0.8.0
* @author Chen, Yi-Cyuan [emn178@gmail.com]
* @copyright Chen, Yi-Cyuan 2015-2018
* @license MIT
*/(function(r){(function(){var e="input is invalid type",t="finalize already called",i=typeof window=="object",s=i?window:{};s.JS_SHA3_NO_WINDOW&&(i=!1);var a=!i&&typeof self=="object",h=!s.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;h?s=dv:a&&(s=self);var p=!s.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,m=!s.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",v="0123456789abcdef".split(""),_=[31,7936,2031616,520093696],I=[4,1024,262144,67108864],N=[1,256,65536,16777216],O=[6,1536,393216,100663296],q=[0,8,16,24],j=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],K=[224,256,384,512],J=[128,256],Z=["hex","buffer","arrayBuffer","array","digest"],de={128:168,256:136};(s.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(E){return Object.prototype.toString.call(E)==="[object Array]"}),m&&(s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(E){return typeof E=="object"&&E.buffer&&E.buffer.constructor===ArrayBuffer});for(var oe=function(E,W,D){return function(L){return new R(E,W,E).update(L)[D]()}},re=function(E,W,D){return function(L,z){return new R(E,W,z).update(L)[D]()}},fe=function(E,W,D){return function(L,z,y,$){return d["cshake"+E].update(L,z,y,$)[D]()}},ue=function(E,W,D){return function(L,z,y,$){return d["kmac"+E].update(L,z,y,$)[D]()}},le=function(E,W,D,L){for(var z=0;z<Z.length;++z){var y=Z[z];E[y]=W(D,L,y)}return E},Ae=function(E,W){var D=oe(E,W,"hex");return D.create=function(){return new R(E,W,E)},D.update=function(L){return D.create().update(L)},le(D,oe,E,W)},ht=function(E,W){var D=re(E,W,"hex");return D.create=function(L){return new R(E,W,L)},D.update=function(L,z){return D.create(z).update(L)},le(D,re,E,W)},k=function(E,W){var D=de[E],L=fe(E,W,"hex");return L.create=function(z,y,$){return!y&&!$?d["shake"+E].create(z):new R(E,W,z).bytepad([y,$],D)},L.update=function(z,y,$,Y){return L.create(y,$,Y).update(z)},le(L,fe,E,W)},b=function(E,W){var D=de[E],L=ue(E,W,"hex");return L.create=function(z,y,$){return new X(E,W,y).bytepad(["KMAC",$],D).bytepad([z],D)},L.update=function(z,y,$,Y){return L.create(z,$,Y).update(y)},le(L,ue,E,W)},c=[{name:"keccak",padding:N,bits:K,createMethod:Ae},{name:"sha3",padding:O,bits:K,createMethod:Ae},{name:"shake",padding:_,bits:J,createMethod:ht},{name:"cshake",padding:I,bits:J,createMethod:k},{name:"kmac",padding:I,bits:J,createMethod:b}],d={},g=[],A=0;A<c.length;++A)for(var M=c[A],S=M.bits,x=0;x<S.length;++x){var u=M.name+"_"+S[x];if(g.push(u),d[u]=M.createMethod(S[x],M.padding),M.name!=="sha3"){var l=M.name+S[x];g.push(l),d[l]=d[u]}}function R(E,W,D){this.blocks=[],this.s=[],this.padding=W,this.outputBits=D,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(E<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=D>>5,this.extraBytes=(D&31)>>3;for(var L=0;L<50;++L)this.s[L]=0}R.prototype.update=function(E){if(this.finalized)throw new Error(t);var W,D=typeof E;if(D!=="string"){if(D==="object"){if(E===null)throw new Error(e);if(m&&E.constructor===ArrayBuffer)E=new Uint8Array(E);else if(!Array.isArray(E)&&(!m||!ArrayBuffer.isView(E)))throw new Error(e)}else throw new Error(e);W=!0}for(var L=this.blocks,z=this.byteCount,y=E.length,$=this.blockCount,Y=0,se=this.s,ae,ge;Y<y;){if(this.reset)for(this.reset=!1,L[0]=this.block,ae=1;ae<$+1;++ae)L[ae]=0;if(W)for(ae=this.start;Y<y&&ae<z;++Y)L[ae>>2]|=E[Y]<<q[ae++&3];else for(ae=this.start;Y<y&&ae<z;++Y)ge=E.charCodeAt(Y),ge<128?L[ae>>2]|=ge<<q[ae++&3]:ge<2048?(L[ae>>2]|=(192|ge>>6)<<q[ae++&3],L[ae>>2]|=(128|ge&63)<<q[ae++&3]):ge<55296||ge>=57344?(L[ae>>2]|=(224|ge>>12)<<q[ae++&3],L[ae>>2]|=(128|ge>>6&63)<<q[ae++&3],L[ae>>2]|=(128|ge&63)<<q[ae++&3]):(ge=65536+((ge&1023)<<10|E.charCodeAt(++Y)&1023),L[ae>>2]|=(240|ge>>18)<<q[ae++&3],L[ae>>2]|=(128|ge>>12&63)<<q[ae++&3],L[ae>>2]|=(128|ge>>6&63)<<q[ae++&3],L[ae>>2]|=(128|ge&63)<<q[ae++&3]);if(this.lastByteIndex=ae,ae>=z){for(this.start=ae-z,this.block=L[$],ae=0;ae<$;++ae)se[ae]^=L[ae];ee(se),this.reset=!0}else this.start=ae}return this},R.prototype.encode=function(E,W){var D=E&255,L=1,z=[D];for(E=E>>8,D=E&255;D>0;)z.unshift(D),E=E>>8,D=E&255,++L;return W?z.push(L):z.unshift(L),this.update(z),z.length},R.prototype.encodeString=function(E){var W,D=typeof E;if(D!=="string"){if(D==="object"){if(E===null)throw new Error(e);if(m&&E.constructor===ArrayBuffer)E=new Uint8Array(E);else if(!Array.isArray(E)&&(!m||!ArrayBuffer.isView(E)))throw new Error(e)}else throw new Error(e);W=!0}var L=0,z=E.length;if(W)L=z;else for(var y=0;y<E.length;++y){var $=E.charCodeAt(y);$<128?L+=1:$<2048?L+=2:$<55296||$>=57344?L+=3:($=65536+(($&1023)<<10|E.charCodeAt(++y)&1023),L+=4)}return L+=this.encode(L*8),this.update(E),L},R.prototype.bytepad=function(E,W){for(var D=this.encode(W),L=0;L<E.length;++L)D+=this.encodeString(E[L]);var z=W-D%W,y=[];return y.length=z,this.update(y),this},R.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var E=this.blocks,W=this.lastByteIndex,D=this.blockCount,L=this.s;if(E[W>>2]|=this.padding[W&3],this.lastByteIndex===this.byteCount)for(E[0]=E[D],W=1;W<D+1;++W)E[W]=0;for(E[D-1]|=2147483648,W=0;W<D;++W)L[W]^=E[W];ee(L)}},R.prototype.toString=R.prototype.hex=function(){this.finalize();for(var E=this.blockCount,W=this.s,D=this.outputBlocks,L=this.extraBytes,z=0,y=0,$="",Y;y<D;){for(z=0;z<E&&y<D;++z,++y)Y=W[z],$+=v[Y>>4&15]+v[Y&15]+v[Y>>12&15]+v[Y>>8&15]+v[Y>>20&15]+v[Y>>16&15]+v[Y>>28&15]+v[Y>>24&15];y%E===0&&(ee(W),z=0)}return L&&(Y=W[z],$+=v[Y>>4&15]+v[Y&15],L>1&&($+=v[Y>>12&15]+v[Y>>8&15]),L>2&&($+=v[Y>>20&15]+v[Y>>16&15])),$},R.prototype.arrayBuffer=function(){this.finalize();var E=this.blockCount,W=this.s,D=this.outputBlocks,L=this.extraBytes,z=0,y=0,$=this.outputBits>>3,Y;L?Y=new ArrayBuffer(D+1<<2):Y=new ArrayBuffer($);for(var se=new Uint32Array(Y);y<D;){for(z=0;z<E&&y<D;++z,++y)se[y]=W[z];y%E===0&&ee(W)}return L&&(se[z]=W[z],Y=Y.slice(0,$)),Y},R.prototype.buffer=R.prototype.arrayBuffer,R.prototype.digest=R.prototype.array=function(){this.finalize();for(var E=this.blockCount,W=this.s,D=this.outputBlocks,L=this.extraBytes,z=0,y=0,$=[],Y,se;y<D;){for(z=0;z<E&&y<D;++z,++y)Y=y<<2,se=W[z],$[Y]=se&255,$[Y+1]=se>>8&255,$[Y+2]=se>>16&255,$[Y+3]=se>>24&255;y%E===0&&ee(W)}return L&&(Y=y<<2,se=W[z],$[Y]=se&255,L>1&&($[Y+1]=se>>8&255),L>2&&($[Y+2]=se>>16&255)),$};function X(E,W,D){R.call(this,E,W,D)}X.prototype=new R,X.prototype.finalize=function(){return this.encode(this.outputBits,!0),R.prototype.finalize.call(this)};var ee=function(E){var W,D,L,z,y,$,Y,se,ae,ge,ve,Te,nt,Me,Ve,ke,_e,je,Ge,me,Fe,De,we,We,Le,Pe,ot,ft,qe,ct,ut,Be,wt,dt,ze,At,Et,xe,Ke,Qe,Ie,Je,He,Re,st,Ye,Ne,Xe,et,Ee,Ue,at,Ce,Ot,Tt,tt,bt,Rr,Nr,Cr,Or,Tr,Yt;for(L=0;L<48;L+=2)z=E[0]^E[10]^E[20]^E[30]^E[40],y=E[1]^E[11]^E[21]^E[31]^E[41],$=E[2]^E[12]^E[22]^E[32]^E[42],Y=E[3]^E[13]^E[23]^E[33]^E[43],se=E[4]^E[14]^E[24]^E[34]^E[44],ae=E[5]^E[15]^E[25]^E[35]^E[45],ge=E[6]^E[16]^E[26]^E[36]^E[46],ve=E[7]^E[17]^E[27]^E[37]^E[47],Te=E[8]^E[18]^E[28]^E[38]^E[48],nt=E[9]^E[19]^E[29]^E[39]^E[49],W=Te^($<<1|Y>>>31),D=nt^(Y<<1|$>>>31),E[0]^=W,E[1]^=D,E[10]^=W,E[11]^=D,E[20]^=W,E[21]^=D,E[30]^=W,E[31]^=D,E[40]^=W,E[41]^=D,W=z^(se<<1|ae>>>31),D=y^(ae<<1|se>>>31),E[2]^=W,E[3]^=D,E[12]^=W,E[13]^=D,E[22]^=W,E[23]^=D,E[32]^=W,E[33]^=D,E[42]^=W,E[43]^=D,W=$^(ge<<1|ve>>>31),D=Y^(ve<<1|ge>>>31),E[4]^=W,E[5]^=D,E[14]^=W,E[15]^=D,E[24]^=W,E[25]^=D,E[34]^=W,E[35]^=D,E[44]^=W,E[45]^=D,W=se^(Te<<1|nt>>>31),D=ae^(nt<<1|Te>>>31),E[6]^=W,E[7]^=D,E[16]^=W,E[17]^=D,E[26]^=W,E[27]^=D,E[36]^=W,E[37]^=D,E[46]^=W,E[47]^=D,W=ge^(z<<1|y>>>31),D=ve^(y<<1|z>>>31),E[8]^=W,E[9]^=D,E[18]^=W,E[19]^=D,E[28]^=W,E[29]^=D,E[38]^=W,E[39]^=D,E[48]^=W,E[49]^=D,Me=E[0],Ve=E[1],Ye=E[11]<<4|E[10]>>>28,Ne=E[10]<<4|E[11]>>>28,ft=E[20]<<3|E[21]>>>29,qe=E[21]<<3|E[20]>>>29,Cr=E[31]<<9|E[30]>>>23,Or=E[30]<<9|E[31]>>>23,Je=E[40]<<18|E[41]>>>14,He=E[41]<<18|E[40]>>>14,dt=E[2]<<1|E[3]>>>31,ze=E[3]<<1|E[2]>>>31,ke=E[13]<<12|E[12]>>>20,_e=E[12]<<12|E[13]>>>20,Xe=E[22]<<10|E[23]>>>22,et=E[23]<<10|E[22]>>>22,ct=E[33]<<13|E[32]>>>19,ut=E[32]<<13|E[33]>>>19,Tr=E[42]<<2|E[43]>>>30,Yt=E[43]<<2|E[42]>>>30,Ot=E[5]<<30|E[4]>>>2,Tt=E[4]<<30|E[5]>>>2,At=E[14]<<6|E[15]>>>26,Et=E[15]<<6|E[14]>>>26,je=E[25]<<11|E[24]>>>21,Ge=E[24]<<11|E[25]>>>21,Ee=E[34]<<15|E[35]>>>17,Ue=E[35]<<15|E[34]>>>17,Be=E[45]<<29|E[44]>>>3,wt=E[44]<<29|E[45]>>>3,We=E[6]<<28|E[7]>>>4,Le=E[7]<<28|E[6]>>>4,tt=E[17]<<23|E[16]>>>9,bt=E[16]<<23|E[17]>>>9,xe=E[26]<<25|E[27]>>>7,Ke=E[27]<<25|E[26]>>>7,me=E[36]<<21|E[37]>>>11,Fe=E[37]<<21|E[36]>>>11,at=E[47]<<24|E[46]>>>8,Ce=E[46]<<24|E[47]>>>8,Re=E[8]<<27|E[9]>>>5,st=E[9]<<27|E[8]>>>5,Pe=E[18]<<20|E[19]>>>12,ot=E[19]<<20|E[18]>>>12,Rr=E[29]<<7|E[28]>>>25,Nr=E[28]<<7|E[29]>>>25,Qe=E[38]<<8|E[39]>>>24,Ie=E[39]<<8|E[38]>>>24,De=E[48]<<14|E[49]>>>18,we=E[49]<<14|E[48]>>>18,E[0]=Me^~ke&je,E[1]=Ve^~_e&Ge,E[10]=We^~Pe&ft,E[11]=Le^~ot&qe,E[20]=dt^~At&xe,E[21]=ze^~Et&Ke,E[30]=Re^~Ye&Xe,E[31]=st^~Ne&et,E[40]=Ot^~tt&Rr,E[41]=Tt^~bt&Nr,E[2]=ke^~je&me,E[3]=_e^~Ge&Fe,E[12]=Pe^~ft&ct,E[13]=ot^~qe&ut,E[22]=At^~xe&Qe,E[23]=Et^~Ke&Ie,E[32]=Ye^~Xe&Ee,E[33]=Ne^~et&Ue,E[42]=tt^~Rr&Cr,E[43]=bt^~Nr&Or,E[4]=je^~me&De,E[5]=Ge^~Fe&we,E[14]=ft^~ct&Be,E[15]=qe^~ut&wt,E[24]=xe^~Qe&Je,E[25]=Ke^~Ie&He,E[34]=Xe^~Ee&at,E[35]=et^~Ue&Ce,E[44]=Rr^~Cr&Tr,E[45]=Nr^~Or&Yt,E[6]=me^~De&Me,E[7]=Fe^~we&Ve,E[16]=ct^~Be&We,E[17]=ut^~wt&Le,E[26]=Qe^~Je&dt,E[27]=Ie^~He&ze,E[36]=Ee^~at&Re,E[37]=Ue^~Ce&st,E[46]=Cr^~Tr&Ot,E[47]=Or^~Yt&Tt,E[8]=De^~Me&ke,E[9]=we^~Ve&_e,E[18]=Be^~We&Pe,E[19]=wt^~Le&ot,E[28]=Je^~dt&At,E[29]=He^~ze&Et,E[38]=at^~Re&Ye,E[39]=Ce^~st&Ne,E[48]=Tr^~Ot&tt,E[49]=Yt^~Tt&bt,E[0]^=j[L],E[1]^=j[L+1]};if(p)r.exports=d;else for(A=0;A<g.length;++A)s[g[A]]=d[g[A]]})()})(lv);var Z9=lv.exports;const e_="logger/5.7.0";let jp=!1,Fp=!1;const Rh={debug:1,default:2,info:2,warning:3,error:4,off:5};let Kp=Rh.default,ku=null;function t_(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{r.push(e)}}),r.length)throw new Error("missing "+r.join(", "));if("".normalize("NFD")!=="e")throw new Error("broken implementation")}catch(r){return r.message}return null}const Hp=t_();var gd;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(gd||(gd={}));var an;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(an||(an={}));const Vp="0123456789abcdef";let Mr=class dr{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const i=e.toLowerCase();Rh[i]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(Kp>Rh[i])&&console.log.apply(console,t)}debug(...e){this._log(dr.levels.DEBUG,e)}info(...e){this._log(dr.levels.INFO,e)}warn(...e){this._log(dr.levels.WARNING,e)}makeError(e,t,i){if(Fp)return this.makeError("censored error",t,{});t||(t=dr.errors.UNKNOWN_ERROR),i||(i={});const s=[];Object.keys(i).forEach(m=>{const v=i[m];try{if(v instanceof Uint8Array){let _="";for(let I=0;I<v.length;I++)_+=Vp[v[I]>>4],_+=Vp[v[I]&15];s.push(m+"=Uint8Array(0x"+_+")")}else s.push(m+"="+JSON.stringify(v))}catch{s.push(m+"="+JSON.stringify(i[m].toString()))}}),s.push(`code=${t}`),s.push(`version=${this.version}`);const a=e;let h="";switch(t){case an.NUMERIC_FAULT:{h="NUMERIC_FAULT";const m=e;switch(m){case"overflow":case"underflow":case"division-by-zero":h+="-"+m;break;case"negative-power":case"negative-width":h+="-unsupported";break;case"unbound-bitwise-result":h+="-unbound-result";break}break}case an.CALL_EXCEPTION:case an.INSUFFICIENT_FUNDS:case an.MISSING_NEW:case an.NONCE_EXPIRED:case an.REPLACEMENT_UNDERPRICED:case an.TRANSACTION_REPLACED:case an.UNPREDICTABLE_GAS_LIMIT:h=t;break}h&&(e+=" [ See: https://links.ethers.org/v5-errors-"+h+" ]"),s.length&&(e+=" ("+s.join(", ")+")");const p=new Error(e);return p.reason=a,p.code=t,Object.keys(i).forEach(function(m){p[m]=i[m]}),p}throwError(e,t,i){throw this.makeError(e,t,i)}throwArgumentError(e,t,i){return this.throwError(e,dr.errors.INVALID_ARGUMENT,{argument:t,value:i})}assert(e,t,i,s){e||this.throwError(t,i,s)}assertArgument(e,t,i,s){e||this.throwArgumentError(t,i,s)}checkNormalize(e){Hp&&this.throwError("platform missing String.prototype.normalize",dr.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Hp})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,dr.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,dr.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,i){i?i=": "+i:i="",e<t&&this.throwError("missing argument"+i,dr.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+i,dr.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",dr.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",dr.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",dr.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return ku||(ku=new dr(e_)),ku}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",dr.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),jp){if(!e)return;this.globalLogger().throwError("error censorship permanent",dr.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Fp=!!e,jp=!!t}static setLogLevel(e){const t=Rh[e.toLowerCase()];if(t==null){dr.globalLogger().warn("invalid log level - "+e);return}Kp=t}static from(e){return new dr(e)}};Mr.errors=an,Mr.levels=gd;const r_="bytes/5.7.0",sr=new Mr(r_);function pv(r){return!!r.toHexString}function $a(r){return r.slice||(r.slice=function(){const e=Array.prototype.slice.call(arguments);return $a(new Uint8Array(Array.prototype.slice.apply(r,e)))}),r}function i_(r){return mi(r)&&!(r.length%2)||eo(r)}function Gp(r){return typeof r=="number"&&r==r&&r%1===0}function eo(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!Gp(r.length)||r.length<0)return!1;for(let e=0;e<r.length;e++){const t=r[e];if(!Gp(t)||t<0||t>=256)return!1}return!0}function er(r,e){if(e||(e={}),typeof r=="number"){sr.checkSafeUint53(r,"invalid arrayify value");const t=[];for(;r;)t.unshift(r&255),r=parseInt(String(r/256));return t.length===0&&t.push(0),$a(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),pv(r)&&(r=r.toHexString()),mi(r)){let t=r.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":sr.throwArgumentError("hex data is odd-length","value",r));const i=[];for(let s=0;s<t.length;s+=2)i.push(parseInt(t.substring(s,s+2),16));return $a(new Uint8Array(i))}return eo(r)?$a(new Uint8Array(r)):sr.throwArgumentError("invalid arrayify value","value",r)}function n_(r){const e=r.map(s=>er(s)),t=e.reduce((s,a)=>s+a.length,0),i=new Uint8Array(t);return e.reduce((s,a)=>(i.set(a,s),s+a.length),0),$a(i)}function s_(r,e){r=er(r),r.length>e&&sr.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(r,e-r.length),$a(t)}function mi(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||e&&r.length!==2+2*e)}const Lu="0123456789abcdef";function si(r,e){if(e||(e={}),typeof r=="number"){sr.checkSafeUint53(r,"invalid hexlify value");let t="";for(;r;)t=Lu[r&15]+t,r=Math.floor(r/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),pv(r))return r.toHexString();if(mi(r))return r.length%2&&(e.hexPad==="left"?r="0x0"+r.substring(2):e.hexPad==="right"?r+="0":sr.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(eo(r)){let t="0x";for(let i=0;i<r.length;i++){let s=r[i];t+=Lu[(s&240)>>4]+Lu[s&15]}return t}return sr.throwArgumentError("invalid hexlify value","value",r)}function a_(r){if(typeof r!="string")r=si(r);else if(!mi(r)||r.length%2)return null;return(r.length-2)/2}function Jp(r,e,t){return typeof r!="string"?r=si(r):(!mi(r)||r.length%2)&&sr.throwArgumentError("invalid hexData","value",r),e=2+2*e,t!=null?"0x"+r.substring(e,2+2*t):"0x"+r.substring(e)}function Rn(r,e){for(typeof r!="string"?r=si(r):mi(r)||sr.throwArgumentError("invalid hex string","value",r),r.length>2*e+2&&sr.throwArgumentError("value out of range","value",arguments[1]);r.length<2*e+2;)r="0x0"+r.substring(2);return r}function gv(r){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(i_(r)){let t=er(r);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=si(t.slice(0,32)),e.s=si(t.slice(32,64))):t.length===65?(e.r=si(t.slice(0,32)),e.s=si(t.slice(32,64)),e.v=t[64]):sr.throwArgumentError("invalid signature string","signature",r),e.v<27&&(e.v===0||e.v===1?e.v+=27:sr.throwArgumentError("signature invalid v byte","signature",r)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=si(t.slice(32,64))}else{if(e.r=r.r,e.s=r.s,e.v=r.v,e.recoveryParam=r.recoveryParam,e._vs=r._vs,e._vs!=null){const s=s_(er(e._vs),32);e._vs=si(s);const a=s[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=a:e.recoveryParam!==a&&sr.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),s[0]&=127;const h=si(s);e.s==null?e.s=h:e.s!==h&&sr.throwArgumentError("signature v mismatch _vs","signature",r)}if(e.recoveryParam==null)e.v==null?sr.throwArgumentError("signature missing v and recoveryParam","signature",r):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const s=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==s&&sr.throwArgumentError("signature recoveryParam mismatch v","signature",r)}e.r==null||!mi(e.r)?sr.throwArgumentError("signature missing or invalid r","signature",r):e.r=Rn(e.r,32),e.s==null||!mi(e.s)?sr.throwArgumentError("signature missing or invalid s","signature",r):e.s=Rn(e.s,32);const t=er(e.s);t[0]>=128&&sr.throwArgumentError("signature s out of range","signature",r),e.recoveryParam&&(t[0]|=128);const i=si(t);e._vs&&(mi(e._vs)||sr.throwArgumentError("signature invalid _vs","signature",r),e._vs=Rn(e._vs,32)),e._vs==null?e._vs=i:e._vs!==i&&sr.throwArgumentError("signature _vs mismatch v and s","signature",r)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function Ud(r){return"0x"+Z9.keccak_256(er(r))}var vv={exports:{}},o_={},c_=Object.freeze({__proto__:null,default:o_}),h_=X9(c_);(function(r){(function(e,t){function i(c,d){if(!c)throw new Error(d||"Assertion failed")}function s(c,d){c.super_=d;var g=function(){};g.prototype=d.prototype,c.prototype=new g,c.prototype.constructor=c}function a(c,d,g){if(a.isBN(c))return c;this.negative=0,this.words=null,this.length=0,this.red=null,c!==null&&((d==="le"||d==="be")&&(g=d,d=10),this._init(c||0,d||10,g||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=h_.Buffer}catch{}a.isBN=function(c){return c instanceof a?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===a.wordSize&&Array.isArray(c.words)},a.max=function(c,d){return c.cmp(d)>0?c:d},a.min=function(c,d){return c.cmp(d)<0?c:d},a.prototype._init=function(c,d,g){if(typeof c=="number")return this._initNumber(c,d,g);if(typeof c=="object")return this._initArray(c,d,g);d==="hex"&&(d=16),i(d===(d|0)&&d>=2&&d<=36),c=c.toString().replace(/\s+/g,"");var A=0;c[0]==="-"&&(A++,this.negative=1),A<c.length&&(d===16?this._parseHex(c,A,g):(this._parseBase(c,d,A),g==="le"&&this._initArray(this.toArray(),d,g)))},a.prototype._initNumber=function(c,d,g){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(i(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),g==="le"&&this._initArray(this.toArray(),d,g)},a.prototype._initArray=function(c,d,g){if(i(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var M,S,x=0;if(g==="be")for(A=c.length-1,M=0;A>=0;A-=3)S=c[A]|c[A-1]<<8|c[A-2]<<16,this.words[M]|=S<<x&67108863,this.words[M+1]=S>>>26-x&67108863,x+=24,x>=26&&(x-=26,M++);else if(g==="le")for(A=0,M=0;A<c.length;A+=3)S=c[A]|c[A+1]<<8|c[A+2]<<16,this.words[M]|=S<<x&67108863,this.words[M+1]=S>>>26-x&67108863,x+=24,x>=26&&(x-=26,M++);return this._strip()};function p(c,d){var g=c.charCodeAt(d);if(g>=48&&g<=57)return g-48;if(g>=65&&g<=70)return g-55;if(g>=97&&g<=102)return g-87;i(!1,"Invalid character in "+c)}function m(c,d,g){var A=p(c,g);return g-1>=d&&(A|=p(c,g-1)<<4),A}a.prototype._parseHex=function(c,d,g){this.length=Math.ceil((c.length-d)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var M=0,S=0,x;if(g==="be")for(A=c.length-1;A>=d;A-=2)x=m(c,d,A)<<M,this.words[S]|=x&67108863,M>=18?(M-=18,S+=1,this.words[S]|=x>>>26):M+=8;else{var u=c.length-d;for(A=u%2===0?d+1:d;A<c.length;A+=2)x=m(c,d,A)<<M,this.words[S]|=x&67108863,M>=18?(M-=18,S+=1,this.words[S]|=x>>>26):M+=8}this._strip()};function v(c,d,g,A){for(var M=0,S=0,x=Math.min(c.length,g),u=d;u<x;u++){var l=c.charCodeAt(u)-48;M*=A,l>=49?S=l-49+10:l>=17?S=l-17+10:S=l,i(l>=0&&S<A,"Invalid character"),M+=S}return M}a.prototype._parseBase=function(c,d,g){this.words=[0],this.length=1;for(var A=0,M=1;M<=67108863;M*=d)A++;A--,M=M/d|0;for(var S=c.length-g,x=S%A,u=Math.min(S,S-x)+g,l=0,R=g;R<u;R+=A)l=v(c,R,R+A,d),this.imuln(M),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(x!==0){var X=1;for(l=v(c,R,c.length,d),R=0;R<x;R++)X*=d;this.imuln(X),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this._strip()},a.prototype.copy=function(c){c.words=new Array(this.length);for(var d=0;d<this.length;d++)c.words[d]=this.words[d];c.length=this.length,c.negative=this.negative,c.red=this.red};function _(c,d){c.words=d.words,c.length=d.length,c.negative=d.negative,c.red=d.red}if(a.prototype._move=function(c){_(c,this)},a.prototype.clone=function(){var c=new a(null);return this.copy(c),c},a.prototype._expand=function(c){for(;this.length<c;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=I}catch{a.prototype.inspect=I}else a.prototype.inspect=I;function I(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var N=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],O=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],q=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(c,d){c=c||10,d=d|0||1;var g;if(c===16||c==="hex"){g="";for(var A=0,M=0,S=0;S<this.length;S++){var x=this.words[S],u=((x<<A|M)&16777215).toString(16);M=x>>>24-A&16777215,A+=2,A>=26&&(A-=26,S--),M!==0||S!==this.length-1?g=N[6-u.length]+u+g:g=u+g}for(M!==0&&(g=M.toString(16)+g);g.length%d!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}if(c===(c|0)&&c>=2&&c<=36){var l=O[c],R=q[c];g="";var X=this.clone();for(X.negative=0;!X.isZero();){var ee=X.modrn(R).toString(c);X=X.idivn(R),X.isZero()?g=ee+g:g=N[l-ee.length]+ee+g}for(this.isZero()&&(g="0"+g);g.length%d!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},a.prototype.toJSON=function(){return this.toString(16,2)},h&&(a.prototype.toBuffer=function(c,d){return this.toArrayLike(h,c,d)}),a.prototype.toArray=function(c,d){return this.toArrayLike(Array,c,d)};var j=function(c,d){return c.allocUnsafe?c.allocUnsafe(d):new c(d)};a.prototype.toArrayLike=function(c,d,g){this._strip();var A=this.byteLength(),M=g||Math.max(1,A);i(A<=M,"byte array longer than desired length"),i(M>0,"Requested array length <= 0");var S=j(c,M),x=d==="le"?"LE":"BE";return this["_toArrayLike"+x](S,A),S},a.prototype._toArrayLikeLE=function(c,d){for(var g=0,A=0,M=0,S=0;M<this.length;M++){var x=this.words[M]<<S|A;c[g++]=x&255,g<c.length&&(c[g++]=x>>8&255),g<c.length&&(c[g++]=x>>16&255),S===6?(g<c.length&&(c[g++]=x>>24&255),A=0,S=0):(A=x>>>24,S+=2)}if(g<c.length)for(c[g++]=A;g<c.length;)c[g++]=0},a.prototype._toArrayLikeBE=function(c,d){for(var g=c.length-1,A=0,M=0,S=0;M<this.length;M++){var x=this.words[M]<<S|A;c[g--]=x&255,g>=0&&(c[g--]=x>>8&255),g>=0&&(c[g--]=x>>16&255),S===6?(g>=0&&(c[g--]=x>>24&255),A=0,S=0):(A=x>>>24,S+=2)}if(g>=0)for(c[g--]=A;g>=0;)c[g--]=0},Math.clz32?a.prototype._countBits=function(c){return 32-Math.clz32(c)}:a.prototype._countBits=function(c){var d=c,g=0;return d>=4096&&(g+=13,d>>>=13),d>=64&&(g+=7,d>>>=7),d>=8&&(g+=4,d>>>=4),d>=2&&(g+=2,d>>>=2),g+d},a.prototype._zeroBits=function(c){if(c===0)return 26;var d=c,g=0;return d&8191||(g+=13,d>>>=13),d&127||(g+=7,d>>>=7),d&15||(g+=4,d>>>=4),d&3||(g+=2,d>>>=2),d&1||g++,g},a.prototype.bitLength=function(){var c=this.words[this.length-1],d=this._countBits(c);return(this.length-1)*26+d};function K(c){for(var d=new Array(c.bitLength()),g=0;g<d.length;g++){var A=g/26|0,M=g%26;d[g]=c.words[A]>>>M&1}return d}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var c=0,d=0;d<this.length;d++){var g=this._zeroBits(this.words[d]);if(c+=g,g!==26)break}return c},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},a.prototype.fromTwos=function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]|c.words[d];return this._strip()},a.prototype.ior=function(c){return i((this.negative|c.negative)===0),this.iuor(c)},a.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},a.prototype.uor=function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},a.prototype.iuand=function(c){var d;this.length>c.length?d=c:d=this;for(var g=0;g<d.length;g++)this.words[g]=this.words[g]&c.words[g];return this.length=d.length,this._strip()},a.prototype.iand=function(c){return i((this.negative|c.negative)===0),this.iuand(c)},a.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},a.prototype.uand=function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},a.prototype.iuxor=function(c){var d,g;this.length>c.length?(d=this,g=c):(d=c,g=this);for(var A=0;A<g.length;A++)this.words[A]=d.words[A]^g.words[A];if(this!==d)for(;A<d.length;A++)this.words[A]=d.words[A];return this.length=d.length,this._strip()},a.prototype.ixor=function(c){return i((this.negative|c.negative)===0),this.iuxor(c)},a.prototype.xor=function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},a.prototype.uxor=function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},a.prototype.inotn=function(c){i(typeof c=="number"&&c>=0);var d=Math.ceil(c/26)|0,g=c%26;this._expand(d),g>0&&d--;for(var A=0;A<d;A++)this.words[A]=~this.words[A]&67108863;return g>0&&(this.words[A]=~this.words[A]&67108863>>26-g),this._strip()},a.prototype.notn=function(c){return this.clone().inotn(c)},a.prototype.setn=function(c,d){i(typeof c=="number"&&c>=0);var g=c/26|0,A=c%26;return this._expand(g+1),d?this.words[g]=this.words[g]|1<<A:this.words[g]=this.words[g]&~(1<<A),this._strip()},a.prototype.iadd=function(c){var d;if(this.negative!==0&&c.negative===0)return this.negative=0,d=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,d=this.isub(c),c.negative=1,d._normSign();var g,A;this.length>c.length?(g=this,A=c):(g=c,A=this);for(var M=0,S=0;S<A.length;S++)d=(g.words[S]|0)+(A.words[S]|0)+M,this.words[S]=d&67108863,M=d>>>26;for(;M!==0&&S<g.length;S++)d=(g.words[S]|0)+M,this.words[S]=d&67108863,M=d>>>26;if(this.length=g.length,M!==0)this.words[this.length]=M,this.length++;else if(g!==this)for(;S<g.length;S++)this.words[S]=g.words[S];return this},a.prototype.add=function(c){var d;return c.negative!==0&&this.negative===0?(c.negative=0,d=this.sub(c),c.negative^=1,d):c.negative===0&&this.negative!==0?(this.negative=0,d=c.sub(this),this.negative=1,d):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},a.prototype.isub=function(c){if(c.negative!==0){c.negative=0;var d=this.iadd(c);return c.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var g=this.cmp(c);if(g===0)return this.negative=0,this.length=1,this.words[0]=0,this;var A,M;g>0?(A=this,M=c):(A=c,M=this);for(var S=0,x=0;x<M.length;x++)d=(A.words[x]|0)-(M.words[x]|0)+S,S=d>>26,this.words[x]=d&67108863;for(;S!==0&&x<A.length;x++)d=(A.words[x]|0)+S,S=d>>26,this.words[x]=d&67108863;if(S===0&&x<A.length&&A!==this)for(;x<A.length;x++)this.words[x]=A.words[x];return this.length=Math.max(this.length,x),A!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(c){return this.clone().isub(c)};function J(c,d,g){g.negative=d.negative^c.negative;var A=c.length+d.length|0;g.length=A,A=A-1|0;var M=c.words[0]|0,S=d.words[0]|0,x=M*S,u=x&67108863,l=x/67108864|0;g.words[0]=u;for(var R=1;R<A;R++){for(var X=l>>>26,ee=l&67108863,E=Math.min(R,d.length-1),W=Math.max(0,R-c.length+1);W<=E;W++){var D=R-W|0;M=c.words[D]|0,S=d.words[W]|0,x=M*S+ee,X+=x/67108864|0,ee=x&67108863}g.words[R]=ee|0,l=X|0}return l!==0?g.words[R]=l|0:g.length--,g._strip()}var Z=function(c,d,g){var A=c.words,M=d.words,S=g.words,x=0,u,l,R,X=A[0]|0,ee=X&8191,E=X>>>13,W=A[1]|0,D=W&8191,L=W>>>13,z=A[2]|0,y=z&8191,$=z>>>13,Y=A[3]|0,se=Y&8191,ae=Y>>>13,ge=A[4]|0,ve=ge&8191,Te=ge>>>13,nt=A[5]|0,Me=nt&8191,Ve=nt>>>13,ke=A[6]|0,_e=ke&8191,je=ke>>>13,Ge=A[7]|0,me=Ge&8191,Fe=Ge>>>13,De=A[8]|0,we=De&8191,We=De>>>13,Le=A[9]|0,Pe=Le&8191,ot=Le>>>13,ft=M[0]|0,qe=ft&8191,ct=ft>>>13,ut=M[1]|0,Be=ut&8191,wt=ut>>>13,dt=M[2]|0,ze=dt&8191,At=dt>>>13,Et=M[3]|0,xe=Et&8191,Ke=Et>>>13,Qe=M[4]|0,Ie=Qe&8191,Je=Qe>>>13,He=M[5]|0,Re=He&8191,st=He>>>13,Ye=M[6]|0,Ne=Ye&8191,Xe=Ye>>>13,et=M[7]|0,Ee=et&8191,Ue=et>>>13,at=M[8]|0,Ce=at&8191,Ot=at>>>13,Tt=M[9]|0,tt=Tt&8191,bt=Tt>>>13;g.negative=c.negative^d.negative,g.length=19,u=Math.imul(ee,qe),l=Math.imul(ee,ct),l=l+Math.imul(E,qe)|0,R=Math.imul(E,ct);var Rr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Rr>>>26)|0,Rr&=67108863,u=Math.imul(D,qe),l=Math.imul(D,ct),l=l+Math.imul(L,qe)|0,R=Math.imul(L,ct),u=u+Math.imul(ee,Be)|0,l=l+Math.imul(ee,wt)|0,l=l+Math.imul(E,Be)|0,R=R+Math.imul(E,wt)|0;var Nr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,u=Math.imul(y,qe),l=Math.imul(y,ct),l=l+Math.imul($,qe)|0,R=Math.imul($,ct),u=u+Math.imul(D,Be)|0,l=l+Math.imul(D,wt)|0,l=l+Math.imul(L,Be)|0,R=R+Math.imul(L,wt)|0,u=u+Math.imul(ee,ze)|0,l=l+Math.imul(ee,At)|0,l=l+Math.imul(E,ze)|0,R=R+Math.imul(E,At)|0;var Cr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,u=Math.imul(se,qe),l=Math.imul(se,ct),l=l+Math.imul(ae,qe)|0,R=Math.imul(ae,ct),u=u+Math.imul(y,Be)|0,l=l+Math.imul(y,wt)|0,l=l+Math.imul($,Be)|0,R=R+Math.imul($,wt)|0,u=u+Math.imul(D,ze)|0,l=l+Math.imul(D,At)|0,l=l+Math.imul(L,ze)|0,R=R+Math.imul(L,At)|0,u=u+Math.imul(ee,xe)|0,l=l+Math.imul(ee,Ke)|0,l=l+Math.imul(E,xe)|0,R=R+Math.imul(E,Ke)|0;var Or=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Or>>>26)|0,Or&=67108863,u=Math.imul(ve,qe),l=Math.imul(ve,ct),l=l+Math.imul(Te,qe)|0,R=Math.imul(Te,ct),u=u+Math.imul(se,Be)|0,l=l+Math.imul(se,wt)|0,l=l+Math.imul(ae,Be)|0,R=R+Math.imul(ae,wt)|0,u=u+Math.imul(y,ze)|0,l=l+Math.imul(y,At)|0,l=l+Math.imul($,ze)|0,R=R+Math.imul($,At)|0,u=u+Math.imul(D,xe)|0,l=l+Math.imul(D,Ke)|0,l=l+Math.imul(L,xe)|0,R=R+Math.imul(L,Ke)|0,u=u+Math.imul(ee,Ie)|0,l=l+Math.imul(ee,Je)|0,l=l+Math.imul(E,Ie)|0,R=R+Math.imul(E,Je)|0;var Tr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Tr>>>26)|0,Tr&=67108863,u=Math.imul(Me,qe),l=Math.imul(Me,ct),l=l+Math.imul(Ve,qe)|0,R=Math.imul(Ve,ct),u=u+Math.imul(ve,Be)|0,l=l+Math.imul(ve,wt)|0,l=l+Math.imul(Te,Be)|0,R=R+Math.imul(Te,wt)|0,u=u+Math.imul(se,ze)|0,l=l+Math.imul(se,At)|0,l=l+Math.imul(ae,ze)|0,R=R+Math.imul(ae,At)|0,u=u+Math.imul(y,xe)|0,l=l+Math.imul(y,Ke)|0,l=l+Math.imul($,xe)|0,R=R+Math.imul($,Ke)|0,u=u+Math.imul(D,Ie)|0,l=l+Math.imul(D,Je)|0,l=l+Math.imul(L,Ie)|0,R=R+Math.imul(L,Je)|0,u=u+Math.imul(ee,Re)|0,l=l+Math.imul(ee,st)|0,l=l+Math.imul(E,Re)|0,R=R+Math.imul(E,st)|0;var Yt=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,u=Math.imul(_e,qe),l=Math.imul(_e,ct),l=l+Math.imul(je,qe)|0,R=Math.imul(je,ct),u=u+Math.imul(Me,Be)|0,l=l+Math.imul(Me,wt)|0,l=l+Math.imul(Ve,Be)|0,R=R+Math.imul(Ve,wt)|0,u=u+Math.imul(ve,ze)|0,l=l+Math.imul(ve,At)|0,l=l+Math.imul(Te,ze)|0,R=R+Math.imul(Te,At)|0,u=u+Math.imul(se,xe)|0,l=l+Math.imul(se,Ke)|0,l=l+Math.imul(ae,xe)|0,R=R+Math.imul(ae,Ke)|0,u=u+Math.imul(y,Ie)|0,l=l+Math.imul(y,Je)|0,l=l+Math.imul($,Ie)|0,R=R+Math.imul($,Je)|0,u=u+Math.imul(D,Re)|0,l=l+Math.imul(D,st)|0,l=l+Math.imul(L,Re)|0,R=R+Math.imul(L,st)|0,u=u+Math.imul(ee,Ne)|0,l=l+Math.imul(ee,Xe)|0,l=l+Math.imul(E,Ne)|0,R=R+Math.imul(E,Xe)|0;var Jr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,u=Math.imul(me,qe),l=Math.imul(me,ct),l=l+Math.imul(Fe,qe)|0,R=Math.imul(Fe,ct),u=u+Math.imul(_e,Be)|0,l=l+Math.imul(_e,wt)|0,l=l+Math.imul(je,Be)|0,R=R+Math.imul(je,wt)|0,u=u+Math.imul(Me,ze)|0,l=l+Math.imul(Me,At)|0,l=l+Math.imul(Ve,ze)|0,R=R+Math.imul(Ve,At)|0,u=u+Math.imul(ve,xe)|0,l=l+Math.imul(ve,Ke)|0,l=l+Math.imul(Te,xe)|0,R=R+Math.imul(Te,Ke)|0,u=u+Math.imul(se,Ie)|0,l=l+Math.imul(se,Je)|0,l=l+Math.imul(ae,Ie)|0,R=R+Math.imul(ae,Je)|0,u=u+Math.imul(y,Re)|0,l=l+Math.imul(y,st)|0,l=l+Math.imul($,Re)|0,R=R+Math.imul($,st)|0,u=u+Math.imul(D,Ne)|0,l=l+Math.imul(D,Xe)|0,l=l+Math.imul(L,Ne)|0,R=R+Math.imul(L,Xe)|0,u=u+Math.imul(ee,Ee)|0,l=l+Math.imul(ee,Ue)|0,l=l+Math.imul(E,Ee)|0,R=R+Math.imul(E,Ue)|0;var ji=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(ji>>>26)|0,ji&=67108863,u=Math.imul(we,qe),l=Math.imul(we,ct),l=l+Math.imul(We,qe)|0,R=Math.imul(We,ct),u=u+Math.imul(me,Be)|0,l=l+Math.imul(me,wt)|0,l=l+Math.imul(Fe,Be)|0,R=R+Math.imul(Fe,wt)|0,u=u+Math.imul(_e,ze)|0,l=l+Math.imul(_e,At)|0,l=l+Math.imul(je,ze)|0,R=R+Math.imul(je,At)|0,u=u+Math.imul(Me,xe)|0,l=l+Math.imul(Me,Ke)|0,l=l+Math.imul(Ve,xe)|0,R=R+Math.imul(Ve,Ke)|0,u=u+Math.imul(ve,Ie)|0,l=l+Math.imul(ve,Je)|0,l=l+Math.imul(Te,Ie)|0,R=R+Math.imul(Te,Je)|0,u=u+Math.imul(se,Re)|0,l=l+Math.imul(se,st)|0,l=l+Math.imul(ae,Re)|0,R=R+Math.imul(ae,st)|0,u=u+Math.imul(y,Ne)|0,l=l+Math.imul(y,Xe)|0,l=l+Math.imul($,Ne)|0,R=R+Math.imul($,Xe)|0,u=u+Math.imul(D,Ee)|0,l=l+Math.imul(D,Ue)|0,l=l+Math.imul(L,Ee)|0,R=R+Math.imul(L,Ue)|0,u=u+Math.imul(ee,Ce)|0,l=l+Math.imul(ee,Ot)|0,l=l+Math.imul(E,Ce)|0,R=R+Math.imul(E,Ot)|0;var Wr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Wr>>>26)|0,Wr&=67108863,u=Math.imul(Pe,qe),l=Math.imul(Pe,ct),l=l+Math.imul(ot,qe)|0,R=Math.imul(ot,ct),u=u+Math.imul(we,Be)|0,l=l+Math.imul(we,wt)|0,l=l+Math.imul(We,Be)|0,R=R+Math.imul(We,wt)|0,u=u+Math.imul(me,ze)|0,l=l+Math.imul(me,At)|0,l=l+Math.imul(Fe,ze)|0,R=R+Math.imul(Fe,At)|0,u=u+Math.imul(_e,xe)|0,l=l+Math.imul(_e,Ke)|0,l=l+Math.imul(je,xe)|0,R=R+Math.imul(je,Ke)|0,u=u+Math.imul(Me,Ie)|0,l=l+Math.imul(Me,Je)|0,l=l+Math.imul(Ve,Ie)|0,R=R+Math.imul(Ve,Je)|0,u=u+Math.imul(ve,Re)|0,l=l+Math.imul(ve,st)|0,l=l+Math.imul(Te,Re)|0,R=R+Math.imul(Te,st)|0,u=u+Math.imul(se,Ne)|0,l=l+Math.imul(se,Xe)|0,l=l+Math.imul(ae,Ne)|0,R=R+Math.imul(ae,Xe)|0,u=u+Math.imul(y,Ee)|0,l=l+Math.imul(y,Ue)|0,l=l+Math.imul($,Ee)|0,R=R+Math.imul($,Ue)|0,u=u+Math.imul(D,Ce)|0,l=l+Math.imul(D,Ot)|0,l=l+Math.imul(L,Ce)|0,R=R+Math.imul(L,Ot)|0,u=u+Math.imul(ee,tt)|0,l=l+Math.imul(ee,bt)|0,l=l+Math.imul(E,tt)|0,R=R+Math.imul(E,bt)|0;var Fi=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Fi>>>26)|0,Fi&=67108863,u=Math.imul(Pe,Be),l=Math.imul(Pe,wt),l=l+Math.imul(ot,Be)|0,R=Math.imul(ot,wt),u=u+Math.imul(we,ze)|0,l=l+Math.imul(we,At)|0,l=l+Math.imul(We,ze)|0,R=R+Math.imul(We,At)|0,u=u+Math.imul(me,xe)|0,l=l+Math.imul(me,Ke)|0,l=l+Math.imul(Fe,xe)|0,R=R+Math.imul(Fe,Ke)|0,u=u+Math.imul(_e,Ie)|0,l=l+Math.imul(_e,Je)|0,l=l+Math.imul(je,Ie)|0,R=R+Math.imul(je,Je)|0,u=u+Math.imul(Me,Re)|0,l=l+Math.imul(Me,st)|0,l=l+Math.imul(Ve,Re)|0,R=R+Math.imul(Ve,st)|0,u=u+Math.imul(ve,Ne)|0,l=l+Math.imul(ve,Xe)|0,l=l+Math.imul(Te,Ne)|0,R=R+Math.imul(Te,Xe)|0,u=u+Math.imul(se,Ee)|0,l=l+Math.imul(se,Ue)|0,l=l+Math.imul(ae,Ee)|0,R=R+Math.imul(ae,Ue)|0,u=u+Math.imul(y,Ce)|0,l=l+Math.imul(y,Ot)|0,l=l+Math.imul($,Ce)|0,R=R+Math.imul($,Ot)|0,u=u+Math.imul(D,tt)|0,l=l+Math.imul(D,bt)|0,l=l+Math.imul(L,tt)|0,R=R+Math.imul(L,bt)|0;var Ki=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Ki>>>26)|0,Ki&=67108863,u=Math.imul(Pe,ze),l=Math.imul(Pe,At),l=l+Math.imul(ot,ze)|0,R=Math.imul(ot,At),u=u+Math.imul(we,xe)|0,l=l+Math.imul(we,Ke)|0,l=l+Math.imul(We,xe)|0,R=R+Math.imul(We,Ke)|0,u=u+Math.imul(me,Ie)|0,l=l+Math.imul(me,Je)|0,l=l+Math.imul(Fe,Ie)|0,R=R+Math.imul(Fe,Je)|0,u=u+Math.imul(_e,Re)|0,l=l+Math.imul(_e,st)|0,l=l+Math.imul(je,Re)|0,R=R+Math.imul(je,st)|0,u=u+Math.imul(Me,Ne)|0,l=l+Math.imul(Me,Xe)|0,l=l+Math.imul(Ve,Ne)|0,R=R+Math.imul(Ve,Xe)|0,u=u+Math.imul(ve,Ee)|0,l=l+Math.imul(ve,Ue)|0,l=l+Math.imul(Te,Ee)|0,R=R+Math.imul(Te,Ue)|0,u=u+Math.imul(se,Ce)|0,l=l+Math.imul(se,Ot)|0,l=l+Math.imul(ae,Ce)|0,R=R+Math.imul(ae,Ot)|0,u=u+Math.imul(y,tt)|0,l=l+Math.imul(y,bt)|0,l=l+Math.imul($,tt)|0,R=R+Math.imul($,bt)|0;var Qr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Qr>>>26)|0,Qr&=67108863,u=Math.imul(Pe,xe),l=Math.imul(Pe,Ke),l=l+Math.imul(ot,xe)|0,R=Math.imul(ot,Ke),u=u+Math.imul(we,Ie)|0,l=l+Math.imul(we,Je)|0,l=l+Math.imul(We,Ie)|0,R=R+Math.imul(We,Je)|0,u=u+Math.imul(me,Re)|0,l=l+Math.imul(me,st)|0,l=l+Math.imul(Fe,Re)|0,R=R+Math.imul(Fe,st)|0,u=u+Math.imul(_e,Ne)|0,l=l+Math.imul(_e,Xe)|0,l=l+Math.imul(je,Ne)|0,R=R+Math.imul(je,Xe)|0,u=u+Math.imul(Me,Ee)|0,l=l+Math.imul(Me,Ue)|0,l=l+Math.imul(Ve,Ee)|0,R=R+Math.imul(Ve,Ue)|0,u=u+Math.imul(ve,Ce)|0,l=l+Math.imul(ve,Ot)|0,l=l+Math.imul(Te,Ce)|0,R=R+Math.imul(Te,Ot)|0,u=u+Math.imul(se,tt)|0,l=l+Math.imul(se,bt)|0,l=l+Math.imul(ae,tt)|0,R=R+Math.imul(ae,bt)|0;var _i=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(_i>>>26)|0,_i&=67108863,u=Math.imul(Pe,Ie),l=Math.imul(Pe,Je),l=l+Math.imul(ot,Ie)|0,R=Math.imul(ot,Je),u=u+Math.imul(we,Re)|0,l=l+Math.imul(we,st)|0,l=l+Math.imul(We,Re)|0,R=R+Math.imul(We,st)|0,u=u+Math.imul(me,Ne)|0,l=l+Math.imul(me,Xe)|0,l=l+Math.imul(Fe,Ne)|0,R=R+Math.imul(Fe,Xe)|0,u=u+Math.imul(_e,Ee)|0,l=l+Math.imul(_e,Ue)|0,l=l+Math.imul(je,Ee)|0,R=R+Math.imul(je,Ue)|0,u=u+Math.imul(Me,Ce)|0,l=l+Math.imul(Me,Ot)|0,l=l+Math.imul(Ve,Ce)|0,R=R+Math.imul(Ve,Ot)|0,u=u+Math.imul(ve,tt)|0,l=l+Math.imul(ve,bt)|0,l=l+Math.imul(Te,tt)|0,R=R+Math.imul(Te,bt)|0;var Ai=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Ai>>>26)|0,Ai&=67108863,u=Math.imul(Pe,Re),l=Math.imul(Pe,st),l=l+Math.imul(ot,Re)|0,R=Math.imul(ot,st),u=u+Math.imul(we,Ne)|0,l=l+Math.imul(we,Xe)|0,l=l+Math.imul(We,Ne)|0,R=R+Math.imul(We,Xe)|0,u=u+Math.imul(me,Ee)|0,l=l+Math.imul(me,Ue)|0,l=l+Math.imul(Fe,Ee)|0,R=R+Math.imul(Fe,Ue)|0,u=u+Math.imul(_e,Ce)|0,l=l+Math.imul(_e,Ot)|0,l=l+Math.imul(je,Ce)|0,R=R+Math.imul(je,Ot)|0,u=u+Math.imul(Me,tt)|0,l=l+Math.imul(Me,bt)|0,l=l+Math.imul(Ve,tt)|0,R=R+Math.imul(Ve,bt)|0;var hr=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(hr>>>26)|0,hr&=67108863,u=Math.imul(Pe,Ne),l=Math.imul(Pe,Xe),l=l+Math.imul(ot,Ne)|0,R=Math.imul(ot,Xe),u=u+Math.imul(we,Ee)|0,l=l+Math.imul(we,Ue)|0,l=l+Math.imul(We,Ee)|0,R=R+Math.imul(We,Ue)|0,u=u+Math.imul(me,Ce)|0,l=l+Math.imul(me,Ot)|0,l=l+Math.imul(Fe,Ce)|0,R=R+Math.imul(Fe,Ot)|0,u=u+Math.imul(_e,tt)|0,l=l+Math.imul(_e,bt)|0,l=l+Math.imul(je,tt)|0,R=R+Math.imul(je,bt)|0;var Hi=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,u=Math.imul(Pe,Ee),l=Math.imul(Pe,Ue),l=l+Math.imul(ot,Ee)|0,R=Math.imul(ot,Ue),u=u+Math.imul(we,Ce)|0,l=l+Math.imul(we,Ot)|0,l=l+Math.imul(We,Ce)|0,R=R+Math.imul(We,Ot)|0,u=u+Math.imul(me,tt)|0,l=l+Math.imul(me,bt)|0,l=l+Math.imul(Fe,tt)|0,R=R+Math.imul(Fe,bt)|0;var Vi=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,u=Math.imul(Pe,Ce),l=Math.imul(Pe,Ot),l=l+Math.imul(ot,Ce)|0,R=Math.imul(ot,Ot),u=u+Math.imul(we,tt)|0,l=l+Math.imul(we,bt)|0,l=l+Math.imul(We,tt)|0,R=R+Math.imul(We,bt)|0;var Gi=(x+u|0)+((l&8191)<<13)|0;x=(R+(l>>>13)|0)+(Gi>>>26)|0,Gi&=67108863,u=Math.imul(Pe,tt),l=Math.imul(Pe,bt),l=l+Math.imul(ot,tt)|0,R=Math.imul(ot,bt);var Cs=(x+u|0)+((l&8191)<<13)|0;return x=(R+(l>>>13)|0)+(Cs>>>26)|0,Cs&=67108863,S[0]=Rr,S[1]=Nr,S[2]=Cr,S[3]=Or,S[4]=Tr,S[5]=Yt,S[6]=Jr,S[7]=ji,S[8]=Wr,S[9]=Fi,S[10]=Ki,S[11]=Qr,S[12]=_i,S[13]=Ai,S[14]=hr,S[15]=Hi,S[16]=Vi,S[17]=Gi,S[18]=Cs,x!==0&&(S[19]=x,g.length++),g};Math.imul||(Z=J);function de(c,d,g){g.negative=d.negative^c.negative,g.length=c.length+d.length;for(var A=0,M=0,S=0;S<g.length-1;S++){var x=M;M=0;for(var u=A&67108863,l=Math.min(S,d.length-1),R=Math.max(0,S-c.length+1);R<=l;R++){var X=S-R,ee=c.words[X]|0,E=d.words[R]|0,W=ee*E,D=W&67108863;x=x+(W/67108864|0)|0,D=D+u|0,u=D&67108863,x=x+(D>>>26)|0,M+=x>>>26,x&=67108863}g.words[S]=u,A=x,x=M}return A!==0?g.words[S]=A:g.length--,g._strip()}function oe(c,d,g){return de(c,d,g)}a.prototype.mulTo=function(c,d){var g,A=this.length+c.length;return this.length===10&&c.length===10?g=Z(this,c,d):A<63?g=J(this,c,d):A<1024?g=de(this,c,d):g=oe(this,c,d),g},a.prototype.mul=function(c){var d=new a(null);return d.words=new Array(this.length+c.length),this.mulTo(c,d)},a.prototype.mulf=function(c){var d=new a(null);return d.words=new Array(this.length+c.length),oe(this,c,d)},a.prototype.imul=function(c){return this.clone().mulTo(c,this)},a.prototype.imuln=function(c){var d=c<0;d&&(c=-c),i(typeof c=="number"),i(c<67108864);for(var g=0,A=0;A<this.length;A++){var M=(this.words[A]|0)*c,S=(M&67108863)+(g&67108863);g>>=26,g+=M/67108864|0,g+=S>>>26,this.words[A]=S&67108863}return g!==0&&(this.words[A]=g,this.length++),d?this.ineg():this},a.prototype.muln=function(c){return this.clone().imuln(c)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(c){var d=K(c);if(d.length===0)return new a(1);for(var g=this,A=0;A<d.length&&d[A]===0;A++,g=g.sqr());if(++A<d.length)for(var M=g.sqr();A<d.length;A++,M=M.sqr())d[A]!==0&&(g=g.mul(M));return g},a.prototype.iushln=function(c){i(typeof c=="number"&&c>=0);var d=c%26,g=(c-d)/26,A=67108863>>>26-d<<26-d,M;if(d!==0){var S=0;for(M=0;M<this.length;M++){var x=this.words[M]&A,u=(this.words[M]|0)-x<<d;this.words[M]=u|S,S=x>>>26-d}S&&(this.words[M]=S,this.length++)}if(g!==0){for(M=this.length-1;M>=0;M--)this.words[M+g]=this.words[M];for(M=0;M<g;M++)this.words[M]=0;this.length+=g}return this._strip()},a.prototype.ishln=function(c){return i(this.negative===0),this.iushln(c)},a.prototype.iushrn=function(c,d,g){i(typeof c=="number"&&c>=0);var A;d?A=(d-d%26)/26:A=0;var M=c%26,S=Math.min((c-M)/26,this.length),x=67108863^67108863>>>M<<M,u=g;if(A-=S,A=Math.max(0,A),u){for(var l=0;l<S;l++)u.words[l]=this.words[l];u.length=S}if(S!==0)if(this.length>S)for(this.length-=S,l=0;l<this.length;l++)this.words[l]=this.words[l+S];else this.words[0]=0,this.length=1;var R=0;for(l=this.length-1;l>=0&&(R!==0||l>=A);l--){var X=this.words[l]|0;this.words[l]=R<<26-M|X>>>M,R=X&x}return u&&R!==0&&(u.words[u.length++]=R),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(c,d,g){return i(this.negative===0),this.iushrn(c,d,g)},a.prototype.shln=function(c){return this.clone().ishln(c)},a.prototype.ushln=function(c){return this.clone().iushln(c)},a.prototype.shrn=function(c){return this.clone().ishrn(c)},a.prototype.ushrn=function(c){return this.clone().iushrn(c)},a.prototype.testn=function(c){i(typeof c=="number"&&c>=0);var d=c%26,g=(c-d)/26,A=1<<d;if(this.length<=g)return!1;var M=this.words[g];return!!(M&A)},a.prototype.imaskn=function(c){i(typeof c=="number"&&c>=0);var d=c%26,g=(c-d)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=g)return this;if(d!==0&&g++,this.length=Math.min(g,this.length),d!==0){var A=67108863^67108863>>>d<<d;this.words[this.length-1]&=A}return this._strip()},a.prototype.maskn=function(c){return this.clone().imaskn(c)},a.prototype.iaddn=function(c){return i(typeof c=="number"),i(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<=c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},a.prototype._iaddn=function(c){this.words[0]+=c;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},a.prototype.isubn=function(c){if(i(typeof c=="number"),i(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this._strip()},a.prototype.addn=function(c){return this.clone().iaddn(c)},a.prototype.subn=function(c){return this.clone().isubn(c)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(c,d,g){var A=c.length+g,M;this._expand(A);var S,x=0;for(M=0;M<c.length;M++){S=(this.words[M+g]|0)+x;var u=(c.words[M]|0)*d;S-=u&67108863,x=(S>>26)-(u/67108864|0),this.words[M+g]=S&67108863}for(;M<this.length-g;M++)S=(this.words[M+g]|0)+x,x=S>>26,this.words[M+g]=S&67108863;if(x===0)return this._strip();for(i(x===-1),x=0,M=0;M<this.length;M++)S=-(this.words[M]|0)+x,x=S>>26,this.words[M]=S&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(c,d){var g=this.length-c.length,A=this.clone(),M=c,S=M.words[M.length-1]|0,x=this._countBits(S);g=26-x,g!==0&&(M=M.ushln(g),A.iushln(g),S=M.words[M.length-1]|0);var u=A.length-M.length,l;if(d!=="mod"){l=new a(null),l.length=u+1,l.words=new Array(l.length);for(var R=0;R<l.length;R++)l.words[R]=0}var X=A.clone()._ishlnsubmul(M,1,u);X.negative===0&&(A=X,l&&(l.words[u]=1));for(var ee=u-1;ee>=0;ee--){var E=(A.words[M.length+ee]|0)*67108864+(A.words[M.length+ee-1]|0);for(E=Math.min(E/S|0,67108863),A._ishlnsubmul(M,E,ee);A.negative!==0;)E--,A.negative=0,A._ishlnsubmul(M,1,ee),A.isZero()||(A.negative^=1);l&&(l.words[ee]=E)}return l&&l._strip(),A._strip(),d!=="div"&&g!==0&&A.iushrn(g),{div:l||null,mod:A}},a.prototype.divmod=function(c,d,g){if(i(!c.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var A,M,S;return this.negative!==0&&c.negative===0?(S=this.neg().divmod(c,d),d!=="mod"&&(A=S.div.neg()),d!=="div"&&(M=S.mod.neg(),g&&M.negative!==0&&M.iadd(c)),{div:A,mod:M}):this.negative===0&&c.negative!==0?(S=this.divmod(c.neg(),d),d!=="mod"&&(A=S.div.neg()),{div:A,mod:S.mod}):this.negative&c.negative?(S=this.neg().divmod(c.neg(),d),d!=="div"&&(M=S.mod.neg(),g&&M.negative!==0&&M.isub(c)),{div:S.div,mod:M}):c.length>this.length||this.cmp(c)<0?{div:new a(0),mod:this}:c.length===1?d==="div"?{div:this.divn(c.words[0]),mod:null}:d==="mod"?{div:null,mod:new a(this.modrn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new a(this.modrn(c.words[0]))}:this._wordDiv(c,d)},a.prototype.div=function(c){return this.divmod(c,"div",!1).div},a.prototype.mod=function(c){return this.divmod(c,"mod",!1).mod},a.prototype.umod=function(c){return this.divmod(c,"mod",!0).mod},a.prototype.divRound=function(c){var d=this.divmod(c);if(d.mod.isZero())return d.div;var g=d.div.negative!==0?d.mod.isub(c):d.mod,A=c.ushrn(1),M=c.andln(1),S=g.cmp(A);return S<0||M===1&&S===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},a.prototype.modrn=function(c){var d=c<0;d&&(c=-c),i(c<=67108863);for(var g=(1<<26)%c,A=0,M=this.length-1;M>=0;M--)A=(g*A+(this.words[M]|0))%c;return d?-A:A},a.prototype.modn=function(c){return this.modrn(c)},a.prototype.idivn=function(c){var d=c<0;d&&(c=-c),i(c<=67108863);for(var g=0,A=this.length-1;A>=0;A--){var M=(this.words[A]|0)+g*67108864;this.words[A]=M/c|0,g=M%c}return this._strip(),d?this.ineg():this},a.prototype.divn=function(c){return this.clone().idivn(c)},a.prototype.egcd=function(c){i(c.negative===0),i(!c.isZero());var d=this,g=c.clone();d.negative!==0?d=d.umod(c):d=d.clone();for(var A=new a(1),M=new a(0),S=new a(0),x=new a(1),u=0;d.isEven()&&g.isEven();)d.iushrn(1),g.iushrn(1),++u;for(var l=g.clone(),R=d.clone();!d.isZero();){for(var X=0,ee=1;!(d.words[0]&ee)&&X<26;++X,ee<<=1);if(X>0)for(d.iushrn(X);X-- >0;)(A.isOdd()||M.isOdd())&&(A.iadd(l),M.isub(R)),A.iushrn(1),M.iushrn(1);for(var E=0,W=1;!(g.words[0]&W)&&E<26;++E,W<<=1);if(E>0)for(g.iushrn(E);E-- >0;)(S.isOdd()||x.isOdd())&&(S.iadd(l),x.isub(R)),S.iushrn(1),x.iushrn(1);d.cmp(g)>=0?(d.isub(g),A.isub(S),M.isub(x)):(g.isub(d),S.isub(A),x.isub(M))}return{a:S,b:x,gcd:g.iushln(u)}},a.prototype._invmp=function(c){i(c.negative===0),i(!c.isZero());var d=this,g=c.clone();d.negative!==0?d=d.umod(c):d=d.clone();for(var A=new a(1),M=new a(0),S=g.clone();d.cmpn(1)>0&&g.cmpn(1)>0;){for(var x=0,u=1;!(d.words[0]&u)&&x<26;++x,u<<=1);if(x>0)for(d.iushrn(x);x-- >0;)A.isOdd()&&A.iadd(S),A.iushrn(1);for(var l=0,R=1;!(g.words[0]&R)&&l<26;++l,R<<=1);if(l>0)for(g.iushrn(l);l-- >0;)M.isOdd()&&M.iadd(S),M.iushrn(1);d.cmp(g)>=0?(d.isub(g),A.isub(M)):(g.isub(d),M.isub(A))}var X;return d.cmpn(1)===0?X=A:X=M,X.cmpn(0)<0&&X.iadd(c),X},a.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var d=this.clone(),g=c.clone();d.negative=0,g.negative=0;for(var A=0;d.isEven()&&g.isEven();A++)d.iushrn(1),g.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;g.isEven();)g.iushrn(1);var M=d.cmp(g);if(M<0){var S=d;d=g,g=S}else if(M===0||g.cmpn(1)===0)break;d.isub(g)}while(!0);return g.iushln(A)},a.prototype.invm=function(c){return this.egcd(c).a.umod(c)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(c){return this.words[0]&c},a.prototype.bincn=function(c){i(typeof c=="number");var d=c%26,g=(c-d)/26,A=1<<d;if(this.length<=g)return this._expand(g+1),this.words[g]|=A,this;for(var M=A,S=g;M!==0&&S<this.length;S++){var x=this.words[S]|0;x+=M,M=x>>>26,x&=67108863,this.words[S]=x}return M!==0&&(this.words[S]=M,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(c){var d=c<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this._strip();var g;if(this.length>1)g=1;else{d&&(c=-c),i(c<=67108863,"Number is too big");var A=this.words[0]|0;g=A===c?0:A<c?-1:1}return this.negative!==0?-g|0:g},a.prototype.cmp=function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var d=this.ucmp(c);return this.negative!==0?-d|0:d},a.prototype.ucmp=function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var d=0,g=this.length-1;g>=0;g--){var A=this.words[g]|0,M=c.words[g]|0;if(A!==M){A<M?d=-1:A>M&&(d=1);break}}return d},a.prototype.gtn=function(c){return this.cmpn(c)===1},a.prototype.gt=function(c){return this.cmp(c)===1},a.prototype.gten=function(c){return this.cmpn(c)>=0},a.prototype.gte=function(c){return this.cmp(c)>=0},a.prototype.ltn=function(c){return this.cmpn(c)===-1},a.prototype.lt=function(c){return this.cmp(c)===-1},a.prototype.lten=function(c){return this.cmpn(c)<=0},a.prototype.lte=function(c){return this.cmp(c)<=0},a.prototype.eqn=function(c){return this.cmpn(c)===0},a.prototype.eq=function(c){return this.cmp(c)===0},a.red=function(c){return new k(c)},a.prototype.toRed=function(c){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(c){return this.red=c,this},a.prototype.forceRed=function(c){return i(!this.red,"Already a number in reduction context"),this._forceRed(c)},a.prototype.redAdd=function(c){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},a.prototype.redIAdd=function(c){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},a.prototype.redSub=function(c){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},a.prototype.redISub=function(c){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},a.prototype.redShl=function(c){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},a.prototype.redMul=function(c){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},a.prototype.redIMul=function(c){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(c){return i(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)};var re={k256:null,p224:null,p192:null,p25519:null};function fe(c,d){this.name=c,this.p=new a(d,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}fe.prototype._tmp=function(){var c=new a(null);return c.words=new Array(Math.ceil(this.n/13)),c},fe.prototype.ireduce=function(c){var d=c,g;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),g=d.bitLength();while(g>this.n);var A=g<this.n?-1:d.ucmp(this.p);return A===0?(d.words[0]=0,d.length=1):A>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},fe.prototype.split=function(c,d){c.iushrn(this.n,0,d)},fe.prototype.imulK=function(c){return c.imul(this.k)};function ue(){fe.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(ue,fe),ue.prototype.split=function(c,d){for(var g=4194303,A=Math.min(c.length,9),M=0;M<A;M++)d.words[M]=c.words[M];if(d.length=A,c.length<=9){c.words[0]=0,c.length=1;return}var S=c.words[9];for(d.words[d.length++]=S&g,M=10;M<c.length;M++){var x=c.words[M]|0;c.words[M-10]=(x&g)<<4|S>>>22,S=x}S>>>=22,c.words[M-10]=S,S===0&&c.length>10?c.length-=10:c.length-=9},ue.prototype.imulK=function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var d=0,g=0;g<c.length;g++){var A=c.words[g]|0;d+=A*977,c.words[g]=d&67108863,d=A*64+(d/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c};function le(){fe.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(le,fe);function Ae(){fe.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(Ae,fe);function ht(){fe.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(ht,fe),ht.prototype.imulK=function(c){for(var d=0,g=0;g<c.length;g++){var A=(c.words[g]|0)*19+d,M=A&67108863;A>>>=26,c.words[g]=M,d=A}return d!==0&&(c.words[c.length++]=d),c},a._prime=function(c){if(re[c])return re[c];var d;if(c==="k256")d=new ue;else if(c==="p224")d=new le;else if(c==="p192")d=new Ae;else if(c==="p25519")d=new ht;else throw new Error("Unknown prime "+c);return re[c]=d,d};function k(c){if(typeof c=="string"){var d=a._prime(c);this.m=d.p,this.prime=d}else i(c.gtn(1),"modulus must be greater than 1"),this.m=c,this.prime=null}k.prototype._verify1=function(c){i(c.negative===0,"red works only with positives"),i(c.red,"red works only with red numbers")},k.prototype._verify2=function(c,d){i((c.negative|d.negative)===0,"red works only with positives"),i(c.red&&c.red===d.red,"red works only with red numbers")},k.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):(_(c,c.umod(this.m)._forceRed(this)),c)},k.prototype.neg=function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},k.prototype.add=function(c,d){this._verify2(c,d);var g=c.add(d);return g.cmp(this.m)>=0&&g.isub(this.m),g._forceRed(this)},k.prototype.iadd=function(c,d){this._verify2(c,d);var g=c.iadd(d);return g.cmp(this.m)>=0&&g.isub(this.m),g},k.prototype.sub=function(c,d){this._verify2(c,d);var g=c.sub(d);return g.cmpn(0)<0&&g.iadd(this.m),g._forceRed(this)},k.prototype.isub=function(c,d){this._verify2(c,d);var g=c.isub(d);return g.cmpn(0)<0&&g.iadd(this.m),g},k.prototype.shl=function(c,d){return this._verify1(c),this.imod(c.ushln(d))},k.prototype.imul=function(c,d){return this._verify2(c,d),this.imod(c.imul(d))},k.prototype.mul=function(c,d){return this._verify2(c,d),this.imod(c.mul(d))},k.prototype.isqr=function(c){return this.imul(c,c.clone())},k.prototype.sqr=function(c){return this.mul(c,c)},k.prototype.sqrt=function(c){if(c.isZero())return c.clone();var d=this.m.andln(3);if(i(d%2===1),d===3){var g=this.m.add(new a(1)).iushrn(2);return this.pow(c,g)}for(var A=this.m.subn(1),M=0;!A.isZero()&&A.andln(1)===0;)M++,A.iushrn(1);i(!A.isZero());var S=new a(1).toRed(this),x=S.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new a(2*l*l).toRed(this);this.pow(l,u).cmp(x)!==0;)l.redIAdd(x);for(var R=this.pow(l,A),X=this.pow(c,A.addn(1).iushrn(1)),ee=this.pow(c,A),E=M;ee.cmp(S)!==0;){for(var W=ee,D=0;W.cmp(S)!==0;D++)W=W.redSqr();i(D<E);var L=this.pow(R,new a(1).iushln(E-D-1));X=X.redMul(L),R=L.redSqr(),ee=ee.redMul(R),E=D}return X},k.prototype.invm=function(c){var d=c._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},k.prototype.pow=function(c,d){if(d.isZero())return new a(1).toRed(this);if(d.cmpn(1)===0)return c.clone();var g=4,A=new Array(1<<g);A[0]=new a(1).toRed(this),A[1]=c;for(var M=2;M<A.length;M++)A[M]=this.mul(A[M-1],c);var S=A[0],x=0,u=0,l=d.bitLength()%26;for(l===0&&(l=26),M=d.length-1;M>=0;M--){for(var R=d.words[M],X=l-1;X>=0;X--){var ee=R>>X&1;if(S!==A[0]&&(S=this.sqr(S)),ee===0&&x===0){u=0;continue}x<<=1,x|=ee,u++,!(u!==g&&(M!==0||X!==0))&&(S=this.mul(S,A[x]),u=0,x=0)}l=26}return S},k.prototype.convertTo=function(c){var d=c.umod(this.m);return d===c?d.clone():d},k.prototype.convertFrom=function(c){var d=c.clone();return d.red=null,d},a.mont=function(c){return new b(c)};function b(c){k.call(this,c),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(b,k),b.prototype.convertTo=function(c){return this.imod(c.ushln(this.shift))},b.prototype.convertFrom=function(c){var d=this.imod(c.mul(this.rinv));return d.red=null,d},b.prototype.imul=function(c,d){if(c.isZero()||d.isZero())return c.words[0]=0,c.length=1,c;var g=c.imul(d),A=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=g.isub(A).iushrn(this.shift),S=M;return M.cmp(this.m)>=0?S=M.isub(this.m):M.cmpn(0)<0&&(S=M.iadd(this.m)),S._forceRed(this)},b.prototype.mul=function(c,d){if(c.isZero()||d.isZero())return new a(0)._forceRed(this);var g=c.mul(d),A=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=g.isub(A).iushrn(this.shift),S=M;return M.cmp(this.m)>=0?S=M.isub(this.m):M.cmpn(0)<0&&(S=M.iadd(this.m)),S._forceRed(this)},b.prototype.invm=function(c){var d=this.imod(c._invmp(this.m).mul(this.r2));return d._forceRed(this)}})(r,dv)})(vv);var vt=vv.exports;const bv="bignumber/5.7.0";var Kh=vt.BN;const es=new Mr(bv),zu={},Wp=9007199254740991;function f_(r){return r!=null&&(Vr.isBigNumber(r)||typeof r=="number"&&r%1===0||typeof r=="string"&&!!r.match(/^-?[0-9]+$/)||mi(r)||typeof r=="bigint"||eo(r))}let Qp=!1,Vr=class sn{constructor(e,t){e!==zu&&es.throwError("cannot call constructor directly; use BigNumber.from",Mr.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return ri(St(this).fromTwos(e))}toTwos(e){return ri(St(this).toTwos(e))}abs(){return this._hex[0]==="-"?sn.from(this._hex.substring(1)):this}add(e){return ri(St(this).add(St(e)))}sub(e){return ri(St(this).sub(St(e)))}div(e){return sn.from(e).isZero()&&Ci("division-by-zero","div"),ri(St(this).div(St(e)))}mul(e){return ri(St(this).mul(St(e)))}mod(e){const t=St(e);return t.isNeg()&&Ci("division-by-zero","mod"),ri(St(this).umod(t))}pow(e){const t=St(e);return t.isNeg()&&Ci("negative-power","pow"),ri(St(this).pow(t))}and(e){const t=St(e);return(this.isNegative()||t.isNeg())&&Ci("unbound-bitwise-result","and"),ri(St(this).and(t))}or(e){const t=St(e);return(this.isNegative()||t.isNeg())&&Ci("unbound-bitwise-result","or"),ri(St(this).or(t))}xor(e){const t=St(e);return(this.isNegative()||t.isNeg())&&Ci("unbound-bitwise-result","xor"),ri(St(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&Ci("negative-width","mask"),ri(St(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&Ci("negative-width","shl"),ri(St(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&Ci("negative-width","shr"),ri(St(this).shrn(e))}eq(e){return St(this).eq(St(e))}lt(e){return St(this).lt(St(e))}lte(e){return St(this).lte(St(e))}gt(e){return St(this).gt(St(e))}gte(e){return St(this).gte(St(e))}isNegative(){return this._hex[0]==="-"}isZero(){return St(this).isZero()}toNumber(){try{return St(this).toNumber()}catch{Ci("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return es.throwError("this platform does not support BigInt",Mr.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?Qp||(Qp=!0,es.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?es.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Mr.errors.UNEXPECTED_ARGUMENT,{}):es.throwError("BigNumber.toString does not accept parameters",Mr.errors.UNEXPECTED_ARGUMENT,{})),St(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof sn)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new sn(zu,Qo(e)):e.match(/^-?[0-9]+$/)?new sn(zu,Qo(new Kh(e))):es.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&Ci("underflow","BigNumber.from",e),(e>=Wp||e<=-Wp)&&Ci("overflow","BigNumber.from",e),sn.from(String(e));const t=e;if(typeof t=="bigint")return sn.from(t.toString());if(eo(t))return sn.from(si(t));if(t)if(t.toHexString){const i=t.toHexString();if(typeof i=="string")return sn.from(i)}else{let i=t._hex;if(i==null&&t.type==="BigNumber"&&(i=t.hex),typeof i=="string"&&(mi(i)||i[0]==="-"&&mi(i.substring(1))))return sn.from(i)}return es.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}};function Qo(r){if(typeof r!="string")return Qo(r.toString(16));if(r[0]==="-")return r=r.substring(1),r[0]==="-"&&es.throwArgumentError("invalid hex","value",r),r=Qo(r),r==="0x00"?r:"-"+r;if(r.substring(0,2)!=="0x"&&(r="0x"+r),r==="0x")return"0x00";for(r.length%2&&(r="0x0"+r.substring(2));r.length>4&&r.substring(0,4)==="0x00";)r="0x"+r.substring(4);return r}function ri(r){return Vr.from(Qo(r))}function St(r){const e=Vr.from(r).toHexString();return e[0]==="-"?new Kh("-"+e.substring(3),16):new Kh(e.substring(2),16)}function Ci(r,e,t){const i={fault:r,operation:e};return t!=null&&(i.value=t),es.throwError(r,Mr.errors.NUMERIC_FAULT,i)}function u_(r){return new Kh(r,36).toString(16)}const Kr=new Mr(bv),Ho={},mv=Vr.from(0),yv=Vr.from(-1);function wv(r,e,t,i){const s={fault:e,operation:t};return i!==void 0&&(s.value=i),Kr.throwError(r,Mr.errors.NUMERIC_FAULT,s)}let Vo="0";for(;Vo.length<256;)Vo+=Vo;function jd(r){if(typeof r!="number")try{r=Vr.from(r).toNumber()}catch{}return typeof r=="number"&&r>=0&&r<=256&&!(r%1)?"1"+Vo.substring(0,r):Kr.throwArgumentError("invalid decimal size","decimals",r)}function Uu(r,e){e==null&&(e=0);const t=jd(e);r=Vr.from(r);const i=r.lt(mv);i&&(r=r.mul(yv));let s=r.mod(t).toString();for(;s.length<t.length-1;)s="0"+s;s=s.match(/^([0-9]*[1-9]|0)(0*)/)[1];const a=r.div(t).toString();return t.length===1?r=a:r=a+"."+s,i&&(r="-"+r),r}function Xn(r,e){e==null&&(e=0);const t=jd(e);(typeof r!="string"||!r.match(/^-?[0-9.]+$/))&&Kr.throwArgumentError("invalid decimal value","value",r);const i=r.substring(0,1)==="-";i&&(r=r.substring(1)),r==="."&&Kr.throwArgumentError("missing value","value",r);const s=r.split(".");s.length>2&&Kr.throwArgumentError("too many decimal points","value",r);let a=s[0],h=s[1];for(a||(a="0"),h||(h="0");h[h.length-1]==="0";)h=h.substring(0,h.length-1);for(h.length>t.length-1&&wv("fractional component exceeds decimals","underflow","parseFixed"),h===""&&(h="0");h.length<t.length-1;)h+="0";const p=Vr.from(a),m=Vr.from(h);let v=p.mul(t).add(m);return i&&(v=v.mul(yv)),v}let ju=class vd{constructor(e,t,i,s){e!==Ho&&Kr.throwError("cannot use FixedFormat constructor; use FixedFormat.from",Mr.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=t,this.width=i,this.decimals=s,this.name=(t?"":"u")+"fixed"+String(i)+"x"+String(s),this._multiplier=jd(s),Object.freeze(this)}static from(e){if(e instanceof vd)return e;typeof e=="number"&&(e=`fixed128x${e}`);let t=!0,i=128,s=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")t=!1;else{const a=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);a||Kr.throwArgumentError("invalid fixed format","format",e),t=a[1]!=="u",i=parseInt(a[2]),s=parseInt(a[3])}}else if(e){const a=(h,p,m)=>e[h]==null?m:(typeof e[h]!==p&&Kr.throwArgumentError("invalid fixed format ("+h+" not "+p+")","format."+h,e[h]),e[h]);t=a("signed","boolean",t),i=a("width","number",i),s=a("decimals","number",s)}return i%8&&Kr.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",i),s>80&&Kr.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",s),new vd(Ho,t,i,s)}},_v=class jr{constructor(e,t,i,s){e!==Ho&&Kr.throwError("cannot use FixedNumber constructor; use FixedNumber.from",Mr.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=s,this._hex=t,this._value=i,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&Kr.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const t=Xn(this._value,this.format.decimals),i=Xn(e._value,e.format.decimals);return jr.fromValue(t.add(i),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const t=Xn(this._value,this.format.decimals),i=Xn(e._value,e.format.decimals);return jr.fromValue(t.sub(i),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const t=Xn(this._value,this.format.decimals),i=Xn(e._value,e.format.decimals);return jr.fromValue(t.mul(i).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const t=Xn(this._value,this.format.decimals),i=Xn(e._value,e.format.decimals);return jr.fromValue(t.mul(this.format._multiplier).div(i),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=jr.from(e[0],this.format);const i=!e[1].match(/^(0*)$/);return this.isNegative()&&i&&(t=t.subUnsafe(Yp.toFormat(t.format))),t}ceiling(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=jr.from(e[0],this.format);const i=!e[1].match(/^(0*)$/);return!this.isNegative()&&i&&(t=t.addUnsafe(Yp.toFormat(t.format))),t}round(e){e==null&&(e=0);const t=this.toString().split(".");if(t.length===1&&t.push("0"),(e<0||e>80||e%1)&&Kr.throwArgumentError("invalid decimal count","decimals",e),t[1].length<=e)return this;const i=jr.from("1"+Vo.substring(0,e),this.format),s=d_.toFormat(this.format);return this.mulUnsafe(i).addUnsafe(s).floor().divUnsafe(i)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(e){if(e==null)return this._hex;e%8&&Kr.throwArgumentError("invalid byte width","width",e);const t=Vr.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return Rn(t,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return jr.fromString(this._value,e)}static fromValue(e,t,i){return i==null&&t!=null&&!f_(t)&&(i=t,t=null),t==null&&(t=0),i==null&&(i="fixed"),jr.fromString(Uu(e,t),ju.from(i))}static fromString(e,t){t==null&&(t="fixed");const i=ju.from(t),s=Xn(e,i.decimals);!i.signed&&s.lt(mv)&&wv("unsigned value cannot be negative","overflow","value",e);let a=null;i.signed?a=s.toTwos(i.width).toHexString():(a=s.toHexString(),a=Rn(a,i.width/8));const h=Uu(s,i.decimals);return new jr(Ho,a,h,i)}static fromBytes(e,t){t==null&&(t="fixed");const i=ju.from(t);if(er(e).length>i.width/8)throw new Error("overflow");let s=Vr.from(e);i.signed&&(s=s.fromTwos(i.width));const a=s.toTwos((i.signed?0:1)+i.width).toHexString(),h=Uu(s,i.decimals);return new jr(Ho,a,h,i)}static from(e,t){if(typeof e=="string")return jr.fromString(e,t);if(eo(e))return jr.fromBytes(e,t);try{return jr.fromValue(e,0,t)}catch(i){if(i.code!==Mr.errors.INVALID_ARGUMENT)throw i}return Kr.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!!(e&&e._isFixedNumber)}};const Yp=_v.from(1),d_=_v.from("0.5"),l_="strings/5.7.0",p_=new Mr(l_);var Hh;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(Hh||(Hh={}));var Xp;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(Xp||(Xp={}));function Fu(r,e=Hh.current){e!=Hh.current&&(p_.checkNormalize(),r=r.normalize(e));let t=[];for(let i=0;i<r.length;i++){const s=r.charCodeAt(i);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){i++;const a=r.charCodeAt(i);if(i>=r.length||(a&64512)!==56320)throw new Error("invalid utf-8 string");const h=65536+((s&1023)<<10)+(a&1023);t.push(h>>18|240),t.push(h>>12&63|128),t.push(h>>6&63|128),t.push(h&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return er(t)}function g_(r){if(r.length%4!==0)throw new Error("bad data");let e=[];for(let t=0;t<r.length;t+=4)e.push(parseInt(r.substring(t,t+4),16));return e}function Ku(r,e){e||(e=function(s){return[parseInt(s,16)]});let t=0,i={};return r.split(",").forEach(s=>{let a=s.split(":");t+=parseInt(a[0],16),i[t]=e(a[1])}),i}function Zp(r){let e=0;return r.split(",").map(t=>{let i=t.split("-");i.length===1?i[1]="0":i[1]===""&&(i[1]="1");let s=e+parseInt(i[0],16);return e=parseInt(i[1],16),{l:s,h:e}})}Zp("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),"ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(r=>parseInt(r,16)),Ku("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),Ku("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),Ku("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",g_),Zp("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function v_(r){r=atob(r);const e=[];for(let t=0;t<r.length;t++)e.push(r.charCodeAt(t));return er(e)}function Av(r,e){e==null&&(e=1);const t=[],i=t.forEach,s=function(a,h){i.call(a,function(p){h>0&&Array.isArray(p)?s(p,h-1):t.push(p)})};return s(r,e),t}function b_(r){const e={};for(let t=0;t<r.length;t++){const i=r[t];e[i[0]]=i[1]}return e}function m_(r){let e=0;function t(){return r[e++]<<8|r[e++]}let i=t(),s=1,a=[0,1];for(let re=1;re<i;re++)a.push(s+=t());let h=t(),p=e;e+=h;let m=0,v=0;function _(){return m==0&&(v=v<<8|r[e++],m=8),v>>--m&1}const I=31,N=Math.pow(2,I),O=N>>>1,q=O>>1,j=N-1;let K=0;for(let re=0;re<I;re++)K=K<<1|_();let J=[],Z=0,de=N;for(;;){let re=Math.floor(((K-Z+1)*s-1)/de),fe=0,ue=i;for(;ue-fe>1;){let ht=fe+ue>>>1;re<a[ht]?ue=ht:fe=ht}if(fe==0)break;J.push(fe);let le=Z+Math.floor(de*a[fe]/s),Ae=Z+Math.floor(de*a[fe+1]/s)-1;for(;!((le^Ae)&O);)K=K<<1&j|_(),le=le<<1&j,Ae=Ae<<1&j|1;for(;le&~Ae&q;)K=K&O|K<<1&j>>>1|_(),le=le<<1^O,Ae=(Ae^O)<<1|O|1;Z=le,de=1+Ae-le}let oe=i-4;return J.map(re=>{switch(re-oe){case 3:return oe+65792+(r[p++]<<16|r[p++]<<8|r[p++]);case 2:return oe+256+(r[p++]<<8|r[p++]);case 1:return oe+r[p++];default:return re-1}})}function y_(r){let e=0;return()=>r[e++]}function w_(r){return y_(m_(r))}function __(r){return r&1?~r>>1:r>>1}function A_(r,e){let t=Array(r);for(let i=0;i<r;i++)t[i]=1+e();return t}function e1(r,e){let t=Array(r);for(let i=0,s=-1;i<r;i++)t[i]=s+=1+e();return t}function x_(r,e){let t=Array(r);for(let i=0,s=0;i<r;i++)t[i]=s+=__(e());return t}function Vh(r,e){let t=e1(r(),r),i=r(),s=e1(i,r),a=A_(i,r);for(let h=0;h<i;h++)for(let p=0;p<a[h];p++)t.push(s[h]+p);return e?t.map(h=>e[h]):t}function I_(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(M_(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(S_(t,r))}return b_(Av(e))}function E_(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(t)}return e}function xv(r,e,t){let i=Array(r).fill(void 0).map(()=>[]);for(let s=0;s<e;s++)x_(r,t).forEach((a,h)=>i[h].push(a));return i}function M_(r,e){let t=1+e(),i=e(),s=E_(e),a=xv(s.length,1+r,e);return Av(a.map((h,p)=>{const m=h[0],v=h.slice(1);return Array(s[p]).fill(void 0).map((_,I)=>{let N=I*i;return[m+I*t,v.map(O=>O+N)]})}))}function S_(r,e){let t=1+e();return xv(t,1+r,e).map(i=>[i[0],i.slice(1)])}function P_(r){let e=Vh(r).sort((i,s)=>i-s);return t();function t(){let i=[];for(;;){let v=Vh(r,e);if(v.length==0)break;i.push({set:new Set(v),node:t()})}i.sort((v,_)=>_.set.size-v.set.size);let s=r(),a=s%3;s=s/3|0;let h=!!(s&1);s>>=1;let p=s==1,m=s==2;return{branches:i,valid:a,fe0f:h,save:p,check:m}}}function R_(){return w_(v_("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const vh=R_();new Set(Vh(vh)),new Set(Vh(vh)),I_(vh),P_(vh);const N_=new Uint8Array(32);N_.fill(0);const C_=`Ethereum Signed Message:
`;function Iv(r){return typeof r=="string"&&(r=Fu(r)),Ud(n_([Fu(C_),Fu(String(r.length)),r]))}const O_="address/5.7.0",zo=new Mr(O_);function t1(r){mi(r,20)||zo.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const i=er(Ud(t));for(let s=0;s<40;s+=2)i[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(i[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const T_=9007199254740991;function q_(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Fd={};for(let r=0;r<10;r++)Fd[String(r)]=String(r);for(let r=0;r<26;r++)Fd[String.fromCharCode(65+r)]=String(10+r);const r1=Math.floor(q_(T_));function D_(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(i=>Fd[i]).join("");for(;e.length>=r1;){let i=e.substring(0,r1);e=parseInt(i,10)%97+e.substring(i.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function B_(r){let e=null;if(typeof r!="string"&&zo.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),e=t1(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==r&&zo.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==D_(r)&&zo.throwArgumentError("bad icap checksum","address",r),e=u_(r.substring(4));e.length<40;)e="0"+e;e=t1("0x"+e)}else zo.throwArgumentError("invalid address","address",r);return e}function Ro(r,e,t){Object.defineProperty(r,e,{enumerable:!0,value:t,writable:!1})}const $_=new Uint8Array(32);$_.fill(0),Vr.from(-1);const k_=Vr.from(0),L_=Vr.from(1);Vr.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Rn(L_.toHexString(),32),Rn(k_.toHexString(),32);var _n={},Rt={},oc=Ev;function Ev(r,e){if(!r)throw new Error(e||"Assertion failed")}Ev.equal=function(r,e,t){if(r!=e)throw new Error(t||"Assertion failed: "+r+" != "+e)};var bd={exports:{}};typeof Object.create=="function"?bd.exports=function(r,e){e&&(r.super_=e,r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:bd.exports=function(r,e){if(e){r.super_=e;var t=function(){};t.prototype=e.prototype,r.prototype=new t,r.prototype.constructor=r}};var z_=oc,U_=bd.exports;Rt.inherits=U_;function j_(r,e){return(r.charCodeAt(e)&64512)!==55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)===56320}function F_(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),s=0;s<r.length;s+=2)t.push(parseInt(r[s]+r[s+1],16))}else for(var i=0,s=0;s<r.length;s++){var a=r.charCodeAt(s);a<128?t[i++]=a:a<2048?(t[i++]=a>>6|192,t[i++]=a&63|128):j_(r,s)?(a=65536+((a&1023)<<10)+(r.charCodeAt(++s)&1023),t[i++]=a>>18|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128,t[i++]=a&63|128):(t[i++]=a>>12|224,t[i++]=a>>6&63|128,t[i++]=a&63|128)}else for(s=0;s<r.length;s++)t[s]=r[s]|0;return t}Rt.toArray=F_;function K_(r){for(var e="",t=0;t<r.length;t++)e+=Sv(r[t].toString(16));return e}Rt.toHex=K_;function Mv(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}Rt.htonl=Mv;function H_(r,e){for(var t="",i=0;i<r.length;i++){var s=r[i];e==="little"&&(s=Mv(s)),t+=Pv(s.toString(16))}return t}Rt.toHex32=H_;function Sv(r){return r.length===1?"0"+r:r}Rt.zero2=Sv;function Pv(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}Rt.zero8=Pv;function V_(r,e,t,i){var s=t-e;z_(s%4===0);for(var a=new Array(s/4),h=0,p=e;h<a.length;h++,p+=4){var m;i==="big"?m=r[p]<<24|r[p+1]<<16|r[p+2]<<8|r[p+3]:m=r[p+3]<<24|r[p+2]<<16|r[p+1]<<8|r[p],a[h]=m>>>0}return a}Rt.join32=V_;function G_(r,e){for(var t=new Array(r.length*4),i=0,s=0;i<r.length;i++,s+=4){var a=r[i];e==="big"?(t[s]=a>>>24,t[s+1]=a>>>16&255,t[s+2]=a>>>8&255,t[s+3]=a&255):(t[s+3]=a>>>24,t[s+2]=a>>>16&255,t[s+1]=a>>>8&255,t[s]=a&255)}return t}Rt.split32=G_;function J_(r,e){return r>>>e|r<<32-e}Rt.rotr32=J_;function W_(r,e){return r<<e|r>>>32-e}Rt.rotl32=W_;function Q_(r,e){return r+e>>>0}Rt.sum32=Q_;function Y_(r,e,t){return r+e+t>>>0}Rt.sum32_3=Y_;function X_(r,e,t,i){return r+e+t+i>>>0}Rt.sum32_4=X_;function Z_(r,e,t,i,s){return r+e+t+i+s>>>0}Rt.sum32_5=Z_;function eA(r,e,t,i){var s=r[e],a=r[e+1],h=i+a>>>0,p=(h<i?1:0)+t+s;r[e]=p>>>0,r[e+1]=h}Rt.sum64=eA;function tA(r,e,t,i){var s=e+i>>>0,a=(s<e?1:0)+r+t;return a>>>0}Rt.sum64_hi=tA;function rA(r,e,t,i){var s=e+i;return s>>>0}Rt.sum64_lo=rA;function iA(r,e,t,i,s,a,h,p){var m=0,v=e;v=v+i>>>0,m+=v<e?1:0,v=v+a>>>0,m+=v<a?1:0,v=v+p>>>0,m+=v<p?1:0;var _=r+t+s+h+m;return _>>>0}Rt.sum64_4_hi=iA;function nA(r,e,t,i,s,a,h,p){var m=e+i+a+p;return m>>>0}Rt.sum64_4_lo=nA;function sA(r,e,t,i,s,a,h,p,m,v){var _=0,I=e;I=I+i>>>0,_+=I<e?1:0,I=I+a>>>0,_+=I<a?1:0,I=I+p>>>0,_+=I<p?1:0,I=I+v>>>0,_+=I<v?1:0;var N=r+t+s+h+m+_;return N>>>0}Rt.sum64_5_hi=sA;function aA(r,e,t,i,s,a,h,p,m,v){var _=e+i+a+p+v;return _>>>0}Rt.sum64_5_lo=aA;function oA(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}Rt.rotr64_hi=oA;function cA(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Rt.rotr64_lo=cA;function hA(r,e,t){return r>>>t}Rt.shr64_hi=hA;function fA(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Rt.shr64_lo=fA;var to={},i1=Rt,uA=oc;function bh(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}to.BlockHash=bh,bh.prototype.update=function(r,e){if(r=i1.toArray(r,e),this.pending?this.pending=this.pending.concat(r):this.pending=r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){r=this.pending;var t=r.length%this._delta8;this.pending=r.slice(r.length-t,r.length),this.pending.length===0&&(this.pending=null),r=i1.join32(r,0,r.length-t,this.endian);for(var i=0;i<r.length;i+=this._delta32)this._update(r,i,i+this._delta32)}return this},bh.prototype.digest=function(r){return this.update(this._pad()),uA(this.pending===null),this._digest(r)},bh.prototype._pad=function(){var r=this.pendingTotal,e=this._delta8,t=e-(r+this.padLength)%e,i=new Array(t+this.padLength);i[0]=128;for(var s=1;s<t;s++)i[s]=0;if(r<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=r>>>24&255,i[s++]=r>>>16&255,i[s++]=r>>>8&255,i[s++]=r&255}else for(i[s++]=r&255,i[s++]=r>>>8&255,i[s++]=r>>>16&255,i[s++]=r>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,a=8;a<this.padLength;a++)i[s++]=0;return i};var Ca={},Un={},dA=Rt,Nn=dA.rotr32;function lA(r,e,t,i){if(r===0)return Rv(e,t,i);if(r===1||r===3)return Cv(e,t,i);if(r===2)return Nv(e,t,i)}Un.ft_1=lA;function Rv(r,e,t){return r&e^~r&t}Un.ch32=Rv;function Nv(r,e,t){return r&e^r&t^e&t}Un.maj32=Nv;function Cv(r,e,t){return r^e^t}Un.p32=Cv;function pA(r){return Nn(r,2)^Nn(r,13)^Nn(r,22)}Un.s0_256=pA;function gA(r){return Nn(r,6)^Nn(r,11)^Nn(r,25)}Un.s1_256=gA;function vA(r){return Nn(r,7)^Nn(r,18)^r>>>3}Un.g0_256=vA;function bA(r){return Nn(r,17)^Nn(r,19)^r>>>10}Un.g1_256=bA;var Fa=Rt,mA=to,yA=Un,Hu=Fa.rotl32,No=Fa.sum32,wA=Fa.sum32_5,_A=yA.ft_1,Ov=mA.BlockHash,AA=[1518500249,1859775393,2400959708,3395469782];function In(){if(!(this instanceof In))return new In;Ov.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Fa.inherits(In,Ov);var xA=In;In.blockSize=512,In.outSize=160,In.hmacStrength=80,In.padLength=64,In.prototype._update=function(r,e){for(var t=this.W,i=0;i<16;i++)t[i]=r[e+i];for(;i<t.length;i++)t[i]=Hu(t[i-3]^t[i-8]^t[i-14]^t[i-16],1);var s=this.h[0],a=this.h[1],h=this.h[2],p=this.h[3],m=this.h[4];for(i=0;i<t.length;i++){var v=~~(i/20),_=wA(Hu(s,5),_A(v,a,h,p),m,t[i],AA[v]);m=p,p=h,h=Hu(a,30),a=s,s=_}this.h[0]=No(this.h[0],s),this.h[1]=No(this.h[1],a),this.h[2]=No(this.h[2],h),this.h[3]=No(this.h[3],p),this.h[4]=No(this.h[4],m)},In.prototype._digest=function(r){return r==="hex"?Fa.toHex32(this.h,"big"):Fa.split32(this.h,"big")};var Ka=Rt,IA=to,ro=Un,EA=oc,en=Ka.sum32,MA=Ka.sum32_4,SA=Ka.sum32_5,PA=ro.ch32,RA=ro.maj32,NA=ro.s0_256,CA=ro.s1_256,OA=ro.g0_256,TA=ro.g1_256,Tv=IA.BlockHash,qA=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function En(){if(!(this instanceof En))return new En;Tv.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=qA,this.W=new Array(64)}Ka.inherits(En,Tv);var qv=En;En.blockSize=512,En.outSize=256,En.hmacStrength=192,En.padLength=64,En.prototype._update=function(r,e){for(var t=this.W,i=0;i<16;i++)t[i]=r[e+i];for(;i<t.length;i++)t[i]=MA(TA(t[i-2]),t[i-7],OA(t[i-15]),t[i-16]);var s=this.h[0],a=this.h[1],h=this.h[2],p=this.h[3],m=this.h[4],v=this.h[5],_=this.h[6],I=this.h[7];for(EA(this.k.length===t.length),i=0;i<t.length;i++){var N=SA(I,CA(m),PA(m,v,_),this.k[i],t[i]),O=en(NA(s),RA(s,a,h));I=_,_=v,v=m,m=en(p,N),p=h,h=a,a=s,s=en(N,O)}this.h[0]=en(this.h[0],s),this.h[1]=en(this.h[1],a),this.h[2]=en(this.h[2],h),this.h[3]=en(this.h[3],p),this.h[4]=en(this.h[4],m),this.h[5]=en(this.h[5],v),this.h[6]=en(this.h[6],_),this.h[7]=en(this.h[7],I)},En.prototype._digest=function(r){return r==="hex"?Ka.toHex32(this.h,"big"):Ka.split32(this.h,"big")};var md=Rt,Dv=qv;function rs(){if(!(this instanceof rs))return new rs;Dv.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}md.inherits(rs,Dv);var DA=rs;rs.blockSize=512,rs.outSize=224,rs.hmacStrength=192,rs.padLength=64,rs.prototype._digest=function(r){return r==="hex"?md.toHex32(this.h.slice(0,7),"big"):md.split32(this.h.slice(0,7),"big")};var hi=Rt,BA=to,$A=oc,Cn=hi.rotr64_hi,On=hi.rotr64_lo,Bv=hi.shr64_hi,$v=hi.shr64_lo,_s=hi.sum64,Vu=hi.sum64_hi,Gu=hi.sum64_lo,kA=hi.sum64_4_hi,LA=hi.sum64_4_lo,zA=hi.sum64_5_hi,UA=hi.sum64_5_lo,kv=BA.BlockHash,jA=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function on(){if(!(this instanceof on))return new on;kv.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=jA,this.W=new Array(160)}hi.inherits(on,kv);var Lv=on;on.blockSize=1024,on.outSize=512,on.hmacStrength=192,on.padLength=128,on.prototype._prepareBlock=function(r,e){for(var t=this.W,i=0;i<32;i++)t[i]=r[e+i];for(;i<t.length;i+=2){var s=ZA(t[i-4],t[i-3]),a=ex(t[i-4],t[i-3]),h=t[i-14],p=t[i-13],m=YA(t[i-30],t[i-29]),v=XA(t[i-30],t[i-29]),_=t[i-32],I=t[i-31];t[i]=kA(s,a,h,p,m,v,_,I),t[i+1]=LA(s,a,h,p,m,v,_,I)}},on.prototype._update=function(r,e){this._prepareBlock(r,e);var t=this.W,i=this.h[0],s=this.h[1],a=this.h[2],h=this.h[3],p=this.h[4],m=this.h[5],v=this.h[6],_=this.h[7],I=this.h[8],N=this.h[9],O=this.h[10],q=this.h[11],j=this.h[12],K=this.h[13],J=this.h[14],Z=this.h[15];$A(this.k.length===t.length);for(var de=0;de<t.length;de+=2){var oe=J,re=Z,fe=WA(I,N),ue=QA(I,N),le=FA(I,N,O,q,j),Ae=KA(I,N,O,q,j,K),ht=this.k[de],k=this.k[de+1],b=t[de],c=t[de+1],d=zA(oe,re,fe,ue,le,Ae,ht,k,b,c),g=UA(oe,re,fe,ue,le,Ae,ht,k,b,c);oe=GA(i,s),re=JA(i,s),fe=HA(i,s,a,h,p),ue=VA(i,s,a,h,p,m);var A=Vu(oe,re,fe,ue),M=Gu(oe,re,fe,ue);J=j,Z=K,j=O,K=q,O=I,q=N,I=Vu(v,_,d,g),N=Gu(_,_,d,g),v=p,_=m,p=a,m=h,a=i,h=s,i=Vu(d,g,A,M),s=Gu(d,g,A,M)}_s(this.h,0,i,s),_s(this.h,2,a,h),_s(this.h,4,p,m),_s(this.h,6,v,_),_s(this.h,8,I,N),_s(this.h,10,O,q),_s(this.h,12,j,K),_s(this.h,14,J,Z)},on.prototype._digest=function(r){return r==="hex"?hi.toHex32(this.h,"big"):hi.split32(this.h,"big")};function FA(r,e,t,i,s){var a=r&t^~r&s;return a<0&&(a+=4294967296),a}function KA(r,e,t,i,s,a){var h=e&i^~e&a;return h<0&&(h+=4294967296),h}function HA(r,e,t,i,s){var a=r&t^r&s^t&s;return a<0&&(a+=4294967296),a}function VA(r,e,t,i,s,a){var h=e&i^e&a^i&a;return h<0&&(h+=4294967296),h}function GA(r,e){var t=Cn(r,e,28),i=Cn(e,r,2),s=Cn(e,r,7),a=t^i^s;return a<0&&(a+=4294967296),a}function JA(r,e){var t=On(r,e,28),i=On(e,r,2),s=On(e,r,7),a=t^i^s;return a<0&&(a+=4294967296),a}function WA(r,e){var t=Cn(r,e,14),i=Cn(r,e,18),s=Cn(e,r,9),a=t^i^s;return a<0&&(a+=4294967296),a}function QA(r,e){var t=On(r,e,14),i=On(r,e,18),s=On(e,r,9),a=t^i^s;return a<0&&(a+=4294967296),a}function YA(r,e){var t=Cn(r,e,1),i=Cn(r,e,8),s=Bv(r,e,7),a=t^i^s;return a<0&&(a+=4294967296),a}function XA(r,e){var t=On(r,e,1),i=On(r,e,8),s=$v(r,e,7),a=t^i^s;return a<0&&(a+=4294967296),a}function ZA(r,e){var t=Cn(r,e,19),i=Cn(e,r,29),s=Bv(r,e,6),a=t^i^s;return a<0&&(a+=4294967296),a}function ex(r,e){var t=On(r,e,19),i=On(e,r,29),s=$v(r,e,6),a=t^i^s;return a<0&&(a+=4294967296),a}var yd=Rt,zv=Lv;function is(){if(!(this instanceof is))return new is;zv.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}yd.inherits(is,zv);var tx=is;is.blockSize=1024,is.outSize=384,is.hmacStrength=192,is.padLength=128,is.prototype._digest=function(r){return r==="hex"?yd.toHex32(this.h.slice(0,12),"big"):yd.split32(this.h.slice(0,12),"big")},Ca.sha1=xA,Ca.sha224=DA,Ca.sha256=qv,Ca.sha384=tx,Ca.sha512=Lv;var Uv={},ea=Rt,rx=to,mh=ea.rotl32,n1=ea.sum32,Co=ea.sum32_3,s1=ea.sum32_4,jv=rx.BlockHash;function An(){if(!(this instanceof An))return new An;jv.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}ea.inherits(An,jv),Uv.ripemd160=An,An.blockSize=512,An.outSize=160,An.hmacStrength=192,An.padLength=64,An.prototype._update=function(r,e){for(var t=this.h[0],i=this.h[1],s=this.h[2],a=this.h[3],h=this.h[4],p=t,m=i,v=s,_=a,I=h,N=0;N<80;N++){var O=n1(mh(s1(t,a1(N,i,s,a),r[sx[N]+e],ix(N)),ox[N]),h);t=h,h=a,a=mh(s,10),s=i,i=O,O=n1(mh(s1(p,a1(79-N,m,v,_),r[ax[N]+e],nx(N)),cx[N]),I),p=I,I=_,_=mh(v,10),v=m,m=O}O=Co(this.h[1],s,_),this.h[1]=Co(this.h[2],a,I),this.h[2]=Co(this.h[3],h,p),this.h[3]=Co(this.h[4],t,m),this.h[4]=Co(this.h[0],i,v),this.h[0]=O},An.prototype._digest=function(r){return r==="hex"?ea.toHex32(this.h,"little"):ea.split32(this.h,"little")};function a1(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function ix(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function nx(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var sx=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],ax=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],ox=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],cx=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],hx=Rt,fx=oc;function ka(r,e,t){if(!(this instanceof ka))return new ka(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(hx.toArray(e,t))}var ux=ka;ka.prototype._init=function(r){r.length>this.blockSize&&(r=new this.Hash().update(r).digest()),fx(r.length<=this.blockSize);for(var e=r.length;e<this.blockSize;e++)r.push(0);for(e=0;e<r.length;e++)r[e]^=54;for(this.inner=new this.Hash().update(r),e=0;e<r.length;e++)r[e]^=106;this.outer=new this.Hash().update(r)},ka.prototype.update=function(r,e){return this.inner.update(r,e),this},ka.prototype.digest=function(r){return this.outer.update(this.inner.digest()),this.outer.digest(r)},function(r){var e=r;e.utils=Rt,e.common=to,e.sha=Ca,e.ripemd=Uv,e.hmac=ux,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(_n);function io(r,e,t){return t={path:e,exports:{},require:function(i,s){return dx(i,s??t.path)}},r(t,t.exports),t.exports}function dx(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Kd=Fv;function Fv(r,e){if(!r)throw new Error(e||"Assertion failed")}Fv.equal=function(r,e,t){if(r!=e)throw new Error(t||"Assertion failed: "+r+" != "+e)};var cn=io(function(r,e){var t=e;function i(h,p){if(Array.isArray(h))return h.slice();if(!h)return[];var m=[];if(typeof h!="string"){for(var v=0;v<h.length;v++)m[v]=h[v]|0;return m}if(p==="hex"){h=h.replace(/[^a-z0-9]+/ig,""),h.length%2!==0&&(h="0"+h);for(var v=0;v<h.length;v+=2)m.push(parseInt(h[v]+h[v+1],16))}else for(var v=0;v<h.length;v++){var _=h.charCodeAt(v),I=_>>8,N=_&255;I?m.push(I,N):m.push(N)}return m}t.toArray=i;function s(h){return h.length===1?"0"+h:h}t.zero2=s;function a(h){for(var p="",m=0;m<h.length;m++)p+=s(h[m].toString(16));return p}t.toHex=a,t.encode=function(h,p){return p==="hex"?a(h):h}}),yi=io(function(r,e){var t=e;t.assert=Kd,t.toArray=cn.toArray,t.zero2=cn.zero2,t.toHex=cn.toHex,t.encode=cn.encode;function i(m,v,_){var I=new Array(Math.max(m.bitLength(),_)+1);I.fill(0);for(var N=1<<v+1,O=m.clone(),q=0;q<I.length;q++){var j,K=O.andln(N-1);O.isOdd()?(K>(N>>1)-1?j=(N>>1)-K:j=K,O.isubn(j)):j=0,I[q]=j,O.iushrn(1)}return I}t.getNAF=i;function s(m,v){var _=[[],[]];m=m.clone(),v=v.clone();for(var I=0,N=0,O;m.cmpn(-I)>0||v.cmpn(-N)>0;){var q=m.andln(3)+I&3,j=v.andln(3)+N&3;q===3&&(q=-1),j===3&&(j=-1);var K;q&1?(O=m.andln(7)+I&7,(O===3||O===5)&&j===2?K=-q:K=q):K=0,_[0].push(K);var J;j&1?(O=v.andln(7)+N&7,(O===3||O===5)&&q===2?J=-j:J=j):J=0,_[1].push(J),2*I===K+1&&(I=1-I),2*N===J+1&&(N=1-N),m.iushrn(1),v.iushrn(1)}return _}t.getJSF=s;function a(m,v,_){var I="_"+v;m.prototype[v]=function(){return this[I]!==void 0?this[I]:this[I]=_.call(this)}}t.cachedProperty=a;function h(m){return typeof m=="string"?t.toArray(m,"hex"):m}t.parseBytes=h;function p(m){return new vt(m,"hex","le")}t.intFromLE=p}),yh=yi.getNAF,lx=yi.getJSF,Gh=yi.assert;function Es(r,e){this.type=r,this.p=new vt(e.p,16),this.red=e.prime?vt.red(e.prime):vt.mont(this.p),this.zero=new vt(0).toRed(this.red),this.one=new vt(1).toRed(this.red),this.two=new vt(2).toRed(this.red),this.n=e.n&&new vt(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var ha=Es;Es.prototype.point=function(){throw new Error("Not implemented")},Es.prototype.validate=function(){throw new Error("Not implemented")},Es.prototype._fixedNafMul=function(r,e){Gh(r.precomputed);var t=r._getDoubles(),i=yh(e,1,this._bitLength),s=(1<<t.step+1)-(t.step%2===0?2:1);s/=3;var a=[],h,p;for(h=0;h<i.length;h+=t.step){p=0;for(var m=h+t.step-1;m>=h;m--)p=(p<<1)+i[m];a.push(p)}for(var v=this.jpoint(null,null,null),_=this.jpoint(null,null,null),I=s;I>0;I--){for(h=0;h<a.length;h++)p=a[h],p===I?_=_.mixedAdd(t.points[h]):p===-I&&(_=_.mixedAdd(t.points[h].neg()));v=v.add(_)}return v.toP()},Es.prototype._wnafMul=function(r,e){var t=4,i=r._getNAFPoints(t);t=i.wnd;for(var s=i.points,a=yh(e,t,this._bitLength),h=this.jpoint(null,null,null),p=a.length-1;p>=0;p--){for(var m=0;p>=0&&a[p]===0;p--)m++;if(p>=0&&m++,h=h.dblp(m),p<0)break;var v=a[p];Gh(v!==0),r.type==="affine"?v>0?h=h.mixedAdd(s[v-1>>1]):h=h.mixedAdd(s[-v-1>>1].neg()):v>0?h=h.add(s[v-1>>1]):h=h.add(s[-v-1>>1].neg())}return r.type==="affine"?h.toP():h},Es.prototype._wnafMulAdd=function(r,e,t,i,s){var a=this._wnafT1,h=this._wnafT2,p=this._wnafT3,m=0,v,_,I;for(v=0;v<i;v++){I=e[v];var N=I._getNAFPoints(r);a[v]=N.wnd,h[v]=N.points}for(v=i-1;v>=1;v-=2){var O=v-1,q=v;if(a[O]!==1||a[q]!==1){p[O]=yh(t[O],a[O],this._bitLength),p[q]=yh(t[q],a[q],this._bitLength),m=Math.max(p[O].length,m),m=Math.max(p[q].length,m);continue}var j=[e[O],null,null,e[q]];e[O].y.cmp(e[q].y)===0?(j[1]=e[O].add(e[q]),j[2]=e[O].toJ().mixedAdd(e[q].neg())):e[O].y.cmp(e[q].y.redNeg())===0?(j[1]=e[O].toJ().mixedAdd(e[q]),j[2]=e[O].add(e[q].neg())):(j[1]=e[O].toJ().mixedAdd(e[q]),j[2]=e[O].toJ().mixedAdd(e[q].neg()));var K=[-3,-1,-5,-7,0,7,5,1,3],J=lx(t[O],t[q]);for(m=Math.max(J[0].length,m),p[O]=new Array(m),p[q]=new Array(m),_=0;_<m;_++){var Z=J[0][_]|0,de=J[1][_]|0;p[O][_]=K[(Z+1)*3+(de+1)],p[q][_]=0,h[O]=j}}var oe=this.jpoint(null,null,null),re=this._wnafT4;for(v=m;v>=0;v--){for(var fe=0;v>=0;){var ue=!0;for(_=0;_<i;_++)re[_]=p[_][v]|0,re[_]!==0&&(ue=!1);if(!ue)break;fe++,v--}if(v>=0&&fe++,oe=oe.dblp(fe),v<0)break;for(_=0;_<i;_++){var le=re[_];le!==0&&(le>0?I=h[_][le-1>>1]:le<0&&(I=h[_][-le-1>>1].neg()),I.type==="affine"?oe=oe.mixedAdd(I):oe=oe.add(I))}}for(v=0;v<i;v++)h[v]=null;return s?oe:oe.toP()};function Oi(r,e){this.curve=r,this.type=e,this.precomputed=null}Es.BasePoint=Oi,Oi.prototype.eq=function(){throw new Error("Not implemented")},Oi.prototype.validate=function(){return this.curve.validate(this)},Es.prototype.decodePoint=function(r,e){r=yi.toArray(r,e);var t=this.p.byteLength();if((r[0]===4||r[0]===6||r[0]===7)&&r.length-1===2*t){r[0]===6?Gh(r[r.length-1]%2===0):r[0]===7&&Gh(r[r.length-1]%2===1);var i=this.point(r.slice(1,1+t),r.slice(1+t,1+2*t));return i}else if((r[0]===2||r[0]===3)&&r.length-1===t)return this.pointFromX(r.slice(1,1+t),r[0]===3);throw new Error("Unknown point format")},Oi.prototype.encodeCompressed=function(r){return this.encode(r,!0)},Oi.prototype._encode=function(r){var e=this.curve.p.byteLength(),t=this.getX().toArray("be",e);return r?[this.getY().isEven()?2:3].concat(t):[4].concat(t,this.getY().toArray("be",e))},Oi.prototype.encode=function(r,e){return yi.encode(this._encode(e),r)},Oi.prototype.precompute=function(r){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,r),e.beta=this._getBeta(),this.precomputed=e,this},Oi.prototype._hasDoubles=function(r){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return e?e.points.length>=Math.ceil((r.bitLength()+1)/e.step):!1},Oi.prototype._getDoubles=function(r,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var t=[this],i=this,s=0;s<e;s+=r){for(var a=0;a<r;a++)i=i.dbl();t.push(i)}return{step:r,points:t}},Oi.prototype._getNAFPoints=function(r){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],t=(1<<r)-1,i=t===1?null:this.dbl(),s=1;s<t;s++)e[s]=e[s-1].add(i);return{wnd:r,points:e}},Oi.prototype._getBeta=function(){return null},Oi.prototype.dblp=function(r){for(var e=this,t=0;t<r;t++)e=e.dbl();return e};var Hd=io(function(r){typeof Object.create=="function"?r.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}}),px=yi.assert;function $i(r){ha.call(this,"short",r),this.a=new vt(r.a,16).toRed(this.red),this.b=new vt(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Hd($i,ha);var gx=$i;$i.prototype._getEndomorphism=function(r){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var e,t;if(r.beta)e=new vt(r.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);e=i[0].cmp(i[1])<0?i[0]:i[1],e=e.toRed(this.red)}if(r.lambda)t=new vt(r.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(e))===0?t=s[0]:(t=s[1],px(this.g.mul(t).x.cmp(this.g.x.redMul(e))===0))}var a;return r.basis?a=r.basis.map(function(h){return{a:new vt(h.a,16),b:new vt(h.b,16)}}):a=this._getEndoBasis(t),{beta:e,lambda:t,basis:a}}},$i.prototype._getEndoRoots=function(r){var e=r===this.p?this.red:vt.mont(r),t=new vt(2).toRed(e).redInvm(),i=t.redNeg(),s=new vt(3).toRed(e).redNeg().redSqrt().redMul(t),a=i.redAdd(s).fromRed(),h=i.redSub(s).fromRed();return[a,h]},$i.prototype._getEndoBasis=function(r){for(var e=this.n.ushrn(Math.floor(this.n.bitLength()/2)),t=r,i=this.n.clone(),s=new vt(1),a=new vt(0),h=new vt(0),p=new vt(1),m,v,_,I,N,O,q,j=0,K,J;t.cmpn(0)!==0;){var Z=i.div(t);K=i.sub(Z.mul(t)),J=h.sub(Z.mul(s));var de=p.sub(Z.mul(a));if(!_&&K.cmp(e)<0)m=q.neg(),v=s,_=K.neg(),I=J;else if(_&&++j===2)break;q=K,i=t,t=K,h=s,s=J,p=a,a=de}N=K.neg(),O=J;var oe=_.sqr().add(I.sqr()),re=N.sqr().add(O.sqr());return re.cmp(oe)>=0&&(N=m,O=v),_.negative&&(_=_.neg(),I=I.neg()),N.negative&&(N=N.neg(),O=O.neg()),[{a:_,b:I},{a:N,b:O}]},$i.prototype._endoSplit=function(r){var e=this.endo.basis,t=e[0],i=e[1],s=i.b.mul(r).divRound(this.n),a=t.b.neg().mul(r).divRound(this.n),h=s.mul(t.a),p=a.mul(i.a),m=s.mul(t.b),v=a.mul(i.b),_=r.sub(h).sub(p),I=m.add(v).neg();return{k1:_,k2:I}},$i.prototype.pointFromX=function(r,e){r=new vt(r,16),r.red||(r=r.toRed(this.red));var t=r.redSqr().redMul(r).redIAdd(r.redMul(this.a)).redIAdd(this.b),i=t.redSqrt();if(i.redSqr().redSub(t).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(e&&!s||!e&&s)&&(i=i.redNeg()),this.point(r,i)},$i.prototype.validate=function(r){if(r.inf)return!0;var e=r.x,t=r.y,i=this.a.redMul(e),s=e.redSqr().redMul(e).redIAdd(i).redIAdd(this.b);return t.redSqr().redISub(s).cmpn(0)===0},$i.prototype._endoWnafMulAdd=function(r,e,t){for(var i=this._endoWnafT1,s=this._endoWnafT2,a=0;a<r.length;a++){var h=this._endoSplit(e[a]),p=r[a],m=p._getBeta();h.k1.negative&&(h.k1.ineg(),p=p.neg(!0)),h.k2.negative&&(h.k2.ineg(),m=m.neg(!0)),i[a*2]=p,i[a*2+1]=m,s[a*2]=h.k1,s[a*2+1]=h.k2}for(var v=this._wnafMulAdd(1,i,s,a*2,t),_=0;_<a*2;_++)i[_]=null,s[_]=null;return v};function vr(r,e,t,i){ha.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new vt(e,16),this.y=new vt(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Hd(vr,ha.BasePoint),$i.prototype.point=function(r,e,t){return new vr(this,r,e,t)},$i.prototype.pointFromJSON=function(r,e){return vr.fromJSON(this,r,e)},vr.prototype._getBeta=function(){if(this.curve.endo){var r=this.precomputed;if(r&&r.beta)return r.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(r){var t=this.curve,i=function(s){return t.point(s.x.redMul(t.endo.beta),s.y)};r.beta=e,e.precomputed={beta:null,naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return e}},vr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},vr.fromJSON=function(r,e,t){typeof e=="string"&&(e=JSON.parse(e));var i=r.point(e[0],e[1],t);if(!e[2])return i;function s(h){return r.point(h[0],h[1],t)}var a=e[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(s))}},i},vr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},vr.prototype.isInfinity=function(){return this.inf},vr.prototype.add=function(r){if(this.inf)return r;if(r.inf)return this;if(this.eq(r))return this.dbl();if(this.neg().eq(r))return this.curve.point(null,null);if(this.x.cmp(r.x)===0)return this.curve.point(null,null);var e=this.y.redSub(r.y);e.cmpn(0)!==0&&(e=e.redMul(this.x.redSub(r.x).redInvm()));var t=e.redSqr().redISub(this.x).redISub(r.x),i=e.redMul(this.x.redSub(t)).redISub(this.y);return this.curve.point(t,i)},vr.prototype.dbl=function(){if(this.inf)return this;var r=this.y.redAdd(this.y);if(r.cmpn(0)===0)return this.curve.point(null,null);var e=this.curve.a,t=this.x.redSqr(),i=r.redInvm(),s=t.redAdd(t).redIAdd(t).redIAdd(e).redMul(i),a=s.redSqr().redISub(this.x.redAdd(this.x)),h=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,h)},vr.prototype.getX=function(){return this.x.fromRed()},vr.prototype.getY=function(){return this.y.fromRed()},vr.prototype.mul=function(r){return r=new vt(r,16),this.isInfinity()?this:this._hasDoubles(r)?this.curve._fixedNafMul(this,r):this.curve.endo?this.curve._endoWnafMulAdd([this],[r]):this.curve._wnafMul(this,r)},vr.prototype.mulAdd=function(r,e,t){var i=[this,e],s=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},vr.prototype.jmulAdd=function(r,e,t){var i=[this,e],s=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},vr.prototype.eq=function(r){return this===r||this.inf===r.inf&&(this.inf||this.x.cmp(r.x)===0&&this.y.cmp(r.y)===0)},vr.prototype.neg=function(r){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(r&&this.precomputed){var t=this.precomputed,i=function(s){return s.neg()};e.precomputed={naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return e},vr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var r=this.curve.jpoint(this.x,this.y,this.curve.one);return r};function Er(r,e,t,i){ha.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new vt(0)):(this.x=new vt(e,16),this.y=new vt(t,16),this.z=new vt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Hd(Er,ha.BasePoint),$i.prototype.jpoint=function(r,e,t){return new Er(this,r,e,t)},Er.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var r=this.z.redInvm(),e=r.redSqr(),t=this.x.redMul(e),i=this.y.redMul(e).redMul(r);return this.curve.point(t,i)},Er.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Er.prototype.add=function(r){if(this.isInfinity())return r;if(r.isInfinity())return this;var e=r.z.redSqr(),t=this.z.redSqr(),i=this.x.redMul(e),s=r.x.redMul(t),a=this.y.redMul(e.redMul(r.z)),h=r.y.redMul(t.redMul(this.z)),p=i.redSub(s),m=a.redSub(h);if(p.cmpn(0)===0)return m.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var v=p.redSqr(),_=v.redMul(p),I=i.redMul(v),N=m.redSqr().redIAdd(_).redISub(I).redISub(I),O=m.redMul(I.redISub(N)).redISub(a.redMul(_)),q=this.z.redMul(r.z).redMul(p);return this.curve.jpoint(N,O,q)},Er.prototype.mixedAdd=function(r){if(this.isInfinity())return r.toJ();if(r.isInfinity())return this;var e=this.z.redSqr(),t=this.x,i=r.x.redMul(e),s=this.y,a=r.y.redMul(e).redMul(this.z),h=t.redSub(i),p=s.redSub(a);if(h.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var m=h.redSqr(),v=m.redMul(h),_=t.redMul(m),I=p.redSqr().redIAdd(v).redISub(_).redISub(_),N=p.redMul(_.redISub(I)).redISub(s.redMul(v)),O=this.z.redMul(h);return this.curve.jpoint(I,N,O)},Er.prototype.dblp=function(r){if(r===0)return this;if(this.isInfinity())return this;if(!r)return this.dbl();var e;if(this.curve.zeroA||this.curve.threeA){var t=this;for(e=0;e<r;e++)t=t.dbl();return t}var i=this.curve.a,s=this.curve.tinv,a=this.x,h=this.y,p=this.z,m=p.redSqr().redSqr(),v=h.redAdd(h);for(e=0;e<r;e++){var _=a.redSqr(),I=v.redSqr(),N=I.redSqr(),O=_.redAdd(_).redIAdd(_).redIAdd(i.redMul(m)),q=a.redMul(I),j=O.redSqr().redISub(q.redAdd(q)),K=q.redISub(j),J=O.redMul(K);J=J.redIAdd(J).redISub(N);var Z=v.redMul(p);e+1<r&&(m=m.redMul(N)),a=j,p=Z,v=J}return this.curve.jpoint(a,v.redMul(s),p)},Er.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Er.prototype._zeroDbl=function(){var r,e,t;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),h=this.x.redAdd(s).redSqr().redISub(i).redISub(a);h=h.redIAdd(h);var p=i.redAdd(i).redIAdd(i),m=p.redSqr().redISub(h).redISub(h),v=a.redIAdd(a);v=v.redIAdd(v),v=v.redIAdd(v),r=m,e=p.redMul(h.redISub(m)).redISub(v),t=this.y.redAdd(this.y)}else{var _=this.x.redSqr(),I=this.y.redSqr(),N=I.redSqr(),O=this.x.redAdd(I).redSqr().redISub(_).redISub(N);O=O.redIAdd(O);var q=_.redAdd(_).redIAdd(_),j=q.redSqr(),K=N.redIAdd(N);K=K.redIAdd(K),K=K.redIAdd(K),r=j.redISub(O).redISub(O),e=q.redMul(O.redISub(r)).redISub(K),t=this.y.redMul(this.z),t=t.redIAdd(t)}return this.curve.jpoint(r,e,t)},Er.prototype._threeDbl=function(){var r,e,t;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),h=this.x.redAdd(s).redSqr().redISub(i).redISub(a);h=h.redIAdd(h);var p=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),m=p.redSqr().redISub(h).redISub(h);r=m;var v=a.redIAdd(a);v=v.redIAdd(v),v=v.redIAdd(v),e=p.redMul(h.redISub(m)).redISub(v),t=this.y.redAdd(this.y)}else{var _=this.z.redSqr(),I=this.y.redSqr(),N=this.x.redMul(I),O=this.x.redSub(_).redMul(this.x.redAdd(_));O=O.redAdd(O).redIAdd(O);var q=N.redIAdd(N);q=q.redIAdd(q);var j=q.redAdd(q);r=O.redSqr().redISub(j),t=this.y.redAdd(this.z).redSqr().redISub(I).redISub(_);var K=I.redSqr();K=K.redIAdd(K),K=K.redIAdd(K),K=K.redIAdd(K),e=O.redMul(q.redISub(r)).redISub(K)}return this.curve.jpoint(r,e,t)},Er.prototype._dbl=function(){var r=this.curve.a,e=this.x,t=this.y,i=this.z,s=i.redSqr().redSqr(),a=e.redSqr(),h=t.redSqr(),p=a.redAdd(a).redIAdd(a).redIAdd(r.redMul(s)),m=e.redAdd(e);m=m.redIAdd(m);var v=m.redMul(h),_=p.redSqr().redISub(v.redAdd(v)),I=v.redISub(_),N=h.redSqr();N=N.redIAdd(N),N=N.redIAdd(N),N=N.redIAdd(N);var O=p.redMul(I).redISub(N),q=t.redAdd(t).redMul(i);return this.curve.jpoint(_,O,q)},Er.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var r=this.x.redSqr(),e=this.y.redSqr(),t=this.z.redSqr(),i=e.redSqr(),s=r.redAdd(r).redIAdd(r),a=s.redSqr(),h=this.x.redAdd(e).redSqr().redISub(r).redISub(i);h=h.redIAdd(h),h=h.redAdd(h).redIAdd(h),h=h.redISub(a);var p=h.redSqr(),m=i.redIAdd(i);m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var v=s.redIAdd(h).redSqr().redISub(a).redISub(p).redISub(m),_=e.redMul(v);_=_.redIAdd(_),_=_.redIAdd(_);var I=this.x.redMul(p).redISub(_);I=I.redIAdd(I),I=I.redIAdd(I);var N=this.y.redMul(v.redMul(m.redISub(v)).redISub(h.redMul(p)));N=N.redIAdd(N),N=N.redIAdd(N),N=N.redIAdd(N);var O=this.z.redAdd(h).redSqr().redISub(t).redISub(p);return this.curve.jpoint(I,N,O)},Er.prototype.mul=function(r,e){return r=new vt(r,e),this.curve._wnafMul(this,r)},Er.prototype.eq=function(r){if(r.type==="affine")return this.eq(r.toJ());if(this===r)return!0;var e=this.z.redSqr(),t=r.z.redSqr();if(this.x.redMul(t).redISub(r.x.redMul(e)).cmpn(0)!==0)return!1;var i=e.redMul(this.z),s=t.redMul(r.z);return this.y.redMul(s).redISub(r.y.redMul(i)).cmpn(0)===0},Er.prototype.eqXToP=function(r){var e=this.z.redSqr(),t=r.toRed(this.curve.red).redMul(e);if(this.x.cmp(t)===0)return!0;for(var i=r.clone(),s=this.curve.redN.redMul(e);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(s),this.x.cmp(t)===0)return!0}},Er.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Er.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Nh=io(function(r,e){var t=e;t.base=ha,t.short=gx,t.mont=null,t.edwards=null}),Ch=io(function(r,e){var t=e,i=yi.assert;function s(p){p.type==="short"?this.curve=new Nh.short(p):p.type==="edwards"?this.curve=new Nh.edwards(p):this.curve=new Nh.mont(p),this.g=this.curve.g,this.n=this.curve.n,this.hash=p.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=s;function a(p,m){Object.defineProperty(t,p,{configurable:!0,enumerable:!0,get:function(){var v=new s(m);return Object.defineProperty(t,p,{configurable:!0,enumerable:!0,value:v}),v}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:_n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:_n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:_n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:_n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:_n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:_n.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:_n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var h;try{h=null.crash()}catch{h=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:_n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",h]})});function Ms(r){if(!(this instanceof Ms))return new Ms(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=cn.toArray(r.entropy,r.entropyEnc||"hex"),t=cn.toArray(r.nonce,r.nonceEnc||"hex"),i=cn.toArray(r.pers,r.persEnc||"hex");Kd(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var o1=Ms;Ms.prototype._init=function(r,e,t){var i=r.concat(e).concat(t);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},Ms.prototype._hmac=function(){return new _n.hmac(this.hash,this.K)},Ms.prototype._update=function(r){var e=this._hmac().update(this.V).update([0]);r&&(e=e.update(r)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),r&&(this.K=this._hmac().update(this.V).update([1]).update(r).digest(),this.V=this._hmac().update(this.V).digest())},Ms.prototype.reseed=function(r,e,t,i){typeof e!="string"&&(i=t,t=e,e=null),r=cn.toArray(r,e),t=cn.toArray(t,i),Kd(r.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(r.concat(t||[])),this._reseed=1},Ms.prototype.generate=function(r,e,t,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof e!="string"&&(i=t,t=e,e=null),t&&(t=cn.toArray(t,i||"hex"),this._update(t));for(var s=[];s.length<r;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,r);return this._update(t),this._reseed++,cn.encode(a,e)};var Ju=yi.assert;function Br(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Wu=Br;Br.fromPublic=function(r,e,t){return e instanceof Br?e:new Br(r,{pub:e,pubEnc:t})},Br.fromPrivate=function(r,e,t){return e instanceof Br?e:new Br(r,{priv:e,privEnc:t})},Br.prototype.validate=function(){var r=this.getPublic();return r.isInfinity()?{result:!1,reason:"Invalid public key"}:r.validate()?r.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Br.prototype.getPublic=function(r,e){return typeof r=="string"&&(e=r,r=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,r):this.pub},Br.prototype.getPrivate=function(r){return r==="hex"?this.priv.toString(16,2):this.priv},Br.prototype._importPrivate=function(r,e){this.priv=new vt(r,e||16),this.priv=this.priv.umod(this.ec.curve.n)},Br.prototype._importPublic=function(r,e){if(r.x||r.y){this.ec.curve.type==="mont"?Ju(r.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Ju(r.x&&r.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(r.x,r.y);return}this.pub=this.ec.curve.decodePoint(r,e)},Br.prototype.derive=function(r){return r.validate()||Ju(r.validate(),"public point not validated"),r.mul(this.priv).getX()},Br.prototype.sign=function(r,e,t){return this.ec.sign(r,this,e,t)},Br.prototype.verify=function(r,e){return this.ec.verify(r,e,this)},Br.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var vx=yi.assert;function gf(r,e){if(r instanceof gf)return r;this._importDER(r,e)||(vx(r.r&&r.s,"Signature without r or s"),this.r=new vt(r.r,16),this.s=new vt(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var wh=gf;function bx(){this.place=0}function Qu(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var s=0,a=0,h=e.place;a<i;a++,h++)s<<=8,s|=r[h],s>>>=0;return s<=127?!1:(e.place=h,s)}function c1(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}gf.prototype._importDER=function(r,e){r=yi.toArray(r,e);var t=new bx;if(r[t.place++]!==48)return!1;var i=Qu(r,t);if(i===!1||i+t.place!==r.length||r[t.place++]!==2)return!1;var s=Qu(r,t);if(s===!1)return!1;var a=r.slice(t.place,s+t.place);if(t.place+=s,r[t.place++]!==2)return!1;var h=Qu(r,t);if(h===!1||r.length!==h+t.place)return!1;var p=r.slice(t.place,h+t.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(p[0]===0)if(p[1]&128)p=p.slice(1);else return!1;return this.r=new vt(a),this.s=new vt(p),this.recoveryParam=null,!0};function Yu(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}gf.prototype.toDER=function(r){var e=this.r.toArray(),t=this.s.toArray();for(e[0]&128&&(e=[0].concat(e)),t[0]&128&&(t=[0].concat(t)),e=c1(e),t=c1(t);!t[0]&&!(t[1]&128);)t=t.slice(1);var i=[2];Yu(i,e.length),i=i.concat(e),i.push(2),Yu(i,t.length);var s=i.concat(t),a=[48];return Yu(a,s.length),a=a.concat(s),yi.encode(a,r)};var mx=function(){throw new Error("unsupported")},Kv=yi.assert;function Di(r){if(!(this instanceof Di))return new Di(r);typeof r=="string"&&(Kv(Object.prototype.hasOwnProperty.call(Ch,r),"Unknown curve "+r),r=Ch[r]),r instanceof Ch.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var yx=Di;Di.prototype.keyPair=function(r){return new Wu(this,r)},Di.prototype.keyFromPrivate=function(r,e){return Wu.fromPrivate(this,r,e)},Di.prototype.keyFromPublic=function(r,e){return Wu.fromPublic(this,r,e)},Di.prototype.genKeyPair=function(r){r||(r={});for(var e=new o1({hash:this.hash,pers:r.pers,persEnc:r.persEnc||"utf8",entropy:r.entropy||mx(this.hash.hmacStrength),entropyEnc:r.entropy&&r.entropyEnc||"utf8",nonce:this.n.toArray()}),t=this.n.byteLength(),i=this.n.sub(new vt(2));;){var s=new vt(e.generate(t));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}},Di.prototype._truncateToN=function(r,e){var t=r.byteLength()*8-this.n.bitLength();return t>0&&(r=r.ushrn(t)),!e&&r.cmp(this.n)>=0?r.sub(this.n):r},Di.prototype.sign=function(r,e,t,i){typeof t=="object"&&(i=t,t=null),i||(i={}),e=this.keyFromPrivate(e,t),r=this._truncateToN(new vt(r,16));for(var s=this.n.byteLength(),a=e.getPrivate().toArray("be",s),h=r.toArray("be",s),p=new o1({hash:this.hash,entropy:a,nonce:h,pers:i.pers,persEnc:i.persEnc||"utf8"}),m=this.n.sub(new vt(1)),v=0;;v++){var _=i.k?i.k(v):new vt(p.generate(this.n.byteLength()));if(_=this._truncateToN(_,!0),!(_.cmpn(1)<=0||_.cmp(m)>=0)){var I=this.g.mul(_);if(!I.isInfinity()){var N=I.getX(),O=N.umod(this.n);if(O.cmpn(0)!==0){var q=_.invm(this.n).mul(O.mul(e.getPrivate()).iadd(r));if(q=q.umod(this.n),q.cmpn(0)!==0){var j=(I.getY().isOdd()?1:0)|(N.cmp(O)!==0?2:0);return i.canonical&&q.cmp(this.nh)>0&&(q=this.n.sub(q),j^=1),new wh({r:O,s:q,recoveryParam:j})}}}}}},Di.prototype.verify=function(r,e,t,i){r=this._truncateToN(new vt(r,16)),t=this.keyFromPublic(t,i),e=new wh(e,"hex");var s=e.r,a=e.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var h=a.invm(this.n),p=h.mul(r).umod(this.n),m=h.mul(s).umod(this.n),v;return this.curve._maxwellTrick?(v=this.g.jmulAdd(p,t.getPublic(),m),v.isInfinity()?!1:v.eqXToP(s)):(v=this.g.mulAdd(p,t.getPublic(),m),v.isInfinity()?!1:v.getX().umod(this.n).cmp(s)===0)},Di.prototype.recoverPubKey=function(r,e,t,i){Kv((3&t)===t,"The recovery param is more than two bits"),e=new wh(e,i);var s=this.n,a=new vt(r),h=e.r,p=e.s,m=t&1,v=t>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&v)throw new Error("Unable to find sencond key candinate");v?h=this.curve.pointFromX(h.add(this.curve.n),m):h=this.curve.pointFromX(h,m);var _=e.r.invm(s),I=s.sub(a).mul(_).umod(s),N=p.mul(_).umod(s);return this.g.mulAdd(I,h,N)},Di.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new wh(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var s=0;s<4;s++){var a;try{a=this.recoverPubKey(r,e,s)}catch{continue}if(a.eq(t))return s}throw new Error("Unable to find valid recovery factor")};var wx=io(function(r,e){var t=e;t.version="6.5.4",t.utils=yi,t.rand=function(){throw new Error("unsupported")},t.curve=Nh,t.curves=Ch,t.ec=yx,t.eddsa=null}),_x=wx.ec;const Ax="signing-key/5.7.0",wd=new Mr(Ax);let Xu=null;function Is(){return Xu||(Xu=new _x("secp256k1")),Xu}class xx{constructor(e){Ro(this,"curve","secp256k1"),Ro(this,"privateKey",si(e)),a_(this.privateKey)!==32&&wd.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=Is().keyFromPrivate(er(this.privateKey));Ro(this,"publicKey","0x"+t.getPublic(!1,"hex")),Ro(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),Ro(this,"_isSigningKey",!0)}_addPoint(e){const t=Is().keyFromPublic(er(this.publicKey)),i=Is().keyFromPublic(er(e));return"0x"+t.pub.add(i.pub).encodeCompressed("hex")}signDigest(e){const t=Is().keyFromPrivate(er(this.privateKey)),i=er(e);i.length!==32&&wd.throwArgumentError("bad digest length","digest",e);const s=t.sign(i,{canonical:!0});return gv({recoveryParam:s.recoveryParam,r:Rn("0x"+s.r.toString(16),32),s:Rn("0x"+s.s.toString(16),32)})}computeSharedSecret(e){const t=Is().keyFromPrivate(er(this.privateKey)),i=Is().keyFromPublic(er(Hv(e)));return Rn("0x"+t.derive(i.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function Ix(r,e){const t=gv(e),i={r:er(t.r),s:er(t.s)};return"0x"+Is().recoverPubKey(er(r),i,t.recoveryParam).encode("hex",!1)}function Hv(r,e){const t=er(r);return t.length===32?new xx(t).publicKey:t.length===33?"0x"+Is().keyFromPublic(t).getPublic(!1,"hex"):t.length===65?si(t):wd.throwArgumentError("invalid public or private key","key","[REDACTED]")}var h1;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(h1||(h1={}));function Ex(r){const e=Hv(r);return B_(Jp(Ud(Jp(e,1)),12))}function Mx(r,e){return Ex(Ix(er(r),e))}const Sx="https://rpc.walletconnect.com/v1";async function Px(r,e,t,i,s,a){switch(t.t){case"eip191":return Rx(r,e,t.s);case"eip1271":return await Nx(r,e,t.s,i,s,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function Rx(r,e,t){return Mx(Iv(e),t).toLowerCase()===r.toLowerCase()}async function Nx(r,e,t,i,s,a){try{const h="0x1626ba7e",p="0000000000000000000000000000000000000000000000000000000000000040",m="0000000000000000000000000000000000000000000000000000000000000041",v=t.substring(2),_=Iv(e).substring(2),I=h+_+p+m+v,N=await fetch(`${a||Sx}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Cx(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:I},"latest"]})}),{result:O}=await N.json();return O?O.slice(0,h.length).toLowerCase()===h.toLowerCase():!1}catch(h){return console.error("isValidEip1271Signature: ",h),!1}}function Cx(){return Date.now()+Math.floor(Math.random()*1e3)}var Ox=Object.defineProperty,Tx=Object.defineProperties,qx=Object.getOwnPropertyDescriptors,f1=Object.getOwnPropertySymbols,Dx=Object.prototype.hasOwnProperty,Bx=Object.prototype.propertyIsEnumerable,u1=(r,e,t)=>e in r?Ox(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$x=(r,e)=>{for(var t in e||(e={}))Dx.call(e,t)&&u1(r,t,e[t]);if(f1)for(var t of f1(e))Bx.call(e,t)&&u1(r,t,e[t]);return r},kx=(r,e)=>Tx(r,qx(e));const Lx="did:pkh:",Vd=r=>r==null?void 0:r.split(":"),Vv=r=>{const e=r&&Vd(r);if(e)return r.includes(Lx)?e[3]:e[1]},d1=r=>{const e=r&&Vd(r);if(e)return e[2]+":"+e[3]},Jh=r=>{const e=r&&Vd(r);if(e)return e.pop()};async function l1(r){const{cacao:e,projectId:t}=r,{s:i,p:s}=e,a=Gv(s,s.iss),h=Jh(s.iss);return await Px(h,a,i,Vv(s.iss),t)}const Gv=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,i=Jh(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const a=`URI: ${r.aud||r.uri}`,h=`Version: ${r.version}`,p=`Chain ID: ${Vv(e)}`,m=`Nonce: ${r.nonce}`,v=`Issued At: ${r.iat}`,_=r.exp?`Expiration Time: ${r.exp}`:void 0,I=r.nbf?`Not Before: ${r.nbf}`:void 0,N=r.requestId?`Request ID: ${r.requestId}`:void 0,O=r.resources?`Resources:${r.resources.map(j=>`
- ${j}`).join("")}`:void 0,q=Oh(r.resources);if(q){const j=Yo(q);s=Jx(s,j)}return[t,i,"",s,"",a,h,p,m,v,_,I,N,O].filter(j=>j!=null).join(`
`)};function zx(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function Ux(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function ia(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const i=r.att[t];if(Array.isArray(i))throw new Error(`Resource must be an object: ${t}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(i).forEach(s=>{const a=i[s];if(!Array.isArray(a))throw new Error(`Ability limits ${s} must be an array of objects, found: ${a}`);if(!a.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);a.forEach(h=>{if(typeof h!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${h}`)})})})}function jx(r,e,t,i={}){return t==null||t.sort((s,a)=>s.localeCompare(a)),{att:{[r]:Fx(e,t,i)}}}function Fx(r,e,t={}){e=e==null?void 0:e.sort((s,a)=>s.localeCompare(a));const i=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...i)}function Jv(r){return ia(r),`urn:recap:${zx(r).replace(/=/g,"")}`}function Yo(r){const e=Ux(r.replace("urn:recap:",""));return ia(e),e}function Kx(r,e,t){const i=jx(r,e,t);return Jv(i)}function Hx(r){return r&&r.includes("urn:recap:")}function Vx(r,e){const t=Yo(r),i=Yo(e),s=Gx(t,i);return Jv(s)}function Gx(r,e){ia(r),ia(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,a)=>s.localeCompare(a)),i={att:{}};return t.forEach(s=>{var a,h;Object.keys(((a=r.att)==null?void 0:a[s])||{}).concat(Object.keys(((h=e.att)==null?void 0:h[s])||{})).sort((p,m)=>p.localeCompare(m)).forEach(p=>{var m,v;i.att[s]=kx($x({},i.att[s]),{[p]:((m=r.att[s])==null?void 0:m[p])||((v=e.att[s])==null?void 0:v[p])})})}),i}function Jx(r="",e){ia(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const i=[];let s=0;Object.keys(e.att).forEach(p=>{const m=Object.keys(e.att[p]).map(I=>({ability:I.split("/")[0],action:I.split("/")[1]}));m.sort((I,N)=>I.action.localeCompare(N.action));const v={};m.forEach(I=>{v[I.ability]||(v[I.ability]=[]),v[I.ability].push(I.action)});const _=Object.keys(v).map(I=>(s++,`(${s}) '${I}': '${v[I].join("', '")}' for '${p}'.`));i.push(_.join(", ").replace(".,","."))});const a=i.join(" "),h=`${t}${a}`;return`${r?r+" ":""}${h}`}function p1(r){var e;const t=Yo(r);ia(t);const i=(e=t.att)==null?void 0:e.eip155;return i?Object.keys(i).map(s=>s.split("/")[1]):[]}function g1(r){const e=Yo(r);ia(e);const t=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(s=>{var a;(a=s==null?void 0:s[0])!=null&&a.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function Oh(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return Hx(e)?e:void 0}const Wv="base10",Hr="base16",Ps="base64pad",Oo="base64url",cc="utf8",Qv=0,ss=1,hc=2,Wx=0,v1=1,Go=12,Gd=32;function Qx(){const r=pg.generateKeyPair();return{privateKey:wr(r.secretKey,Hr),publicKey:wr(r.publicKey,Hr)}}function _d(){const r=Ha.randomBytes(Gd);return wr(r,Hr)}function Yx(r,e){const t=pg.sharedKey(yr(r,Hr),yr(e,Hr),!0),i=new yw(Yh.SHA256,t).expand(Gd);return wr(i,Hr)}function Th(r){const e=Yh.hash(yr(r,Hr));return wr(e,Hr)}function ts(r){const e=Yh.hash(yr(r,cc));return wr(e,Hr)}function Yv(r){return yr(`${r}`,Wv)}function na(r){return Number(wr(r,Wv))}function Xx(r){const e=Yv(typeof r.type<"u"?r.type:Qv);if(na(e)===ss&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?yr(r.senderPublicKey,Hr):void 0,i=typeof r.iv<"u"?yr(r.iv,Hr):Ha.randomBytes(Go),s=new gg.ChaCha20Poly1305(yr(r.symKey,Hr)).seal(i,yr(r.message,cc));return Xv({type:e,sealed:s,iv:i,senderPublicKey:t,encoding:r.encoding})}function Zx(r,e){const t=Yv(hc),i=Ha.randomBytes(Go),s=yr(r,cc);return Xv({type:t,sealed:s,iv:i,encoding:e})}function eI(r){const e=new gg.ChaCha20Poly1305(yr(r.symKey,Hr)),{sealed:t,iv:i}=Xo({encoded:r.encoded,encoding:r==null?void 0:r.encoding}),s=e.open(i,t);if(s===null)throw new Error("Failed to decrypt");return wr(s,cc)}function tI(r,e){const{sealed:t}=Xo({encoded:r,encoding:e});return wr(t,cc)}function Xv(r){const{encoding:e=Ps}=r;if(na(r.type)===hc)return wr(Eh([r.type,r.sealed]),e);if(na(r.type)===ss){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return wr(Eh([r.type,r.senderPublicKey,r.iv,r.sealed]),e)}return wr(Eh([r.type,r.iv,r.sealed]),e)}function Xo(r){const{encoded:e,encoding:t=Ps}=r,i=yr(e,t),s=i.slice(Wx,v1),a=v1;if(na(s)===ss){const v=a+Gd,_=v+Go,I=i.slice(a,v),N=i.slice(v,_),O=i.slice(_);return{type:s,sealed:O,iv:N,senderPublicKey:I}}if(na(s)===hc){const v=i.slice(a),_=Ha.randomBytes(Go);return{type:s,sealed:v,iv:_}}const h=a+Go,p=i.slice(a,h),m=i.slice(h);return{type:s,sealed:m,iv:p}}function rI(r,e){const t=Xo({encoded:r,encoding:e==null?void 0:e.encoding});return Zv({type:na(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?wr(t.senderPublicKey,Hr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Zv(r){const e=(r==null?void 0:r.type)||Qv;if(e===ss){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function b1(r){return r.type===ss&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function m1(r){return r.type===hc}function iI(r){return new Tg.ec("p256").keyFromPublic({x:Buffer.from(r.x,"base64").toString("hex"),y:Buffer.from(r.y,"base64").toString("hex")},"hex")}function nI(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");const t=e.length%4;return t>0&&(e+="=".repeat(4-t)),e}function sI(r){return Buffer.from(nI(r),"base64")}function aI(r,e){const[t,i,s]=r.split("."),a=sI(s);if(a.length!==64)throw new Error("Invalid signature length");const h=a.slice(0,32).toString("hex"),p=a.slice(32,64).toString("hex"),m=`${t}.${i}`,v=new Yh.SHA256().update(Buffer.from(m)).digest(),_=iI(e),I=Buffer.from(v).toString("hex");if(!_.verify(I,{r:h,s:p}))throw new Error("Invalid signature");return ud(r).payload}const oI="irn";function Ad(r){return(r==null?void 0:r.relay)||{protocol:oI}}function Uo(r){const e=T9[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var cI=Object.defineProperty,hI=Object.defineProperties,fI=Object.getOwnPropertyDescriptors,y1=Object.getOwnPropertySymbols,uI=Object.prototype.hasOwnProperty,dI=Object.prototype.propertyIsEnumerable,w1=(r,e,t)=>e in r?cI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_1=(r,e)=>{for(var t in e||(e={}))uI.call(e,t)&&w1(r,t,e[t]);if(y1)for(var t of y1(e))dI.call(e,t)&&w1(r,t,e[t]);return r},lI=(r,e)=>hI(r,fI(e));function pI(r,e="-"){const t={},i="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(i)){const a=s.replace(i,""),h=r[s];t[a]=h}}),t}function A1(r){r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,e),s=r.substring(e+1,t).split("@"),a=typeof t<"u"?r.substring(t):"",h=Dh.parse(a),p=typeof h.methods=="string"?h.methods.split(","):void 0;return{protocol:i,topic:gI(s[0]),version:parseInt(s[1],10),symKey:h.symKey,relay:pI(h),methods:p,expiryTimestamp:h.expiryTimestamp?parseInt(h.expiryTimestamp,10):void 0}}function gI(r){return r.startsWith("//")?r.substring(2):r}function vI(r,e="-"){const t="relay",i={};return Object.keys(r).forEach(s=>{const a=t+e+s;r[s]&&(i[a]=r[s])}),i}function bI(r){return`${r.protocol}:${r.topic}@${r.version}?`+Dh.stringify(_1(lI(_1({symKey:r.symKey},vI(r.relay)),{expiryTimestamp:r.expiryTimestamp}),r.methods?{methods:r.methods.join(",")}:{}))}function _h(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function no(r){const e=[];return r.forEach(t=>{const[i,s]=t.split(":");e.push(`${i}:${s}`)}),e}function mI(r){const e=[];return Object.values(r).forEach(t=>{e.push(...no(t.accounts))}),e}function yI(r,e){const t=[];return Object.values(r).forEach(i=>{no(i.accounts).includes(e)&&t.push(...i.methods)}),t}function wI(r,e){const t=[];return Object.values(r).forEach(i=>{no(i.accounts).includes(e)&&t.push(...i.events)}),t}function Jd(r){return r.includes(":")}function jo(r){return Jd(r)?r.split(":")[0]:r}function _I(r){const e={};return r==null||r.forEach(t=>{const[i,s]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[]}),e[i].accounts.push(t),e[i].chains.push(`${i}:${s}`)}),e}function x1(r,e){e=e.map(i=>i.replace("did:pkh:",""));const t=_I(e);for(const[i,s]of Object.entries(t))s.methods?s.methods=Ph(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}const AI={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},xI={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function pe(r,e){const{message:t,code:i}=xI[r];return{message:e?`${t} ${e}`:t,code:i}}function kt(r,e){const{message:t,code:i}=AI[r];return{message:e?`${t} ${e}`:t,code:i}}function Bn(r,e){return!!Array.isArray(r)}function Zo(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ai(r){return typeof r>"u"}function ar(r,e){return e&&ai(r)?!0:typeof r=="string"&&!!r.trim().length}function Wd(r,e){return typeof r=="number"&&!isNaN(r)}function II(r,e){const{requiredNamespaces:t}=e,i=Object.keys(r.namespaces),s=Object.keys(t);let a=!0;return Ys(s,i)?(i.forEach(h=>{const{accounts:p,methods:m,events:v}=r.namespaces[h],_=no(p),I=t[h];(!Ys(ov(h,I),_)||!Ys(I.methods,m)||!Ys(I.events,v))&&(a=!1)}),a):!1}function Wh(r){return ar(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function EI(r){if(ar(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Wh(t)}}return!1}function MI(r){if(ar(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function SI(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function PI(r){return r==null?void 0:r.topic}function RI(r,e){let t=null;return ar(r==null?void 0:r.publicKey,!1)||(t=pe("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function I1(r){let e=!0;return Bn(r)?r.length&&(e=r.every(t=>ar(t,!1))):e=!1,e}function NI(r,e,t){let i=null;return Bn(e)&&e.length?e.forEach(s=>{i||Wh(s)||(i=kt("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Wh(r)||(i=kt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function CI(r,e,t){let i=null;return Object.entries(r).forEach(([s,a])=>{if(i)return;const h=NI(s,ov(s,a),`${e} ${t}`);h&&(i=h)}),i}function OI(r,e){let t=null;return Bn(r)?r.forEach(i=>{t||EI(i)||(t=kt("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=kt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function TI(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const s=OI(i==null?void 0:i.accounts,`${e} namespace`);s&&(t=s)}),t}function qI(r,e){let t=null;return I1(r==null?void 0:r.methods)?I1(r==null?void 0:r.events)||(t=kt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=kt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function eb(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const s=qI(i,`${e}, namespace`);s&&(t=s)}),t}function DI(r,e,t){let i=null;if(r&&Zo(r)){const s=eb(r,e);s&&(i=s);const a=CI(r,e,t);a&&(i=a)}else i=pe("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return i}function Zu(r,e){let t=null;if(r&&Zo(r)){const i=eb(r,e);i&&(t=i);const s=TI(r,e);s&&(t=s)}else t=pe("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function tb(r){return ar(r.protocol,!0)}function BI(r,e){let t=!1;return r?r&&Bn(r)&&r.length&&r.forEach(i=>{t=tb(i)}):t=!0,t}function $I(r){return typeof r=="number"}function ni(r){return typeof r<"u"&&typeof r!==null}function kI(r){return!(!r||typeof r!="object"||!r.code||!Wd(r.code)||!r.message||!ar(r.message,!1))}function LI(r){return!(ai(r)||!ar(r.method,!1))}function zI(r){return!(ai(r)||ai(r.result)&&ai(r.error)||!Wd(r.id)||!ar(r.jsonrpc,!1))}function UI(r){return!(ai(r)||!ar(r.name,!1))}function E1(r,e){return!(!Wh(e)||!mI(r).includes(e))}function jI(r,e,t){return ar(t,!1)?yI(r,e).includes(t):!1}function FI(r,e,t){return ar(t,!1)?wI(r,e).includes(t):!1}function M1(r,e,t){let i=null;const s=KI(r),a=HI(e),h=Object.keys(s),p=Object.keys(a),m=S1(Object.keys(r)),v=S1(Object.keys(e)),_=m.filter(I=>!v.includes(I));return _.length&&(i=pe("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(e).toString()}`)),Ys(h,p)||(i=pe("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${p.toString()}`)),Object.keys(e).forEach(I=>{if(!I.includes(":")||i)return;const N=no(e[I].accounts);N.includes(I)||(i=pe("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${I}
        Required: ${I}
        Approved: ${N.toString()}`))}),h.forEach(I=>{i||(Ys(s[I].methods,a[I].methods)?Ys(s[I].events,a[I].events)||(i=pe("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${I}`)):i=pe("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${I}`))}),i}function KI(r){const e={};return Object.keys(r).forEach(t=>{var i;t.includes(":")?e[t]=r[t]:(i=r[t].chains)==null||i.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function S1(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function HI(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const i=no(r[t].accounts);i==null||i.forEach(s=>{e[s]={accounts:r[t].accounts.filter(a=>a.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function VI(r,e){return Wd(r)&&r<=e.max&&r>=e.min}function P1(){const r=ac();return new Promise(e=>{switch(r){case bi.browser:e(GI());break;case bi.reactNative:e(JI());break;case bi.node:e(WI());break;default:e(!0)}})}function GI(){return sc()&&(navigator==null?void 0:navigator.onLine)}async function JI(){if(Za()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function WI(){return!0}function QI(r){switch(ac()){case bi.browser:YI(r);break;case bi.reactNative:XI(r);break}}function YI(r){!Za()&&sc()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function XI(r){Za()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const ed={};class To{static get(e){return ed[e]}static set(e,t){ed[e]=t}static delete(e){delete ed[e]}}class ZI extends aa{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class eE extends aa{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class tE{constructor(e,t){this.logger=e,this.core=t}}let rE=class extends aa{constructor(e,t){super(),this.relayer=e,this.logger=t}},iE=class extends aa{constructor(e){super()}},nE=class{constructor(e,t,i,s){this.core=e,this.logger=t,this.name=i}};class sE extends aa{constructor(e,t){super(),this.relayer=e,this.logger=t}}let aE=class extends aa{constructor(e,t){super(),this.core=e,this.logger=t}},oE=class{constructor(e,t,i){this.core=e,this.logger=t,this.store=i}},cE=class{constructor(e,t){this.projectId=e,this.logger=t}},hE=class{constructor(e,t,i){this.core=e,this.logger=t,this.telemetryEnabled=i}};class fE{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}let uE=class{constructor(e){this.client=e}};var dE={};function lE(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var s=0;s<r.length;s++){var a=r.charAt(s),h=a.charCodeAt(0);if(t[h]!==255)throw new TypeError(a+" is ambiguous");t[h]=s}var p=r.length,m=r.charAt(0),v=Math.log(p)/Math.log(256),_=Math.log(256)/Math.log(p);function I(q){if(q instanceof Uint8Array||(ArrayBuffer.isView(q)?q=new Uint8Array(q.buffer,q.byteOffset,q.byteLength):Array.isArray(q)&&(q=Uint8Array.from(q))),!(q instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(q.length===0)return"";for(var j=0,K=0,J=0,Z=q.length;J!==Z&&q[J]===0;)J++,j++;for(var de=(Z-J)*_+1>>>0,oe=new Uint8Array(de);J!==Z;){for(var re=q[J],fe=0,ue=de-1;(re!==0||fe<K)&&ue!==-1;ue--,fe++)re+=256*oe[ue]>>>0,oe[ue]=re%p>>>0,re=re/p>>>0;if(re!==0)throw new Error("Non-zero carry");K=fe,J++}for(var le=de-K;le!==de&&oe[le]===0;)le++;for(var Ae=m.repeat(j);le<de;++le)Ae+=r.charAt(oe[le]);return Ae}function N(q){if(typeof q!="string")throw new TypeError("Expected String");if(q.length===0)return new Uint8Array;var j=0;if(q[j]!==" "){for(var K=0,J=0;q[j]===m;)K++,j++;for(var Z=(q.length-j)*v+1>>>0,de=new Uint8Array(Z);q[j];){var oe=t[q.charCodeAt(j)];if(oe===255)return;for(var re=0,fe=Z-1;(oe!==0||re<J)&&fe!==-1;fe--,re++)oe+=p*de[fe]>>>0,de[fe]=oe%256>>>0,oe=oe/256>>>0;if(oe!==0)throw new Error("Non-zero carry");J=re,j++}if(q[j]!==" "){for(var ue=Z-J;ue!==Z&&de[ue]===0;)ue++;for(var le=new Uint8Array(K+(Z-ue)),Ae=K;ue!==Z;)le[Ae++]=de[ue++];return le}}}function O(q){var j=N(q);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:I,decodeUnsafe:N,decode:O}}var pE=lE,gE=pE;const rb=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},vE=r=>new TextEncoder().encode(r),bE=r=>new TextDecoder().decode(r);let mE=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},yE=class{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ib(this,e)}},wE=class{constructor(e){this.decoders=e}or(e){return ib(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const ib=(r,e)=>new wE({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let _E=class{constructor(e,t,i,s){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=s,this.encoder=new mE(e,t,i),this.decoder=new yE(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const vf=({name:r,prefix:e,encode:t,decode:i})=>new _E(r,e,t,i),fc=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:s}=gE(t,e);return vf({prefix:r,name:e,encode:i,decode:a=>rb(s(a))})},AE=(r,e,t,i)=>{const s={};for(let _=0;_<e.length;++_)s[e[_]]=_;let a=r.length;for(;r[a-1]==="=";)--a;const h=new Uint8Array(a*t/8|0);let p=0,m=0,v=0;for(let _=0;_<a;++_){const I=s[r[_]];if(I===void 0)throw new SyntaxError(`Non-${i} character`);m=m<<t|I,p+=t,p>=8&&(p-=8,h[v++]=255&m>>p)}if(p>=t||255&m<<8-p)throw new SyntaxError("Unexpected end of data");return h},xE=(r,e,t)=>{const i=e[e.length-1]==="=",s=(1<<t)-1;let a="",h=0,p=0;for(let m=0;m<r.length;++m)for(p=p<<8|r[m],h+=8;h>t;)h-=t,a+=e[s&p>>h];if(h&&(a+=e[s&p<<t-h]),i)for(;a.length*t&7;)a+="=";return a},Pr=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>vf({prefix:e,name:r,encode(s){return xE(s,i,t)},decode(s){return AE(s,i,t,r)}}),IE=vf({prefix:"\0",name:"identity",encode:r=>bE(r),decode:r=>vE(r)});var EE=Object.freeze({__proto__:null,identity:IE});const ME=Pr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var SE=Object.freeze({__proto__:null,base2:ME});const PE=Pr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var RE=Object.freeze({__proto__:null,base8:PE});const NE=fc({prefix:"9",name:"base10",alphabet:"0123456789"});var CE=Object.freeze({__proto__:null,base10:NE});const OE=Pr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),TE=Pr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var qE=Object.freeze({__proto__:null,base16:OE,base16upper:TE});const DE=Pr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),BE=Pr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$E=Pr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kE=Pr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),LE=Pr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zE=Pr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),UE=Pr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jE=Pr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),FE=Pr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var KE=Object.freeze({__proto__:null,base32:DE,base32upper:BE,base32pad:$E,base32padupper:kE,base32hex:LE,base32hexupper:zE,base32hexpad:UE,base32hexpadupper:jE,base32z:FE});const HE=fc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),VE=fc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var GE=Object.freeze({__proto__:null,base36:HE,base36upper:VE});const JE=fc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),WE=fc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var QE=Object.freeze({__proto__:null,base58btc:JE,base58flickr:WE});const YE=Pr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),XE=Pr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ZE=Pr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),eM=Pr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var tM=Object.freeze({__proto__:null,base64:YE,base64pad:XE,base64url:ZE,base64urlpad:eM});const nb=Array.from(""),rM=nb.reduce((r,e,t)=>(r[t]=e,r),[]),iM=nb.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function nM(r){return r.reduce((e,t)=>(e+=rM[t],e),"")}function sM(r){const e=[];for(const t of r){const i=iM[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const aM=vf({prefix:"",name:"base256emoji",encode:nM,decode:sM});var oM=Object.freeze({__proto__:null,base256emoji:aM}),cM=sb,R1=128,hM=127,fM=~hM,uM=Math.pow(2,31);function sb(r,e,t){e=e||[],t=t||0;for(var i=t;r>=uM;)e[t++]=r&255|R1,r/=128;for(;r&fM;)e[t++]=r&255|R1,r>>>=7;return e[t]=r|0,sb.bytes=t-i+1,e}var dM=xd,lM=128,N1=127;function xd(r,i){var t=0,i=i||0,s=0,a=i,h,p=r.length;do{if(a>=p)throw xd.bytes=0,new RangeError("Could not decode varint");h=r[a++],t+=s<28?(h&N1)<<s:(h&N1)*Math.pow(2,s),s+=7}while(h>=lM);return xd.bytes=a-i,t}var pM=Math.pow(2,7),gM=Math.pow(2,14),vM=Math.pow(2,21),bM=Math.pow(2,28),mM=Math.pow(2,35),yM=Math.pow(2,42),wM=Math.pow(2,49),_M=Math.pow(2,56),AM=Math.pow(2,63),xM=function(r){return r<pM?1:r<gM?2:r<vM?3:r<bM?4:r<mM?5:r<yM?6:r<wM?7:r<_M?8:r<AM?9:10},IM={encode:cM,decode:dM,encodingLength:xM},ab=IM;const C1=(r,e,t=0)=>(ab.encode(r,e,t),e),O1=r=>ab.encodingLength(r),Id=(r,e)=>{const t=e.byteLength,i=O1(r),s=i+O1(t),a=new Uint8Array(s+t);return C1(r,a,0),C1(t,a,i),a.set(e,s),new EM(r,t,e,a)};class EM{constructor(e,t,i,s){this.code=e,this.size=t,this.digest=i,this.bytes=s}}const ob=({name:r,code:e,encode:t})=>new MM(r,e,t);class MM{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Id(this.code,t):t.then(i=>Id(this.code,i))}else throw Error("Unknown type, must be binary type")}}const cb=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),SM=ob({name:"sha2-256",code:18,encode:cb("SHA-256")}),PM=ob({name:"sha2-512",code:19,encode:cb("SHA-512")});var RM=Object.freeze({__proto__:null,sha256:SM,sha512:PM});const hb=0,NM="identity",fb=rb,CM=r=>Id(hb,fb(r)),OM={code:hb,name:NM,encode:fb,digest:CM};var TM=Object.freeze({__proto__:null,identity:OM});new TextEncoder,new TextDecoder;const T1={...EE,...SE,...RE,...CE,...qE,...KE,...GE,...QE,...tM,...oM};({...RM,...TM});function qM(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function ub(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const q1=ub("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),td=ub("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=qM(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),DM={utf8:q1,"utf-8":q1,hex:T1.base16,latin1:td,ascii:td,binary:td,...T1};function BM(r,e="utf8"){const t=DM[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}const db="wc",lb=2,Qd="core",$n=`${db}@2:${Qd}:`,$M={name:Qd,logger:"error"},kM={database:":memory:"},LM="crypto",D1="client_ed25519_seed",zM=be.ONE_DAY,UM="keychain",jM="0.3",FM="messages",KM="0.3",HM=be.SIX_HOURS,VM="publisher",pb="irn",GM="error",gb="wss://relay.walletconnect.org",JM="relayer",Fr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},WM="_subscription",Ti={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},QM=.1,vb="2.16.1",Kt={link_mode:"link_mode",relay:"relay"},YM="0.3",XM="WALLETCONNECT_CLIENT_ID",B1="WALLETCONNECT_LINK_MODE_APPS",xn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ZM="subscription",eS="0.3",tS=be.FIVE_SECONDS*1e3,rS="pairing",iS="0.3",qo={wc_pairingDelete:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:be.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:be.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:be.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:be.ONE_DAY,prompt:!1,tag:0},res:{ttl:be.ONE_DAY,prompt:!1,tag:0}}},Da={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},tn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},nS="history",sS="0.3",aS="expirer",qi={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},oS="0.3",cS="verify-api",hS="https://verify.walletconnect.com",bb="https://verify.walletconnect.org",Jo=bb,fS=`${Jo}/v3`,uS=[hS,bb],dS="echo",lS="https://echo.walletconnect.com",yn={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Zn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},rn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Vs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Gs={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Do={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},pS=.1,gS="event-client",vS=86400,bS="https://pulse.walletconnect.com/batch";class mS{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=UM,this.version=jM,this.initialized=!1,this.storagePrefix=$n,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,s)=>{this.isInitialized(),this.keychain.set(i,s),await this.persist()},this.get=i=>{this.isInitialized();const s=this.keychain.get(i);if(typeof s>"u"){const{message:a}=pe("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(a)}return s},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Gr(t,this.name)}get context(){return fi(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,cv(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?hv(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yS{constructor(e,t,i){this.core=e,this.logger=t,this.name=LM,this.randomSessionIdentifier=_d(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),a=gp(s);return Sg(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=Qx();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const a=await this.getClientSeed(),h=gp(a),p=this.randomSessionIdentifier;return await j4(p,s,zM,h)},this.generateSharedKey=(s,a,h)=>{this.isInitialized();const p=this.getPrivateKey(s),m=Yx(p,a);return this.setSymKey(m,h)},this.setSymKey=async(s,a)=>{this.isInitialized();const h=a||Th(s);return await this.keychain.set(h,s),h},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,a,h)=>{this.isInitialized();const p=Zv(h),m=as(a);if(m1(p))return Zx(m,h==null?void 0:h.encoding);if(b1(p)){const N=p.senderPublicKey,O=p.receiverPublicKey;s=await this.generateSharedKey(N,O)}const v=this.getSymKey(s),{type:_,senderPublicKey:I}=p;return Xx({type:_,symKey:v,message:m,senderPublicKey:I,encoding:h==null?void 0:h.encoding})},this.decode=async(s,a,h)=>{this.isInitialized();const p=rI(a,h);if(m1(p)){const m=tI(a,h==null?void 0:h.encoding);return ta(m)}if(b1(p)){const m=p.receiverPublicKey,v=p.senderPublicKey;s=await this.generateSharedKey(m,v)}try{const m=this.getSymKey(s),v=eI({symKey:m,encoded:a,encoding:h==null?void 0:h.encoding});return ta(v)}catch(m){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(m)}},this.getPayloadType=(s,a=Ps)=>{const h=Xo({encoded:s,encoding:a});return na(h.type)},this.getPayloadSenderPublicKey=(s,a=Ps)=>{const h=Xo({encoded:s,encoding:a});return h.senderPublicKey?wr(h.senderPublicKey,Hr):void 0},this.core=e,this.logger=Gr(t,this.name),this.keychain=i||new mS(this.core,this.logger)}get context(){return fi(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(D1)}catch{e=_d(),await this.keychain.set(D1,e)}return BM(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class wS extends tE{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=FM,this.version=KM,this.initialized=!1,this.storagePrefix=$n,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,s)=>{this.isInitialized();const a=ts(s);let h=this.messages.get(i);return typeof h>"u"&&(h={}),typeof h[a]<"u"||(h[a]=s,this.messages.set(i,h),await this.persist()),a},this.get=i=>{this.isInitialized();let s=this.messages.get(i);return typeof s>"u"&&(s={}),s},this.has=(i,s)=>{this.isInitialized();const a=this.get(i),h=ts(s);return typeof a[h]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Gr(e,this.name),this.core=t}get context(){return fi(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,cv(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?hv(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class _S extends rE{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Li.EventEmitter,this.name=VM,this.queue=new Map,this.publishTimeout=be.toMiliseconds(be.ONE_MINUTE),this.failedPublishTimeout=be.toMiliseconds(be.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(i,s,a)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:a}});const p=(a==null?void 0:a.ttl)||HM,m=Ad(a),v=(a==null?void 0:a.prompt)||!1,_=(a==null?void 0:a.tag)||0,I=(a==null?void 0:a.id)||Ws().toString(),N={topic:i,message:s,opts:{ttl:p,relay:m,prompt:v,tag:_,id:I,attestation:a==null?void 0:a.attestation}},O=`Failed to publish payload, please try again. id:${I} tag:${_}`,q=Date.now();let j,K=1;try{for(;j===void 0;){if(Date.now()-q>this.publishTimeout)throw new Error(O);this.logger.trace({id:I,attempts:K},`publisher.publish - attempt ${K}`),j=await await Ba(this.rpcPublish(i,s,p,m,v,_,I,a==null?void 0:a.attestation).catch(J=>this.logger.warn(J)),this.publishTimeout,O),K++,j||await new Promise(J=>setTimeout(J,this.failedPublishTimeout))}this.relayer.events.emit(Fr.publish,N),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:I,topic:i,message:s,opts:a}})}catch(J){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(J),(h=a==null?void 0:a.internal)!=null&&h.throwOnFailedPublish)throw J;this.queue.set(I,N)}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.relayer=e,this.logger=Gr(t,this.name),this.registerEventListeners()}get context(){return fi(this.logger)}rpcPublish(e,t,i,s,a,h,p,m){var v,_,I,N;const O={method:Uo(s.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:a,tag:h,attestation:m},id:p};return ai((v=O.params)==null?void 0:v.prompt)&&((_=O.params)==null||delete _.prompt),ai((I=O.params)==null?void 0:I.tag)&&((N=O.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:O}),this.relayer.request(O)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:s}=e;await this.publish(t,i,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(Va.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Fr.connection_stalled);return}this.checkQueue()}),this.relayer.on(Fr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class AS{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const s=i.filter(a=>a!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var xS=Object.defineProperty,IS=Object.defineProperties,ES=Object.getOwnPropertyDescriptors,$1=Object.getOwnPropertySymbols,MS=Object.prototype.hasOwnProperty,SS=Object.prototype.propertyIsEnumerable,k1=(r,e,t)=>e in r?xS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bo=(r,e)=>{for(var t in e||(e={}))MS.call(e,t)&&k1(r,t,e[t]);if($1)for(var t of $1(e))SS.call(e,t)&&k1(r,t,e[t]);return r},rd=(r,e)=>IS(r,ES(e));class PS extends sE{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new AS,this.events=new Li.EventEmitter,this.name=ZM,this.version=eS,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$n,this.subscribeTimeout=be.toMiliseconds(be.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(i,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}});try{const a=Ad(s),h={topic:i,relay:a,transportType:s==null?void 0:s.transportType};this.pending.set(i,h);const p=await this.rpcSubscribe(i,a,s==null?void 0:s.transportType);return typeof p=="string"&&(this.onSubscribe(p,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}})),p}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(i,s.id,s):await this.unsubscribeByTopic(i,s)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;const s=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((a,h)=>{const p=new be.Watch;p.start(s);const m=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(m),p.stop(s),a(!0)),p.elapsed(s)>=tS&&(clearInterval(m),p.stop(s),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Gr(t,this.name),this.clientId=""}get context(){return fi(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const s=Ad(i);await this.rpcUnsubscribe(e,t,s);const a=kt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,i=Kt.relay){i===Kt.relay&&await this.restartToComplete();const s={method:Uo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{const a=ts(e+this.clientId);return i===Kt.link_mode?(setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(h=>this.logger.warn(h))},be.toMiliseconds(be.ONE_SECOND)),a):await await Ba(this.relayer.request(s).catch(h=>this.logger.warn(h)),this.subscribeTimeout)?a:null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Fr.connection_stalled)}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,i={method:Uo(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await Ba(this.relayer.request(i).catch(s=>this.logger.warn(s)),this.subscribeTimeout)}catch{this.relayer.events.emit(Fr.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,i={method:Uo(t.protocol).batchFetchMessages,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let s;try{s=await await Ba(this.relayer.request(i).catch(a=>this.logger.warn(a)),this.subscribeTimeout)}catch{this.relayer.events.emit(Fr.connection_stalled)}return s}rpcUnsubscribe(e,t,i){const s={method:Uo(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,rd(Bo({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Bo({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Bo({},t)),this.topicMap.set(t.topic,e),this.events.emit(xn.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(xn.deleted,rd(Bo({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(xn.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(i),await this.batchSubscribe(i)}}this.events.emit(xn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Bn(t)&&this.onBatchSubscribe(t.map((i,s)=>rd(Bo({},e[s]),{id:i})))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(t.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(Va.pulse,async()=>{await this.checkPending()}),this.events.on(xn.created,async e=>{const t=xn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(xn.deleted,async e=>{const t=xn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen(),this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var RS=Object.defineProperty,L1=Object.getOwnPropertySymbols,NS=Object.prototype.hasOwnProperty,CS=Object.prototype.propertyIsEnumerable,z1=(r,e,t)=>e in r?RS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,OS=(r,e)=>{for(var t in e||(e={}))NS.call(e,t)&&z1(r,t,e[t]);if(L1)for(var t of L1(e))CS.call(e,t)&&z1(r,t,e[t]);return r};class TS extends iE{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Li.EventEmitter,this.name=JM,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=be.toMiliseconds(be.THIRTY_SECONDS+be.ONE_SECOND),this.request=async t=>{var i,s;this.logger.debug("Publishing Request Payload");const a=t.id||Ws().toString();await this.toEstablishConnection();try{const h=this.provider.request(t);this.requestsInFlight.set(a,{promise:h,request:t}),this.logger.trace({id:a,method:t.method,topic:(i=t.params)==null?void 0:i.topic},"relayer.request - attempt to publish...");const p=await new Promise(async(m,v)=>{const _=()=>{v(new Error(`relayer.request - publish interrupted, id: ${a}`))};this.provider.on(Ti.disconnect,_);const I=await h;this.provider.off(Ti.disconnect,_),m(I)});return this.logger.trace({id:a,method:t.method,topic:(s=t.params)==null?void 0:s.topic},"relayer.request - published"),p}catch(h){throw this.logger.debug(`Failed to Publish Request: ${a}`),h}finally{this.requestsInFlight.delete(a)}},this.resetPingTimeout=()=>{if(Wo())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,i,s;(s=(i=(t=this.provider)==null?void 0:t.connection)==null?void 0:i.socket)==null||s.terminate()},this.heartBeatTimeout)}catch(t){this.logger.warn(t)}},this.onPayloadHandler=t=>{this.onProviderPayload(t),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit(Fr.connect)},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Fr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ti.payload,this.onPayloadHandler),this.provider.on(Ti.connect,this.onConnectHandler),this.provider.on(Ti.disconnect,this.onDisconnectHandler),this.provider.on(Ti.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Gr(e.logger,this.name):ec(Zh({level:e.logger||GM})),this.messages=new wS(this.logger,e.core),this.subscriber=new PS(this,this.logger),this.publisher=new _S(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||gb,this.projectId=e.projectId,this.bundleId=z9(),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e)}}get context(){return fi(this.logger)}get connected(){var e,t,i;return((i=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:i.readyState)===1}get connecting(){var e,t,i;return((i=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:i.readyState)===0}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Kt.relay})}async subscribe(e,t){var i;this.isInitialized(),(t==null?void 0:t.transportType)==="relay"&&await this.toEstablishConnection();let s=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",a;const h=p=>{p.topic===e&&(this.subscriber.off(xn.created,h),a())};return await Promise.all([new Promise(p=>{a=p,this.subscriber.on(xn.created,h)}),new Promise(async p=>{s=await this.subscriber.subscribe(e,t)||s,p()})]),s}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(e=>e.promise))}catch(e){this.logger.warn(e)}this.hasExperiencedNetworkDisruption||this.connected?await Ba(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(t,i)=>{const s=()=>{this.provider.off(Ti.disconnect,s),i(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Ti.disconnect,s),await Ba(this.provider.connect(),be.toMiliseconds(be.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{i(a)}).finally(()=>{clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),this.subscriber.start().catch(a=>{this.logger.error(a),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,t()})}catch(t){this.logger.error(t);const i=t;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(i.message))throw t}finally{this.connectionAttemptInProgress=!1}}async restartTransport(e){this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await P1())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((i,s)=>i.publishedAt-s.publishedAt);this.logger.trace(`Batch of ${t.length} message events sorted`);for(const i of t)try{await this.onMessageEvent(i)}catch(s){this.logger.warn(s)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:i}=e;if(!t.sessionExists){const s=lr(be.FIVE_MINUTES),a={topic:i,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,a)}this.events.emit(Fr.message,e),await this.recordMessageEvent(e)}startPingTimeout(){var e,t,i,s,a;if(Wo())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((a=(s=(i=this.provider)==null?void 0:i.connection)==null?void 0:s.socket)==null||a.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(h){this.logger.warn(h)}}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new un(new o8(V9({sdkVersion:vb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const s=this.messages.has(t,i);return s&&this.logger.debug(`Ignoring duplicate message: ${i}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Td(e)){if(!e.method.endsWith(WM))return;const t=e.params,{topic:i,message:s,publishedAt:a,attestation:h}=t.data,p={topic:i,message:s,publishedAt:a,transportType:Kt.relay,attestation:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(OS({type:"event",event:t.id},p)),this.events.emit(t.id,p),await this.acknowledgePayload(e),await this.onMessageEvent(p)}else nf(e)&&this.events.emit(Fr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Fr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=tf(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Ti.payload,this.onPayloadHandler),this.provider.off(Ti.connect,this.onConnectHandler),this.provider.off(Ti.disconnect,this.onDisconnectHandler),this.provider.off(Ti.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await P1();QI(async t=>{e!==t&&(e=t,t?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(Fr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e))},be.toMiliseconds(QM))))}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var qS=Object.defineProperty,U1=Object.getOwnPropertySymbols,DS=Object.prototype.hasOwnProperty,BS=Object.prototype.propertyIsEnumerable,j1=(r,e,t)=>e in r?qS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,F1=(r,e)=>{for(var t in e||(e={}))DS.call(e,t)&&j1(r,t,e[t]);if(U1)for(var t of U1(e))BS.call(e,t)&&j1(r,t,e[t]);return r};class fa extends nE{constructor(e,t,i,s=$n,a=void 0){super(e,t,i,s),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=YM,this.cached=[],this.initialized=!1,this.storagePrefix=$n,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!ai(h)?this.map.set(this.getKey(h),h):SI(h)?this.map.set(h.id,h):PI(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,p)=>{this.isInitialized(),this.map.has(h)?await this.update(h,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:p}),this.map.set(h,p),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(p=>Object.keys(h).every(m=>h8(p[m],h[m]))):this.values),this.update=async(h,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:p});const m=F1(F1({},this.getData(h)),p);this.map.set(h,m),await this.persist()},this.delete=async(h,p)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:p}),this.map.delete(h),this.addToRecentlyDeleted(h),await this.persist())},this.logger=Gr(t,this.name),this.storagePrefix=s,this.getKey=a}get context(){return fi(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=pe("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:i}=pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class $S{constructor(e,t){this.core=e,this.logger=t,this.name=rS,this.version=iS,this.events=new Pd,this.initialized=!1,this.storagePrefix=$n,this.ignoredPayloadTypes=[ss],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();const s=_d(),a=await this.core.crypto.setSymKey(s),h=lr(be.FIVE_MINUTES),p={protocol:pb},m={topic:a,expiry:h,relay:p,active:!1},v=bI({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p,expiryTimestamp:h,methods:i==null?void 0:i.methods});return this.core.expirer.set(a,h),await this.pairings.set(a,m),await this.core.relayer.subscribe(a,{transportType:i==null?void 0:i.transportType}),{topic:a,uri:v}},this.pair=async i=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[yn.pairing_started]}});this.isValidPair(i,s);const{topic:a,symKey:h,relay:p,expiryTimestamp:m,methods:v}=A1(i.uri);s.props.properties.topic=a,s.addTrace(yn.pairing_uri_validation_success),s.addTrace(yn.pairing_uri_not_expired);let _;if(this.pairings.keys.includes(a)){if(_=this.pairings.get(a),s.addTrace(yn.existing_pairing),_.active)throw s.setError(Zn.active_pairing_already_exists),new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);s.addTrace(yn.pairing_not_expired)}const I=m||lr(be.FIVE_MINUTES),N={topic:a,relay:p,expiry:I,active:!1,methods:v};this.core.expirer.set(a,I),await this.pairings.set(a,N),s.addTrace(yn.store_new_pairing),i.activatePairing&&await this.activate({topic:a}),this.events.emit(Da.create,N),s.addTrace(yn.emit_inactive_pairing),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(h,a),s.addTrace(yn.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Zn.no_internet_connection)}try{await this.core.relayer.subscribe(a,{relay:p})}catch(O){throw s.setError(Zn.subscribe_pairing_topic_failure),O}return s.addTrace(yn.subscribe_pairing_topic_success),N},this.activate=async({topic:i})=>{this.isInitialized();const s=lr(be.THIRTY_DAYS);this.core.expirer.set(i,s),await this.pairings.update(i,{active:!0,expiry:s})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.pairings.keys.includes(s)){const a=await this.sendRequest(s,"wc_pairingPing",{}),{done:h,resolve:p,reject:m}=Js();this.events.once(It("pairing_ping",a),({error:v})=>{v?m(v):p()}),await h()}},this.updateExpiry=async({topic:i,expiry:s})=>{this.isInitialized(),await this.pairings.update(i,{expiry:s})},this.updateMetadata=async({topic:i,metadata:s})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",kt("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(i,s,a)=>{const h=Qs(s,a),p=await this.core.crypto.encode(i,h),m=qo[s].req;return this.core.history.set(i,h),this.core.relayer.publish(i,p,m),h.id},this.sendResult=async(i,s,a)=>{const h=tf(i,a),p=await this.core.crypto.encode(s,h),m=await this.core.history.get(s,i),v=qo[m.request.method].res;await this.core.relayer.publish(s,p,v),await this.core.history.resolve(h)},this.sendError=async(i,s,a)=>{const h=rf(i,a),p=await this.core.crypto.encode(s,h),m=await this.core.history.get(s,i),v=qo[m.request.method]?qo[m.request.method].res:qo.unregistered_method.res;await this.core.relayer.publish(s,p,v),await this.core.history.resolve(h)},this.deletePairing=async(i,s)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,kt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),s?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(s=>xs(s.expiry));await Promise.all(i.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=i=>{const{topic:s,payload:a}=i;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(s,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,a);default:return this.onUnknownRpcMethodRequest(s,a)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:a}=i,h=(await this.core.history.get(s,a.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(s,a);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(i,s)=>{const{id:a}=s;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.events.emit(Da.ping,{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.logger.error(h)}},this.onPairingPingResponse=(i,s)=>{const{id:a}=s;setTimeout(()=>{wn(s)?this.events.emit(It("pairing_ping",a),{}):Bi(s)&&this.events.emit(It("pairing_ping",a),{error:s.error})},500)},this.onPairingDeleteRequest=async(i,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Da.delete,{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(i,s)=>{const{id:a,method:h}=s;try{if(this.registeredMethods.includes(h))return;const p=kt("WC_METHOD_UNSUPPORTED",h);await this.sendError(a,i,p),this.logger.error(p)}catch(p){await this.sendError(a,i,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(kt("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=(i,s)=>{var a;if(!ni(i)){const{message:p}=pe("MISSING_OR_INVALID",`pair() params: ${i}`);throw s.setError(Zn.malformed_pairing_uri),new Error(p)}if(!MI(i.uri)){const{message:p}=pe("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw s.setError(Zn.malformed_pairing_uri),new Error(p)}const h=A1(i==null?void 0:i.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:p}=pe("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Zn.malformed_pairing_uri),new Error(p)}if(!(h!=null&&h.symKey)){const{message:p}=pe("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Zn.malformed_pairing_uri),new Error(p)}if(h!=null&&h.expiryTimestamp&&be.toMiliseconds(h==null?void 0:h.expiryTimestamp)<Date.now()){s.setError(Zn.pairing_expired);const{message:p}=pe("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(p)}},this.isValidPing=async i=>{if(!ni(i)){const{message:a}=pe("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidDisconnect=async i=>{if(!ni(i)){const{message:a}=pe("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async i=>{if(!ar(i,!1)){const{message:s}=pe("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(s)}if(!this.pairings.keys.includes(i)){const{message:s}=pe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(s)}if(xs(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:s}=pe("EXPIRED",`pairing topic: ${i}`);throw new Error(s)}},this.core=e,this.logger=Gr(t,this.name),this.pairings=new fa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return fi(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Fr.message,async e=>{const{topic:t,message:i,transportType:s}=e;if(!this.pairings.keys.includes(t)||s===Kt.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const a=await this.core.crypto.decode(t,i);try{Td(a)?(this.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a})):nf(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a}),this.core.history.delete(t,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(qi.expired,async e=>{const{topic:t}=uv(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Da.expire,{topic:t}))})}}class kS extends eE{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Li.EventEmitter,this.name=nS,this.version=sS,this.cached=[],this.initialized=!1,this.storagePrefix=$n,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,s,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:s,chainId:a}),this.records.has(s.id))return;const h={id:s.id,topic:i,request:{method:s.method,params:s.params||null},chainId:a,expiry:lr(be.THIRTY_DAYS)};this.records.set(h.id,h),this.persist(),this.events.emit(tn.created,h)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const s=await this.getRecord(i.id);typeof s.response>"u"&&(s.response=Bi(i)?{error:i.error}:{result:i.result},this.records.set(s.id,s),this.persist(),this.events.emit(tn.updated,s))},this.get=async(i,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:s}),await this.getRecord(s)),this.delete=(i,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(a=>{if(a.topic===i){if(typeof s<"u"&&a.id!==s)return;this.records.delete(a.id),this.events.emit(tn.deleted,a)}}),this.persist()},this.exists=async(i,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===i:!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Gr(t,this.name)}get context(){return fi(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:Qs(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(tn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(tn.created,e=>{const t=tn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(tn.updated,e=>{const t=tn.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(tn.deleted,e=>{const t=tn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(Va.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{be.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(tn.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class LS extends aE{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Li.EventEmitter,this.name=aS,this.version=oS,this.cached=[],this.initialized=!1,this.storagePrefix=$n,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const s=this.formatTarget(i);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(i,s)=>{this.isInitialized();const a=this.formatTarget(i),h={target:a,expiry:s};this.expirations.set(a,h),this.checkExpiry(a,h),this.events.emit(qi.created,{target:a,expiration:h})},this.get=i=>{this.isInitialized();const s=this.formatTarget(i);return this.getExpiration(s)},this.del=i=>{if(this.isInitialized(),this.has(i)){const s=this.formatTarget(i),a=this.getExpiration(s);this.expirations.delete(s),this.events.emit(qi.deleted,{target:s,expiration:a})}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Gr(t,this.name)}get context(){return fi(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return G9(e);if(typeof e=="number")return J9(e);const{message:t}=pe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(qi.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;be.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(qi.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Va.pulse,()=>this.checkExpirations()),this.events.on(qi.created,e=>{const t=qi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(qi.expired,e=>{const t=qi.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(qi.deleted,e=>{const t=qi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.getLocalStorage=Jt.getLocalStorageOrThrow=Jt.getCrypto=Jt.getCryptoOrThrow=Jt.getLocation=Jt.getLocationOrThrow=Jt.getNavigator=Jt.getNavigatorOrThrow=mb=Jt.getDocument=Jt.getDocumentOrThrow=Jt.getFromWindowOrThrow=Jt.getFromWindow=void 0;function ua(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Jt.getFromWindow=ua;function so(r){const e=ua(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Jt.getFromWindowOrThrow=so;function zS(){return so("document")}Jt.getDocumentOrThrow=zS;function US(){return ua("document")}var mb=Jt.getDocument=US;function jS(){return so("navigator")}Jt.getNavigatorOrThrow=jS;function FS(){return ua("navigator")}Jt.getNavigator=FS;function KS(){return so("location")}Jt.getLocationOrThrow=KS;function HS(){return ua("location")}Jt.getLocation=HS;function VS(){return so("crypto")}Jt.getCryptoOrThrow=VS;function GS(){return ua("crypto")}Jt.getCrypto=GS;function JS(){return so("localStorage")}Jt.getLocalStorageOrThrow=JS;function WS(){return ua("localStorage")}Jt.getLocalStorage=WS;class QS extends oE{constructor(e,t,i){super(e,t,i),this.core=e,this.logger=t,this.store=i,this.name=cS,this.verifyUrlV3=fS,this.storagePrefix=$n,this.version=lb,this.init=async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&be.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async s=>{if(!sc()||this.isDevEnv)return;const a=window.location.origin,{id:h,decryptedId:p}=s,m=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${a}&id=${h}&decryptedId=${p}`;try{const v=mb(),_=this.startAbortTimer(be.ONE_SECOND*5),I=await new Promise((N,O)=>{const q=()=>{window.removeEventListener("message",K),v.body.removeChild(j),O("attestation aborted")};this.abortController.signal.addEventListener("abort",q);const j=v.createElement("iframe");j.src=m,j.style.display="none",j.addEventListener("error",q,{signal:this.abortController.signal});const K=J=>{if(!J.data)return;const Z=JSON.parse(J.data);if(Z.type==="verify_attestation"){if(ud(Z.attestation).payload.id!==h)return;clearInterval(_),v.body.removeChild(j),this.abortController.signal.removeEventListener("abort",q),window.removeEventListener("message",K),N(Z.attestation===null?"":Z.attestation)}};v.body.appendChild(j),window.addEventListener("message",K,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",I),I}catch(v){this.logger.warn(v)}return""},this.resolve=async s=>{if(this.isDevEnv)return"";const{attestationId:a,hash:h,encryptedId:p}=s;if(a===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(a){if(ud(a).payload.id!==p)return;const v=await this.isValidJwtAttestation(a);if(v){if(!v.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return v}}if(!h)return;const m=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(h,m)},this.fetchAttestation=async(s,a)=>{this.logger.debug(`resolving attestation: ${s} from url: ${a}`);const h=this.startAbortTimer(be.ONE_SECOND*5),p=await fetch(`${a}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(h),p.status===200?await p.json():void 0},this.getVerifyUrl=s=>{let a=s||Jo;return uS.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Jo}`),a=Jo),a},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(be.FIVE_SECONDS),a=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await a.json()}catch(s){this.logger.warn(s)}},this.persistPublicKey=async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async s=>{const a=await this.getPublicKey();try{if(a)return this.validateAttestation(s,a)}catch(p){this.logger.error(p),this.logger.warn("error validating attestation")}const h=await this.fetchAndPersistPublicKey();try{if(h)return this.validateAttestation(s,h)}catch(p){this.logger.error(p),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{const h=await this.fetchPublicKey();h&&(await this.persistPublicKey(h),a(h))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s},this.validateAttestation=(s,a)=>{const h=aI(s,a.publicKey),p={hasExpired:be.toMiliseconds(h.exp)<Date.now(),payload:h};if(p.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:p.payload.origin,isScam:p.payload.isScam,isVerified:p.payload.isVerified}},this.logger=Gr(t,this.name),this.abortController=new AbortController,this.isDevEnv=Wo()&&dE.IS_VITEST,this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return fi(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),be.toMiliseconds(e))}}class YS extends cE{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=dS,this.registerDeviceToken=async i=>{const{clientId:s,token:a,notificationType:h,enableEncrypted:p=!1}=i,m=`${lS}/${this.projectId}/clients`;await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:h,token:a,always_raw:p})})},this.logger=Gr(t,this.context)}}var XS=Object.defineProperty,K1=Object.getOwnPropertySymbols,ZS=Object.prototype.hasOwnProperty,eP=Object.prototype.propertyIsEnumerable,H1=(r,e,t)=>e in r?XS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$o=(r,e)=>{for(var t in e||(e={}))ZS.call(e,t)&&H1(r,t,e[t]);if(K1)for(var t of K1(e))eP.call(e,t)&&H1(r,t,e[t]);return r};class tP extends hE{constructor(e,t,i=!0){super(e,t,i),this.core=e,this.logger=t,this.context=gS,this.storagePrefix=$n,this.storageVersion=pS,this.events=new Map,this.shouldPersist=!1,this.createEvent=s=>{const{event:a="ERROR",type:h="",properties:{topic:p,trace:m}}=s,v=Y9(),_=this.core.projectId||"",I=Date.now(),N=$o({eventId:v,bundleId:_,timestamp:I,props:{event:a,type:h,properties:{topic:p,trace:m}}},this.setMethods(v));return this.telemetryEnabled&&(this.events.set(v,N),this.shouldPersist=!0),N},this.getEvent=s=>{const{eventId:a,topic:h}=s;if(a)return this.events.get(a);const p=Array.from(this.events.values()).find(m=>m.props.properties.topic===h);if(p)return $o($o({},p),this.setMethods(p.eventId))},this.deleteEvent=s=>{const{eventId:a}=s;this.events.delete(a),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(Va.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{be.fromMiliseconds(Date.now())-be.fromMiliseconds(s.timestamp)>vS&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})},this.setMethods=s=>({addTrace:a=>this.addTrace(s,a),setError:a=>this.setError(s,a)}),this.addTrace=(s,a)=>{const h=this.events.get(s);h&&(h.props.properties.trace.push(a),this.events.set(s,h),this.shouldPersist=!0)},this.setError=(s,a)=>{const h=this.events.get(s);h&&(h.props.type=a,h.timestamp=Date.now(),this.events.set(s,h),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(a=>{this.events.set(a.eventId,$o($o({},a),this.setMethods(a.eventId)))})}catch(s){this.logger.warn(s)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[a,h]of this.events)h.props.type&&s.push(h);if(s.length!==0)try{if((await fetch(`${bS}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${vb}`,{method:"POST",body:JSON.stringify(s)})).ok)for(const a of s)this.events.delete(a.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}},this.logger=Gr(t,this.context),i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var rP=Object.defineProperty,V1=Object.getOwnPropertySymbols,iP=Object.prototype.hasOwnProperty,nP=Object.prototype.propertyIsEnumerable,G1=(r,e,t)=>e in r?rP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,J1=(r,e)=>{for(var t in e||(e={}))iP.call(e,t)&&G1(r,t,e[t]);if(V1)for(var t of V1(e))nP.call(e,t)&&G1(r,t,e[t]);return r};let sP=class yb extends ZI{constructor(e){var t;super(e),this.protocol=db,this.version=lb,this.name=Qd,this.events=new Li.EventEmitter,this.initialized=!1,this.on=(h,p)=>this.events.on(h,p),this.once=(h,p)=>this.events.once(h,p),this.off=(h,p)=>this.events.off(h,p),this.removeListener=(h,p)=>this.events.removeListener(h,p),this.dispatchEnvelope=({topic:h,message:p,sessionExists:m})=>{if(!h||!p)return;const v={topic:h,message:p,publishedAt:Date.now(),transportType:Kt.link_mode};this.relayer.onLinkMessageEvent(v,{sessionExists:m})},this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||gb,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=Zh({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:$M.logger}),{logger:s,chunkLoggerController:a}=R4({opts:i,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=a,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var h,p;(h=this.logChunkController)!=null&&h.downloadLogsBlobInBrowser&&((p=this.logChunkController)==null||p.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Gr(s,this.name),this.heartbeat=new p4,this.crypto=new yS(this,this.logger,e==null?void 0:e.keychain),this.history=new kS(this,this.logger),this.expirer=new LS(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new d4(J1(J1({},kM),e==null?void 0:e.storageOptions)),this.relayer=new TS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new $S(this,this.logger),this.verify=new QS(this,this.logger,this.storage),this.echoClient=new YS(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new tP(this,this.logger,e==null?void 0:e.telemetryEnabled)}static async init(e){const t=new yb(e);await t.initialize();const i=await t.crypto.getClientId();return await t.storage.setItem(XM,i),t}get context(){return fi(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(B1,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(B1)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}};const aP=sP;var oP={};const wb="wc",_b=2,Ab="client",Yd=`${wb}@${_b}:${Ab}:`,id={name:Ab,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},W1="WALLETCONNECT_DEEPLINK_CHOICE",cP="proposal",xb="Proposal expired",hP="session",Na=be.SEVEN_DAYS,fP="engine",br={wc_sessionPropose:{req:{ttl:be.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1104},res:{ttl:be.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1106},res:{ttl:be.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:be.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:be.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1112},res:{ttl:be.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1114},res:{ttl:be.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:be.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:be.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1119}}},nd={min:be.FIVE_MINUTES,max:be.SEVEN_DAYS},mn={idle:"IDLE",active:"ACTIVE"},uP="request",dP=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],lP="wc",pP="auth",gP="authKeys",vP="pairingTopics",bP="requests",bf=`${lP}@${1.5}:${pP}:`,qh=`${bf}:PUB_KEY`;var mP=Object.defineProperty,yP=Object.defineProperties,wP=Object.getOwnPropertyDescriptors,Q1=Object.getOwnPropertySymbols,_P=Object.prototype.hasOwnProperty,AP=Object.prototype.propertyIsEnumerable,Y1=(r,e,t)=>e in r?mP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zt=(r,e)=>{for(var t in e||(e={}))_P.call(e,t)&&Y1(r,t,e[t]);if(Q1)for(var t of Q1(e))AP.call(e,t)&&Y1(r,t,e[t]);return r},nn=(r,e)=>yP(r,wP(e));class xP extends uE{constructor(e){super(e),this.name=fP,this.events=new Pd,this.initialized=!1,this.requestQueue={state:mn.idle,queue:[]},this.sessionRequestQueue={state:mn.idle,queue:[]},this.requestQueueDelay=be.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(br)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},be.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=nn(Zt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:p,relays:m}=i;let v=s,_,I=!1;try{v&&(I=this.client.core.pairing.pairings.get(v).active)}catch(oe){throw this.client.logger.error(`connect() -> pairing.get(${v}) failed`),oe}if(!v||!I){const{topic:oe,uri:re}=await this.client.core.pairing.create();v=oe,_=re}if(!v){const{message:oe}=pe("NO_MATCHING_KEY",`connect() pairing topic: ${v}`);throw new Error(oe)}const N=await this.client.core.crypto.generateKeyPair(),O=br.wc_sessionPropose.req.ttl||be.FIVE_MINUTES,q=lr(O),j=Zt({requiredNamespaces:a,optionalNamespaces:h,relays:m??[{protocol:pb}],proposer:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:q,pairingTopic:v},p&&{sessionProperties:p}),{reject:K,resolve:J,done:Z}=Js(O,xb);this.events.once(It("session_connect"),async({error:oe,session:re})=>{if(oe)K(oe);else if(re){re.self.publicKey=N;const fe=nn(Zt({},re),{pairingTopic:j.pairingTopic,requiredNamespaces:j.requiredNamespaces,optionalNamespaces:j.optionalNamespaces,transportType:Kt.relay});await this.client.session.set(re.topic,fe),await this.setExpiry(re.topic,re.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:re.peer.metadata}),this.cleanupDuplicatePairings(fe),J(fe)}});const de=await this.sendRequest({topic:v,method:"wc_sessionPropose",params:j,throwOnFailedPublish:!0});return await this.setProposal(de,Zt({id:de},j)),{uri:_,approval:Z}},this.pair=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async t=>{var i,s,a;const h=this.client.core.eventClient.createEvent({properties:{topic:(i=t==null?void 0:t.id)==null?void 0:i.toString(),trace:[rn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(le){throw h.setError(Vs.no_internet_connection),le}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(le){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),h.setError(Vs.proposal_not_found),le}try{await this.isValidApprove(t)}catch(le){throw this.client.logger.error("approve() -> isValidApprove() failed"),h.setError(Vs.session_approve_namespace_validation_failure),le}const{id:p,relayProtocol:m,namespaces:v,sessionProperties:_,sessionConfig:I}=t,N=this.client.proposal.get(p);this.client.core.eventClient.deleteEvent({eventId:h.eventId});const{pairingTopic:O,proposer:q,requiredNamespaces:j,optionalNamespaces:K}=N;let J=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:O});J||(J=(a=this.client.core.eventClient)==null?void 0:a.createEvent({type:rn.session_approve_started,properties:{topic:O,trace:[rn.session_approve_started,rn.session_namespaces_validation_success]}}));const Z=await this.client.core.crypto.generateKeyPair(),de=q.publicKey,oe=await this.client.core.crypto.generateSharedKey(Z,de),re=Zt(Zt({relay:{protocol:m??"irn"},namespaces:v,controller:{publicKey:Z,metadata:this.client.metadata},expiry:lr(Na)},_&&{sessionProperties:_}),I&&{sessionConfig:I}),fe=Kt.relay;J.addTrace(rn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(oe,{transportType:fe})}catch(le){throw J.setError(Vs.subscribe_session_topic_failure),le}J.addTrace(rn.subscribe_session_topic_success);const ue=nn(Zt({},re),{topic:oe,requiredNamespaces:j,optionalNamespaces:K,pairingTopic:O,acknowledged:!1,self:re.controller,peer:{publicKey:q.publicKey,metadata:q.metadata},controller:Z,transportType:Kt.relay});await this.client.session.set(oe,ue),J.addTrace(rn.store_session);try{J.addTrace(rn.publishing_session_settle),await this.sendRequest({topic:oe,method:"wc_sessionSettle",params:re,throwOnFailedPublish:!0}).catch(le=>{throw J==null||J.setError(Vs.session_settle_publish_failure),le}),J.addTrace(rn.session_settle_publish_success),J.addTrace(rn.publishing_session_approve),await this.sendResult({id:p,topic:O,result:{relay:{protocol:m??"irn"},responderPublicKey:Z},throwOnFailedPublish:!0}).catch(le=>{throw J==null||J.setError(Vs.session_approve_publish_failure),le}),J.addTrace(rn.session_approve_publish_success)}catch(le){throw this.client.logger.error(le),this.client.session.delete(oe,kt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(oe),le}return this.client.core.eventClient.deleteEvent({eventId:J.eventId}),await this.client.core.pairing.updateMetadata({topic:O,metadata:q.metadata}),await this.client.proposal.delete(p,kt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:O}),await this.setExpiry(oe,lr(Na)),{topic:oe,acknowledged:()=>Promise.resolve(this.client.session.get(oe))}},this.reject=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(h){throw this.client.logger.error("reject() -> isValidReject() failed"),h}const{id:i,reason:s}=t;let a;try{a=this.client.proposal.get(i).pairingTopic}catch(h){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),h}a&&(await this.sendError({id:i,topic:a,error:s,rpcOpts:br.wc_sessionPropose.reject}),await this.client.proposal.delete(i,kt("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(I){throw this.client.logger.error("update() -> isValidUpdate() failed"),I}const{topic:i,namespaces:s}=t,{done:a,resolve:h,reject:p}=Js(),m=As(),v=Ws().toString(),_=this.client.session.get(i).namespaces;return this.events.once(It("session_update",m),({error:I})=>{I?p(I):h()}),await this.client.session.update(i,{namespaces:s}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:m,relayRpcId:v}).catch(I=>{this.client.logger.error(I),this.client.session.update(i,{namespaces:_}),p(I)}),{acknowledged:a}},this.extend=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(m){throw this.client.logger.error("extend() -> isValidExtend() failed"),m}const{topic:i}=t,s=As(),{done:a,resolve:h,reject:p}=Js();return this.events.once(It("session_extend",s),({error:m})=>{m?p(m):h()}),await this.setExpiry(i,lr(Na)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(m=>{p(m)}),{acknowledged:a}},this.request=async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(q){throw this.client.logger.error("request() -> isValidRequest() failed"),q}const{chainId:i,request:s,topic:a,expiry:h=br.wc_sessionRequest.req.ttl}=t,p=this.client.session.get(a);(p==null?void 0:p.transportType)===Kt.relay&&await this.confirmOnlineStateOrThrow();const m=As(),v=Ws().toString(),{done:_,resolve:I,reject:N}=Js(h,"Request expired. Please try again.");this.events.once(It("session_request",m),({error:q,result:j})=>{q?N(q):I(j)});const O=this.getAppLinkIfEnabled(p.peer.metadata,p.transportType);return O?(await this.sendRequest({clientRpcId:m,relayRpcId:v,topic:a,method:"wc_sessionRequest",params:{request:nn(Zt({},s),{expiryTimestamp:lr(h)}),chainId:i},expiry:h,throwOnFailedPublish:!0,appLink:O}).catch(q=>N(q)),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:i,id:m}),await _()):await Promise.all([new Promise(async q=>{await this.sendRequest({clientRpcId:m,relayRpcId:v,topic:a,method:"wc_sessionRequest",params:{request:nn(Zt({},s),{expiryTimestamp:lr(h)}),chainId:i},expiry:h,throwOnFailedPublish:!0}).catch(j=>N(j)),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:i,id:m}),q()}),new Promise(async q=>{var j;if(!((j=p.sessionConfig)!=null&&j.disableDeepLink)){const K=await Q9(this.client.core.storage,W1);W9({id:m,topic:a,wcDeepLink:K})}q()}),_()]).then(q=>q[2])},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:s}=t,{id:a}=s,h=this.client.session.get(i);h.transportType===Kt.relay&&await this.confirmOnlineStateOrThrow();const p=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);wn(s)?await this.sendResult({id:a,topic:i,result:s.result,throwOnFailedPublish:!0,appLink:p}):Bi(s)&&await this.sendError({id:a,topic:i,error:s.error,appLink:p}),this.cleanupAfterResponse(t)},this.ping=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:i}=t;if(this.client.session.keys.includes(i)){const s=As(),a=Ws().toString(),{done:h,resolve:p,reject:m}=Js();this.events.once(It("session_ping",s),({error:v})=>{v?m(v):p()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:a}),h()])}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:i,event:s,chainId:a}=t,h=Ws().toString();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:s,chainId:a},throwOnFailedPublish:!0,relayRpcId:h})},this.disconnect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:i}=t;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:kt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:s}=pe("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(s)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>II(i,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(t,i)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const a=i&&this.client.core.linkModeSupportedApps.includes(i)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),h=a?Kt.link_mode:Kt.relay;h===Kt.relay&&await this.confirmOnlineStateOrThrow();const{chains:p,statement:m="",uri:v,domain:_,nonce:I,type:N,exp:O,nbf:q,methods:j=[],expiry:K}=t,J=[...t.resources||[]],{topic:Z,uri:de}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:h});this.client.logger.info({message:"Generated new pairing",pairing:{topic:Z,uri:de}});const oe=await this.client.core.crypto.generateKeyPair(),re=Th(oe);if(await Promise.all([this.client.auth.authKeys.set(qh,{responseTopic:re,publicKey:oe}),this.client.auth.pairingTopics.set(re,{topic:re,pairingTopic:Z})]),await this.client.core.relayer.subscribe(re,{transportType:h}),this.client.logger.info(`sending request to new pairing topic: ${Z}`),j.length>0){const{namespace:S}=Ko(p[0]);let x=Kx(S,"request",j);Oh(J)&&(x=Vx(x,J.pop())),J.push(x)}const fe=K&&K>br.wc_sessionAuthenticate.req.ttl?K:br.wc_sessionAuthenticate.req.ttl,ue={authPayload:{type:N??"caip122",chains:p,statement:m,aud:v,domain:_,version:"1",nonce:I,iat:new Date().toISOString(),exp:O,nbf:q,resources:J},requester:{publicKey:oe,metadata:this.client.metadata},expiryTimestamp:lr(fe)},le={eip155:{chains:p,methods:[...new Set(["personal_sign",...j])],events:["chainChanged","accountsChanged"]}},Ae={requiredNamespaces:{},optionalNamespaces:le,relays:[{protocol:"irn"}],pairingTopic:Z,proposer:{publicKey:oe,metadata:this.client.metadata},expiryTimestamp:lr(br.wc_sessionPropose.req.ttl)},{done:ht,resolve:k,reject:b}=Js(fe,"Request expired"),c=async({error:S,session:x})=>{if(this.events.off(It("session_request",g),d),S)b(S);else if(x){x.self.publicKey=oe,await this.client.session.set(x.topic,x),await this.setExpiry(x.topic,x.expiry),Z&&await this.client.core.pairing.updateMetadata({topic:Z,metadata:x.peer.metadata});const u=this.client.session.get(x.topic);await this.deleteProposal(A),k({session:u})}},d=async S=>{var x,u,l;if(await this.deletePendingAuthRequest(g,{message:"fulfilled",code:0}),S.error){const L=kt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return S.error.code===L.code?void 0:(this.events.off(It("session_connect"),c),b(S.error.message))}await this.deleteProposal(A),this.events.off(It("session_connect"),c);const{cacaos:R,responder:X}=S.result,ee=[],E=[];for(const L of R){await l1({cacao:L,projectId:this.client.core.projectId})||(this.client.logger.error(L,"Signature verification failed"),b(kt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:z}=L,y=Oh(z.resources),$=[d1(z.iss)],Y=Jh(z.iss);if(y){const se=p1(y),ae=g1(y);ee.push(...se),$.push(...ae)}for(const se of $)E.push(`${se}:${Y}`)}const W=await this.client.core.crypto.generateSharedKey(oe,X.publicKey);let D;ee.length>0&&(D={topic:W,acknowledged:!0,self:{publicKey:oe,metadata:this.client.metadata},peer:X,controller:X.publicKey,expiry:lr(Na),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:Z,namespaces:x1([...new Set(ee)],[...new Set(E)]),transportType:h},await this.client.core.relayer.subscribe(W,{transportType:h}),await this.client.session.set(W,D),Z&&await this.client.core.pairing.updateMetadata({topic:Z,metadata:X.metadata}),D=this.client.session.get(W)),(x=this.client.metadata.redirect)!=null&&x.linkMode&&(u=X.metadata.redirect)!=null&&u.linkMode&&(l=X.metadata.redirect)!=null&&l.universal&&i&&(this.client.core.addLinkModeSupportedApp(X.metadata.redirect.universal),this.client.session.update(W,{transportType:Kt.link_mode})),k({auths:R,session:D})},g=As(),A=As();this.events.once(It("session_connect"),c),this.events.once(It("session_request",g),d);let M;try{if(a){const S=Qs("wc_sessionAuthenticate",ue,g);this.client.core.history.set(Z,S);const x=await this.client.core.crypto.encode("",S,{type:hc,encoding:Oo});M=_h(i,Z,x)}else await Promise.all([this.sendRequest({topic:Z,method:"wc_sessionAuthenticate",params:ue,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:g}),this.sendRequest({topic:Z,method:"wc_sessionPropose",params:Ae,expiry:br.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:A})])}catch(S){throw this.events.off(It("session_connect"),c),this.events.off(It("session_request",g),d),S}return await this.setProposal(A,Zt({id:A},Ae)),await this.setAuthRequest(g,{request:nn(Zt({},ue),{verifyContext:{}}),pairingTopic:Z,transportType:h}),{uri:M??de,response:ht}},this.approveSessionAuthenticate=async t=>{const{id:i,auths:s}=t,a=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[Gs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(K){throw a.setError(Do.no_internet_connection),K}const h=this.getPendingAuthRequest(i);if(!h)throw a.setError(Do.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const p=h.transportType||Kt.relay;p===Kt.relay&&await this.confirmOnlineStateOrThrow();const m=h.requester.publicKey,v=await this.client.core.crypto.generateKeyPair(),_=Th(m),I={type:ss,receiverPublicKey:m,senderPublicKey:v},N=[],O=[];for(const K of s){if(!await l1({cacao:K,projectId:this.client.core.projectId})){a.setError(Do.invalid_cacao);const re=kt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:_,error:re,encodeOpts:I}),new Error(re.message)}a.addTrace(Gs.cacaos_verified);const{p:J}=K,Z=Oh(J.resources),de=[d1(J.iss)],oe=Jh(J.iss);if(Z){const re=p1(Z),fe=g1(Z);N.push(...re),de.push(...fe)}for(const re of de)O.push(`${re}:${oe}`)}const q=await this.client.core.crypto.generateSharedKey(v,m);a.addTrace(Gs.create_authenticated_session_topic);let j;if((N==null?void 0:N.length)>0){j={topic:q,acknowledged:!0,self:{publicKey:v,metadata:this.client.metadata},peer:{publicKey:m,metadata:h.requester.metadata},controller:m,expiry:lr(Na),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:h.pairingTopic,namespaces:x1([...new Set(N)],[...new Set(O)]),transportType:p},a.addTrace(Gs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(q,{transportType:p})}catch(K){throw a.setError(Do.subscribe_authenticated_session_topic_failure),K}a.addTrace(Gs.subscribe_authenticated_session_topic_success),await this.client.session.set(q,j),a.addTrace(Gs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:h.requester.metadata})}a.addTrace(Gs.publishing_authenticated_session_approve);try{await this.sendResult({topic:_,id:i,result:{cacaos:s,responder:{publicKey:v,metadata:this.client.metadata}},encodeOpts:I,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(h.requester.metadata,p)})}catch(K){throw a.setError(Do.authenticated_session_approve_publish_failure),K}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:h.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:a.eventId}),{session:j}},this.rejectSessionAuthenticate=async t=>{this.isInitialized();const{id:i,reason:s}=t,a=this.getPendingAuthRequest(i);if(!a)throw new Error(`Could not find pending auth request with id ${i}`);a.transportType===Kt.relay&&await this.confirmOnlineStateOrThrow();const h=a.requester.publicKey,p=await this.client.core.crypto.generateKeyPair(),m=Th(h),v={type:ss,receiverPublicKey:h,senderPublicKey:p};await this.sendError({id:i,topic:m,error:s,encodeOpts:v,rpcOpts:br.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(a.requester.metadata,a.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,kt("USER_DISCONNECTED"))},this.formatAuthMessage=t=>{this.isInitialized();const{request:i,iss:s}=t;return Gv(i,s)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)},this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const i=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(a=>{var h,p;return((h=a.peerMetadata)==null?void 0:h.url)&&((p=a.peerMetadata)==null?void 0:p.url)===t.peer.metadata.url&&a.topic&&a.topic!==i.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async t=>{var i;const{topic:s,expirerHasDeleted:a=!1,emitEvent:h=!0,id:p=0}=t,{self:m}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,kt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(m.publicKey)&&await this.client.core.crypto.deleteKeyPair(m.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),a||this.client.core.expirer.del(s),this.client.core.storage.removeItem(W1).catch(v=>this.client.logger.warn(v)),this.getPendingSessionRequests().forEach(v=>{v.topic===s&&this.deletePendingSessionRequest(v.id,kt("USER_DISCONNECTED"))}),s===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=mn.idle),h&&this.client.events.emit("session_delete",{id:p,topic:s})},this.deleteProposal=async(t,i)=>{if(i)try{const s=this.client.proposal.get(t),a=this.client.core.eventClient.getEvent({topic:s.pairingTopic});a==null||a.setError(Vs.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,kt("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")},this.deletePendingSessionRequest=async(t,i,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(a=>a.id!==t),s&&(this.sessionRequestQueue.state=mn.idle,this.client.events.emit("session_request_expire",{id:t}))},this.deletePendingAuthRequest=async(t,i,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,i),s?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,i),await this.client.session.update(t,{expiry:i}))},this.setProposal=async(t,i)=>{this.client.core.expirer.set(t,lr(br.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,i)},this.setAuthRequest=async(t,i)=>{const{request:s,pairingTopic:a,transportType:h=Kt.relay}=i;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:a,verifyContext:s.verifyContext,transportType:h})},this.setPendingSessionRequest=async t=>{const{id:i,topic:s,params:a,verifyContext:h}=t,p=a.request.expiryTimestamp||lr(br.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,p),await this.client.pendingRequest.set(i,{id:i,topic:s,params:a,verifyContext:h})},this.sendRequest=async t=>{const{topic:i,method:s,params:a,expiry:h,relayRpcId:p,clientRpcId:m,throwOnFailedPublish:v,appLink:_}=t,I=Qs(s,a,m);let N;const O=!!_;try{const K=O?Oo:Ps;N=await this.client.core.crypto.encode(i,I,{encoding:K})}catch(K){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),K}let q;if(dP.includes(s)){const K=ts(JSON.stringify(I)),J=ts(N);q=await this.client.core.verify.register({id:J,decryptedId:K})}const j=br[s].req;if(j.attestation=q,h&&(j.ttl=h),p&&(j.id=p),this.client.core.history.set(i,I),O){const K=_h(_,i,N);await global.Linking.openURL(K,this.client.name)}else{const K=br[s].req;h&&(K.ttl=h),p&&(K.id=p),v?(K.internal=nn(Zt({},K.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,N,K)):this.client.core.relayer.publish(i,N,K).catch(J=>this.client.logger.error(J))}return I.id},this.sendResult=async t=>{const{id:i,topic:s,result:a,throwOnFailedPublish:h,encodeOpts:p,appLink:m}=t,v=tf(i,a);let _;const I=m&&typeof(global==null?void 0:global.Linking)<"u";try{const O=I?Oo:Ps;_=await this.client.core.crypto.encode(s,v,nn(Zt({},p||{}),{encoding:O}))}catch(O){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),O}let N;try{N=await this.client.core.history.get(s,i)}catch(O){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${i}) failed`),O}if(I){const O=_h(m,s,_);await global.Linking.openURL(O,this.client.name)}else{const O=br[N.request.method].res;h?(O.internal=nn(Zt({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,_,O)):this.client.core.relayer.publish(s,_,O).catch(q=>this.client.logger.error(q))}await this.client.core.history.resolve(v)},this.sendError=async t=>{const{id:i,topic:s,error:a,encodeOpts:h,rpcOpts:p,appLink:m}=t,v=rf(i,a);let _;const I=m&&typeof(global==null?void 0:global.Linking)<"u";try{const O=I?Oo:Ps;_=await this.client.core.crypto.encode(s,v,nn(Zt({},h||{}),{encoding:O}))}catch(O){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),O}let N;try{N=await this.client.core.history.get(s,i)}catch(O){throw this.client.logger.error(`sendError() -> history.get(${s}, ${i}) failed`),O}if(I){const O=_h(m,s,_);await global.Linking.openURL(O,this.client.name)}else{const O=p||br[N.request.method].res;this.client.core.relayer.publish(s,_,O)}await this.client.core.history.resolve(v)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(s=>{let a=!1;xs(s.expiry)&&(a=!0),this.client.core.crypto.keychain.has(s.topic)||(a=!0),a&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{xs(s.expiryTimestamp)&&i.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...i.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===mn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=mn.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=mn.idle},this.processRequest=async t=>{const{topic:i,payload:s,attestation:a,transportType:h,encryptedId:p}=t,m=s.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:m}))switch(m){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:s,attestation:a,encryptedId:p});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,s);case"wc_sessionPing":return await this.onSessionPingRequest(i,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:s,attestation:a,encryptedId:p,transportType:h});case"wc_sessionEvent":return await this.onSessionEventRequest(i,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:s,attestation:a,encryptedId:p,transportType:h});default:return this.client.logger.info(`Unsupported request method ${m}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:s,transportType:a}=t,h=(await this.client.core.history.get(i,s.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(i,s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(i,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,s);case"wc_sessionExtend":return this.onSessionExtendResponse(i,s);case"wc_sessionPing":return this.onSessionPingResponse(i,s);case"wc_sessionRequest":return this.onSessionRequestResponse(i,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,s);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:i}=t,{message:s}=pe("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.shouldIgnorePairingRequest=t=>{const{topic:i,requestMethod:s}=t,a=this.expectedPairingMethodMap.get(i);return!a||a.includes(s)?!1:!!(a.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async t=>{const{topic:i,payload:s,attestation:a,encryptedId:h}=t,{params:p,id:m}=s;try{const v=this.client.core.eventClient.getEvent({topic:i});this.isValidConnect(Zt({},s.params));const _=p.expiryTimestamp||lr(br.wc_sessionPropose.req.ttl),I=Zt({id:m,pairingTopic:i,expiryTimestamp:_},p);await this.setProposal(m,I);const N=await this.getVerifyContext({attestationId:a,hash:ts(JSON.stringify(s)),encryptedId:h,metadata:I.proposer.metadata});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),v==null||v.setError(Zn.proposal_listener_not_found)),v==null||v.addTrace(yn.emit_session_proposal),this.client.events.emit("session_proposal",{id:m,params:I,verifyContext:N})}catch(v){await this.sendError({id:m,topic:i,error:v,rpcOpts:br.wc_sessionPropose.autoReject}),this.client.logger.error(v)}},this.onSessionProposeResponse=async(t,i,s)=>{const{id:a}=i;if(wn(i)){const{result:h}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const m=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:m});const v=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const _=await this.client.core.crypto.generateSharedKey(m,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:_});const I=await this.client.core.relayer.subscribe(_,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:t})}else if(Bi(i)){await this.client.proposal.delete(a,kt("USER_DISCONNECTED"));const h=It("session_connect");if(this.events.listenerCount(h)===0)throw new Error(`emitting ${h} without any listeners, 954`);this.events.emit(It("session_connect"),{error:i.error})}},this.onSessionSettleRequest=async(t,i)=>{const{id:s,params:a}=i;try{this.isValidSessionSettleRequest(a);const{relay:h,controller:p,expiry:m,namespaces:v,sessionProperties:_,sessionConfig:I}=i.params,N=nn(Zt(Zt({topic:t,relay:h,expiry:m,namespaces:v,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},_&&{sessionProperties:_}),I&&{sessionConfig:I}),{transportType:Kt.relay}),O=It("session_connect");if(this.events.listenerCount(O)===0)throw new Error(`emitting ${O} without any listeners 997`);this.events.emit(It("session_connect"),{session:N}),await this.sendResult({id:i.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(h){await this.sendError({id:s,topic:t,error:h}),this.client.logger.error(h)}},this.onSessionSettleResponse=async(t,i)=>{const{id:s}=i;wn(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(It("session_approve",s),{})):Bi(i)&&(await this.client.session.delete(t,kt("USER_DISCONNECTED")),this.events.emit(It("session_approve",s),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:s,id:a}=i;try{const h=`${t}_session_update`,p=To.get(h);if(p&&this.isRequestOutOfSync(p,a)){this.client.logger.info(`Discarding out of sync request - ${a}`),this.sendError({id:a,topic:t,error:kt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Zt({topic:t},s));try{To.set(h,a),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:a,topic:t,result:!0,throwOnFailedPublish:!0})}catch(m){throw To.delete(h),m}this.client.events.emit("session_update",{id:a,topic:t,params:s})}catch(h){await this.sendError({id:a,topic:t,error:h}),this.client.logger.error(h)}},this.isRequestOutOfSync=(t,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,i)=>{const{id:s}=i,a=It("session_update",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);wn(i)?this.events.emit(It("session_update",s),{}):Bi(i)&&this.events.emit(It("session_update",s),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:s}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,lr(Na)),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(a){await this.sendError({id:s,topic:t,error:a}),this.client.logger.error(a)}},this.onSessionExtendResponse=(t,i)=>{const{id:s}=i,a=It("session_extend",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);wn(i)?this.events.emit(It("session_extend",s),{}):Bi(i)&&this.events.emit(It("session_extend",s),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:s}=i;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(a){await this.sendError({id:s,topic:t,error:a}),this.client.logger.error(a)}},this.onSessionPingResponse=(t,i)=>{const{id:s}=i,a=It("session_ping",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);setTimeout(()=>{wn(i)?this.events.emit(It("session_ping",s),{}):Bi(i)&&this.events.emit(It("session_ping",s),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),Promise.all([new Promise(a=>{this.client.core.relayer.once(Fr.publish,async()=>{a(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:kt("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}},this.onSessionRequest=async t=>{var i,s,a;const{topic:h,payload:p,attestation:m,encryptedId:v,transportType:_}=t,{id:I,params:N}=p;try{await this.isValidRequest(Zt({topic:h},N));const O=this.client.session.get(h),q=await this.getVerifyContext({attestationId:m,hash:ts(JSON.stringify(Qs("wc_sessionRequest",N,I))),encryptedId:v,metadata:O.peer.metadata,transportType:_}),j={id:I,topic:h,params:N,verifyContext:q};await this.setPendingSessionRequest(j),_===Kt.link_mode&&(i=O.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((s=O.peer.metadata.redirect)==null?void 0:s.universal),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(j):(this.addSessionRequestToSessionRequestQueue(j),this.processSessionRequestQueue())}catch(O){await this.sendError({id:I,topic:h,error:O}),this.client.logger.error(O)}},this.onSessionRequestResponse=(t,i)=>{const{id:s}=i,a=It("session_request",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);wn(i)?this.events.emit(It("session_request",s),{result:i.result}):Bi(i)&&this.events.emit(It("session_request",s),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:s,params:a}=i;try{const h=`${t}_session_event_${a.event.name}`,p=To.get(h);if(p&&this.isRequestOutOfSync(p,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Zt({topic:t},a)),this.client.events.emit("session_event",{id:s,topic:t,params:a}),To.set(h,s)}catch(h){await this.sendError({id:s,topic:t,error:h}),this.client.logger.error(h)}},this.onSessionAuthenticateResponse=(t,i)=>{const{id:s}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:i}),wn(i)?this.events.emit(It("session_request",s),{result:i.result}):Bi(i)&&this.events.emit(It("session_request",s),{error:i.error})},this.onSessionAuthenticateRequest=async t=>{var i;const{topic:s,payload:a,attestation:h,encryptedId:p,transportType:m}=t;try{const{requester:v,authPayload:_,expiryTimestamp:I}=a.params,N=await this.getVerifyContext({attestationId:h,hash:ts(JSON.stringify(a)),encryptedId:p,metadata:v.metadata,transportType:m}),O={requester:v,pairingTopic:s,id:a.id,authPayload:_,verifyContext:N,expiryTimestamp:I};await this.setAuthRequest(a.id,{request:O,pairingTopic:s,transportType:m}),m===Kt.link_mode&&(i=v.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(v.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:a.params,id:a.id,verifyContext:N})}catch(v){this.client.logger.error(v);const _=a.params.requester.publicKey,I=await this.client.core.crypto.generateKeyPair(),N=this.getAppLinkIfEnabled(a.params.requester.metadata,m),O={type:ss,receiverPublicKey:_,senderPublicKey:I};await this.sendError({id:a.id,topic:s,error:v,encodeOpts:O,rpcOpts:br.wc_sessionAuthenticate.autoReject,appLink:N})}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=mn.idle,this.processSessionRequestQueue()},be.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:i})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(a=>a.topic===t&&a.request.method==="wc_sessionRequest").forEach(a=>{const h=a.request.id,p=It("session_request",h);if(this.events.listenerCount(p)===0)throw new Error(`emitting ${p} without any listeners`);this.events.emit(It("session_request",a.request.id),{error:i})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===mn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=mn.active,this.emitSessionRequest(t)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=t=>{this.client.events.emit("session_request",t)},this.onPairingCreated=t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const i=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);i&&this.onSessionProposeRequest({topic:t.topic,payload:Qs("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})},this.isValidConnect=async t=>{if(!ni(t)){const{message:m}=pe("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(m)}const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:h,relays:p}=t;if(ai(i)||await this.isValidPairingTopic(i),!BI(p)){const{message:m}=pe("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(m)}!ai(s)&&Zo(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!ai(a)&&Zo(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),ai(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(t,i)=>{const s=DI(t,"connect()",i);if(s)throw new Error(s.message)},this.isValidApprove=async t=>{if(!ni(t))throw new Error(pe("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:s,relayProtocol:a,sessionProperties:h}=t;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const p=this.client.proposal.get(i),m=Zu(s,"approve()");if(m)throw new Error(m.message);const v=M1(p.requiredNamespaces,s,"approve()");if(v)throw new Error(v.message);if(!ar(a,!0)){const{message:_}=pe("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(_)}ai(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async t=>{if(!ni(t)){const{message:a}=pe("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(a)}const{id:i,reason:s}=t;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!kI(s)){const{message:a}=pe("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidSessionSettleRequest=t=>{if(!ni(t)){const{message:v}=pe("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(v)}const{relay:i,controller:s,namespaces:a,expiry:h}=t;if(!tb(i)){const{message:v}=pe("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(v)}const p=RI(s,"onSessionSettleRequest()");if(p)throw new Error(p.message);const m=Zu(a,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(xs(h)){const{message:v}=pe("EXPIRED","onSessionSettleRequest()");throw new Error(v)}},this.isValidUpdate=async t=>{if(!ni(t)){const{message:m}=pe("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(m)}const{topic:i,namespaces:s}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const a=this.client.session.get(i),h=Zu(s,"update()");if(h)throw new Error(h.message);const p=M1(a.requiredNamespaces,s,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!ni(t)){const{message:s}=pe("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:i}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!ni(t)){const{message:m}=pe("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(m)}const{topic:i,request:s,chainId:a,expiry:h}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:p}=this.client.session.get(i);if(!E1(p,a)){const{message:m}=pe("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(m)}if(!LI(s)){const{message:m}=pe("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(m)}if(!jI(p,a,s.method)){const{message:m}=pe("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(m)}if(h&&!VI(h,nd)){const{message:m}=pe("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${nd.min} and ${nd.max}`);throw new Error(m)}},this.isValidRespond=async t=>{var i;if(!ni(t)){const{message:h}=pe("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(h)}const{topic:s,response:a}=t;try{await this.isValidSessionTopic(s)}catch(h){throw(i=t==null?void 0:t.response)!=null&&i.id&&this.cleanupAfterResponse(t),h}if(!zI(a)){const{message:h}=pe("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async t=>{if(!ni(t)){const{message:s}=pe("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!ni(t)){const{message:p}=pe("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:i,event:s,chainId:a}=t;await this.isValidSessionTopic(i);const{namespaces:h}=this.client.session.get(i);if(!E1(h,a)){const{message:p}=pe("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(p)}if(!UI(s)){const{message:p}=pe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(p)}if(!FI(h,a,s.name)){const{message:p}=pe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!ni(t)){const{message:s}=pe("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidAuthenticate=t=>{const{chains:i,uri:s,domain:a,nonce:h}=t;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!ar(s,!1))throw new Error("uri is required parameter");if(!ar(a,!1))throw new Error("domain is required parameter");if(!ar(h,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(m=>Ko(m).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:p}=Ko(i[0]);if(p!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async t=>{const{attestationId:i,hash:s,encryptedId:a,metadata:h,transportType:p}=t,m={verified:{verifyUrl:h.verifyUrl||Jo,validation:"UNKNOWN",origin:h.url||""}};try{if(p===Kt.link_mode){const _=this.getAppLinkIfEnabled(h,p);return m.verified.validation=_&&new URL(_).origin===new URL(h.url).origin?"VALID":"INVALID",m}const v=await this.client.core.verify.resolve({attestationId:i,hash:s,encryptedId:a,verifyUrl:h.verifyUrl});v&&(m.verified.origin=v.origin,m.verified.isScam=v.isScam,m.verified.validation=v.origin===new URL(h.url).origin?"VALID":"INVALID")}catch(v){this.client.logger.warn(v)}return this.client.logger.debug(`Verify context: ${JSON.stringify(m)}`),m},this.validateSessionProps=(t,i)=>{Object.values(t).forEach(s=>{if(!ar(s,!1)){const{message:a}=pe("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(a)}})},this.getPendingAuthRequest=t=>{const i=this.client.auth.requests.get(t);return typeof i=="object"?i:void 0},this.addToRecentlyDeleted=(t,i)=>{if(this.recentlyDeletedMap.set(t,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const a=this.recentlyDeletedLimit/2;for(const h of this.recentlyDeletedMap.keys()){if(s++>=a)break;this.recentlyDeletedMap.delete(h)}}},this.checkRecentlyDeleted=t=>{const i=this.recentlyDeletedMap.get(t);if(i){const{message:s}=pe("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${t}`);throw new Error(s)}},this.isLinkModeEnabled=(t,i)=>{var s,a,h,p,m,v,_,I,N;return!t||i!==Kt.link_mode?!1:((a=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:a.linkMode)===!0&&((p=(h=this.client.metadata)==null?void 0:h.redirect)==null?void 0:p.universal)!==void 0&&((v=(m=this.client.metadata)==null?void 0:m.redirect)==null?void 0:v.universal)!==""&&((_=t==null?void 0:t.redirect)==null?void 0:_.universal)!==void 0&&((I=t==null?void 0:t.redirect)==null?void 0:I.universal)!==""&&((N=t==null?void 0:t.redirect)==null?void 0:N.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"},this.getAppLinkIfEnabled=(t,i)=>{var s;return this.isLinkModeEnabled(t,i)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0},this.handleLinkModeMessage=({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const i=Up(t,"topic")||"",s=decodeURIComponent(Up(t,"wc_ev")||""),a=this.client.session.keys.includes(i);a&&this.client.session.update(i,{transportType:Kt.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:s,sessionExists:a})},this.registerLinkModeListeners=async()=>{var t;if(typeof process<"u"&&oP.IS_VITEST||Za()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const i=global==null?void 0:global.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await i.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}}isInitialized(){if(!this.initialized){const{message:e}=pe("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Fr.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:t,message:i,attestation:s,transportType:a}=e,{publicKey:h}=this.client.auth.authKeys.keys.includes(qh)?this.client.auth.authKeys.get(qh):{responseTopic:void 0,publicKey:void 0},p=await this.client.core.crypto.decode(t,i,{receiverPublicKey:h,encoding:a===Kt.link_mode?Oo:Ps});try{Td(p)?(this.client.core.history.set(t,p),this.onRelayEventRequest({topic:t,payload:p,attestation:s,transportType:a,encryptedId:ts(i)})):nf(p)?(await this.client.core.history.resolve(p),await this.onRelayEventResponse({topic:t,payload:p,transportType:a}),this.client.core.history.delete(t,p.id)):this.onRelayEventUnknownPayload({topic:t,payload:p,transportType:a})}catch(m){this.client.logger.error(m)}}registerExpirerEvents(){this.client.core.expirer.on(qi.expired,async e=>{const{topic:t,id:i}=uv(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,pe("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,pe("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Da.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Da.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!ar(e,!1)){const{message:t}=pe("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=pe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(xs(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=pe("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!ar(e,!1)){const{message:t}=pe("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=pe("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(xs(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=pe("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=pe("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(ar(e,!1)){const{message:t}=pe("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=pe("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!$I(e)){const{message:t}=pe("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=pe("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(xs(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=pe("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class IP extends fa{constructor(e,t){super(e,t,cP,Yd),this.core=e,this.logger=t}}class EP extends fa{constructor(e,t){super(e,t,hP,Yd),this.core=e,this.logger=t}}class MP extends fa{constructor(e,t){super(e,t,uP,Yd,i=>i.id),this.core=e,this.logger=t}}class SP extends fa{constructor(e,t){super(e,t,gP,bf,()=>qh),this.core=e,this.logger=t}}class PP extends fa{constructor(e,t){super(e,t,vP,bf),this.core=e,this.logger=t}}class RP extends fa{constructor(e,t){super(e,t,bP,bf,i=>i.id),this.core=e,this.logger=t}}class NP{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new SP(this.core,this.logger),this.pairingTopics=new PP(this.core,this.logger),this.requests=new RP(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}let CP=class Ib extends fE{constructor(e){super(e),this.protocol=wb,this.version=_b,this.name=id.name,this.events=new Li.EventEmitter,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(s){throw this.logger.error(s.message),s}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(s){throw this.logger.error(s.message),s}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(s){throw this.logger.error(s.message),s}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(s){throw this.logger.error(s.message),s}},this.update=async i=>{try{return await this.engine.update(i)}catch(s){throw this.logger.error(s.message),s}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(s){throw this.logger.error(s.message),s}},this.request=async i=>{try{return await this.engine.request(i)}catch(s){throw this.logger.error(s.message),s}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(s){throw this.logger.error(s.message),s}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(s){throw this.logger.error(s.message),s}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(s){throw this.logger.error(s.message),s}},this.find=i=>{try{return this.engine.find(i)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async(i,s)=>{try{return await this.engine.authenticate(i,s)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(s){throw this.logger.error(s.message),s}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(s){throw this.logger.error(s.message),s}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||id.name,this.metadata=(e==null?void 0:e.metadata)||j9(),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ec(Zh({level:(e==null?void 0:e.logger)||id.logger}));this.core=(e==null?void 0:e.core)||new aP(e),this.logger=Gr(t,this.name),this.session=new EP(this.core,this.logger),this.proposal=new IP(this.core,this.logger),this.pendingRequest=new MP(this.core,this.logger),this.engine=new xP(this),this.auth=new NP(this.core,this.logger)}static async init(e){const t=new Ib(e);return await t.initialize(),t}get context(){return fi(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const X1="error",OP="wss://relay.walletconnect.com",TP="wc",qP="universal_provider",Z1=`${TP}@2:${qP}:`,DP="https://rpc.walletconnect.com/v1/",Oa="generic",dn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ed={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(r,e){(function(){var t,i="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",p="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",v=500,_="__lodash_placeholder__",I=1,N=2,O=4,q=1,j=2,K=1,J=2,Z=4,de=8,oe=16,re=32,fe=64,ue=128,le=256,Ae=512,ht=30,k="...",b=800,c=16,d=1,g=2,A=3,M=1/0,S=9007199254740991,x=17976931348623157e292,u=NaN,l=4294967295,R=l-1,X=l>>>1,ee=[["ary",ue],["bind",K],["bindKey",J],["curry",de],["curryRight",oe],["flip",Ae],["partial",re],["partialRight",fe],["rearg",le]],E="[object Arguments]",W="[object Array]",D="[object AsyncFunction]",L="[object Boolean]",z="[object Date]",y="[object DOMException]",$="[object Error]",Y="[object Function]",se="[object GeneratorFunction]",ae="[object Map]",ge="[object Number]",ve="[object Null]",Te="[object Object]",nt="[object Promise]",Me="[object Proxy]",Ve="[object RegExp]",ke="[object Set]",_e="[object String]",je="[object Symbol]",Ge="[object Undefined]",me="[object WeakMap]",Fe="[object WeakSet]",De="[object ArrayBuffer]",we="[object DataView]",We="[object Float32Array]",Le="[object Float64Array]",Pe="[object Int8Array]",ot="[object Int16Array]",ft="[object Int32Array]",qe="[object Uint8Array]",ct="[object Uint8ClampedArray]",ut="[object Uint16Array]",Be="[object Uint32Array]",wt=/\b__p \+= '';/g,dt=/\b(__p \+=) '' \+/g,ze=/(__e\(.*?\)|\b__t\)) \+\n'';/g,At=/&(?:amp|lt|gt|quot|#39);/g,Et=/[&<>"']/g,xe=RegExp(At.source),Ke=RegExp(Et.source),Qe=/<%-([\s\S]+?)%>/g,Ie=/<%([\s\S]+?)%>/g,Je=/<%=([\s\S]+?)%>/g,He=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Re=/^\w*$/,st=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ye=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(Ye.source),Xe=/^\s+/,et=/\s/,Ee=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ue=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,Ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ot=/[()=,{}\[\]\/\s]/,Tt=/\\(\\)?/g,tt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bt=/\w*$/,Rr=/^[-+]0x[0-9a-f]+$/i,Nr=/^0b[01]+$/i,Cr=/^\[object .+?Constructor\]$/,Or=/^0o[0-7]+$/i,Tr=/^(?:0|[1-9]\d*)$/,Yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Jr=/($^)/,ji=/['\n\r\u2028\u2029\\]/g,Wr="\\ud800-\\udfff",Fi="\\u0300-\\u036f",Ki="\\ufe20-\\ufe2f",Qr="\\u20d0-\\u20ff",_i=Fi+Ki+Qr,Ai="\\u2700-\\u27bf",hr="a-z\\xdf-\\xf6\\xf8-\\xff",Hi="\\xac\\xb1\\xd7\\xf7",Vi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Gi="\\u2000-\\u206f",Cs=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",uc="A-Z\\xc0-\\xd6\\xd8-\\xde",dc="\\ufe0e\\ufe0f",Os=Hi+Vi+Gi+Cs,ao="[']",Ts="["+Wr+"]",oo="["+Os+"]",qs="["+_i+"]",lc="\\d+",mf="["+Ai+"]",pc="["+hr+"]",gc="[^"+Wr+Os+lc+Ai+hr+uc+"]",la="\\ud83c[\\udffb-\\udfff]",yf="(?:"+qs+"|"+la+")",vc="[^"+Wr+"]",pa="(?:\\ud83c[\\udde6-\\uddff]){2}",fs="[\\ud800-\\udbff][\\udc00-\\udfff]",ui="["+uc+"]",bc="\\u200d",mc="(?:"+pc+"|"+gc+")",ln="(?:"+ui+"|"+gc+")",yc="(?:"+ao+"(?:d|ll|m|re|s|t|ve))?",wc="(?:"+ao+"(?:D|LL|M|RE|S|T|VE))?",_c=yf+"?",Ac="["+dc+"]?",wf="(?:"+bc+"(?:"+[vc,pa,fs].join("|")+")"+Ac+_c+")*",jn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xc="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ic=Ac+_c+wf,ga="(?:"+[mf,pa,fs].join("|")+")"+Ic,_f="(?:"+[vc+qs+"?",qs,pa,fs,Ts].join("|")+")",co=RegExp(ao,"g"),Af=RegExp(qs,"g"),va=RegExp(la+"(?="+la+")|"+_f+Ic,"g"),Ec=RegExp([ui+"?"+pc+"+"+yc+"(?="+[oo,ui,"$"].join("|")+")",ln+"+"+wc+"(?="+[oo,ui+mc,"$"].join("|")+")",ui+"?"+mc+"+"+yc,ui+"+"+wc,xc,jn,lc,ga].join("|"),"g"),Mc=RegExp("["+bc+Wr+_i+dc+"]"),Ds=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Sc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],xf=-1,zt={};zt[We]=zt[Le]=zt[Pe]=zt[ot]=zt[ft]=zt[qe]=zt[ct]=zt[ut]=zt[Be]=!0,zt[E]=zt[W]=zt[De]=zt[L]=zt[we]=zt[z]=zt[$]=zt[Y]=zt[ae]=zt[ge]=zt[Te]=zt[Ve]=zt[ke]=zt[_e]=zt[me]=!1;var Lt={};Lt[E]=Lt[W]=Lt[De]=Lt[we]=Lt[L]=Lt[z]=Lt[We]=Lt[Le]=Lt[Pe]=Lt[ot]=Lt[ft]=Lt[ae]=Lt[ge]=Lt[Te]=Lt[Ve]=Lt[ke]=Lt[_e]=Lt[je]=Lt[qe]=Lt[ct]=Lt[ut]=Lt[Be]=!0,Lt[$]=Lt[Y]=Lt[me]=!1;var B={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ce={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Se={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ut=parseFloat,pt=parseInt,Vt=typeof ko=="object"&&ko&&ko.Object===Object&&ko,or=typeof self=="object"&&self&&self.Object===Object&&self,Nt=Vt||or||Function("return this")(),jt=e&&!e.nodeType&&e,rr=jt&&!0&&r&&!r.nodeType&&r,Yr=rr&&rr.exports===jt,cr=Yr&&Vt.process,Gt=function(){try{var V=rr&&rr.require&&rr.require("util").types;return V||cr&&cr.binding&&cr.binding("util")}catch{}}(),kr=Gt&&Gt.isArrayBuffer,Ji=Gt&&Gt.isDate,xi=Gt&&Gt.isMap,pn=Gt&&Gt.isRegExp,ho=Gt&&Gt.isSet,Bs=Gt&&Gt.isTypedArray;function pr(V,te,Q){switch(Q.length){case 0:return V.call(te);case 1:return V.call(te,Q[0]);case 2:return V.call(te,Q[0],Q[1]);case 3:return V.call(te,Q[0],Q[1],Q[2])}return V.apply(te,Q)}function Sb(V,te,Q,Oe){for(var lt=-1,qt=V==null?0:V.length;++lt<qt;){var fr=V[lt];te(Oe,fr,Q(fr),V)}return Oe}function Ii(V,te){for(var Q=-1,Oe=V==null?0:V.length;++Q<Oe&&te(V[Q],Q,V)!==!1;);return V}function Pb(V,te){for(var Q=V==null?0:V.length;Q--&&te(V[Q],Q,V)!==!1;);return V}function el(V,te){for(var Q=-1,Oe=V==null?0:V.length;++Q<Oe;)if(!te(V[Q],Q,V))return!1;return!0}function us(V,te){for(var Q=-1,Oe=V==null?0:V.length,lt=0,qt=[];++Q<Oe;){var fr=V[Q];te(fr,Q,V)&&(qt[lt++]=fr)}return qt}function Pc(V,te){var Q=V==null?0:V.length;return!!Q&&ba(V,te,0)>-1}function If(V,te,Q){for(var Oe=-1,lt=V==null?0:V.length;++Oe<lt;)if(Q(te,V[Oe]))return!0;return!1}function Wt(V,te){for(var Q=-1,Oe=V==null?0:V.length,lt=Array(Oe);++Q<Oe;)lt[Q]=te(V[Q],Q,V);return lt}function ds(V,te){for(var Q=-1,Oe=te.length,lt=V.length;++Q<Oe;)V[lt+Q]=te[Q];return V}function Ef(V,te,Q,Oe){var lt=-1,qt=V==null?0:V.length;for(Oe&&qt&&(Q=V[++lt]);++lt<qt;)Q=te(Q,V[lt],lt,V);return Q}function Rb(V,te,Q,Oe){var lt=V==null?0:V.length;for(Oe&&lt&&(Q=V[--lt]);lt--;)Q=te(Q,V[lt],lt,V);return Q}function Mf(V,te){for(var Q=-1,Oe=V==null?0:V.length;++Q<Oe;)if(te(V[Q],Q,V))return!0;return!1}var Nb=Sf("length");function Cb(V){return V.split("")}function Ob(V){return V.match(Ce)||[]}function tl(V,te,Q){var Oe;return Q(V,function(lt,qt,fr){if(te(lt,qt,fr))return Oe=qt,!1}),Oe}function Rc(V,te,Q,Oe){for(var lt=V.length,qt=Q+(Oe?1:-1);Oe?qt--:++qt<lt;)if(te(V[qt],qt,V))return qt;return-1}function ba(V,te,Q){return te===te?Kb(V,te,Q):Rc(V,rl,Q)}function Tb(V,te,Q,Oe){for(var lt=Q-1,qt=V.length;++lt<qt;)if(Oe(V[lt],te))return lt;return-1}function rl(V){return V!==V}function il(V,te){var Q=V==null?0:V.length;return Q?Rf(V,te)/Q:u}function Sf(V){return function(te){return te==null?t:te[V]}}function Pf(V){return function(te){return V==null?t:V[te]}}function nl(V,te,Q,Oe,lt){return lt(V,function(qt,fr,Ft){Q=Oe?(Oe=!1,qt):te(Q,qt,fr,Ft)}),Q}function qb(V,te){var Q=V.length;for(V.sort(te);Q--;)V[Q]=V[Q].value;return V}function Rf(V,te){for(var Q,Oe=-1,lt=V.length;++Oe<lt;){var qt=te(V[Oe]);qt!==t&&(Q=Q===t?qt:Q+qt)}return Q}function Nf(V,te){for(var Q=-1,Oe=Array(V);++Q<V;)Oe[Q]=te(Q);return Oe}function Db(V,te){return Wt(te,function(Q){return[Q,V[Q]]})}function sl(V){return V&&V.slice(0,hl(V)+1).replace(Xe,"")}function di(V){return function(te){return V(te)}}function Cf(V,te){return Wt(te,function(Q){return V[Q]})}function fo(V,te){return V.has(te)}function al(V,te){for(var Q=-1,Oe=V.length;++Q<Oe&&ba(te,V[Q],0)>-1;);return Q}function ol(V,te){for(var Q=V.length;Q--&&ba(te,V[Q],0)>-1;);return Q}function Bb(V,te){for(var Q=V.length,Oe=0;Q--;)V[Q]===te&&++Oe;return Oe}var $b=Pf(B),kb=Pf(H);function Lb(V){return"\\"+Se[V]}function zb(V,te){return V==null?t:V[te]}function ma(V){return Mc.test(V)}function Ub(V){return Ds.test(V)}function jb(V){for(var te,Q=[];!(te=V.next()).done;)Q.push(te.value);return Q}function Of(V){var te=-1,Q=Array(V.size);return V.forEach(function(Oe,lt){Q[++te]=[lt,Oe]}),Q}function cl(V,te){return function(Q){return V(te(Q))}}function ls(V,te){for(var Q=-1,Oe=V.length,lt=0,qt=[];++Q<Oe;){var fr=V[Q];(fr===te||fr===_)&&(V[Q]=_,qt[lt++]=Q)}return qt}function Nc(V){var te=-1,Q=Array(V.size);return V.forEach(function(Oe){Q[++te]=Oe}),Q}function Fb(V){var te=-1,Q=Array(V.size);return V.forEach(function(Oe){Q[++te]=[Oe,Oe]}),Q}function Kb(V,te,Q){for(var Oe=Q-1,lt=V.length;++Oe<lt;)if(V[Oe]===te)return Oe;return-1}function Hb(V,te,Q){for(var Oe=Q+1;Oe--;)if(V[Oe]===te)return Oe;return Oe}function ya(V){return ma(V)?Gb(V):Nb(V)}function Wi(V){return ma(V)?Jb(V):Cb(V)}function hl(V){for(var te=V.length;te--&&et.test(V.charAt(te)););return te}var Vb=Pf(ce);function Gb(V){for(var te=va.lastIndex=0;va.test(V);)++te;return te}function Jb(V){return V.match(va)||[]}function Wb(V){return V.match(Ec)||[]}var Qb=function V(te){te=te==null?Nt:wa.defaults(Nt.Object(),te,wa.pick(Nt,Sc));var Q=te.Array,Oe=te.Date,lt=te.Error,qt=te.Function,fr=te.Math,Ft=te.Object,Tf=te.RegExp,Yb=te.String,Ei=te.TypeError,Cc=Q.prototype,Xb=qt.prototype,_a=Ft.prototype,Oc=te["__core-js_shared__"],Tc=Xb.toString,$t=_a.hasOwnProperty,Zb=0,fl=function(){var n=/[^.]+$/.exec(Oc&&Oc.keys&&Oc.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),qc=_a.toString,e2=Tc.call(Ft),t2=Nt._,r2=Tf("^"+Tc.call($t).replace(Ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Dc=Yr?te.Buffer:t,ps=te.Symbol,Bc=te.Uint8Array,ul=Dc?Dc.allocUnsafe:t,$c=cl(Ft.getPrototypeOf,Ft),dl=Ft.create,ll=_a.propertyIsEnumerable,kc=Cc.splice,pl=ps?ps.isConcatSpreadable:t,uo=ps?ps.iterator:t,$s=ps?ps.toStringTag:t,Lc=function(){try{var n=js(Ft,"defineProperty");return n({},"",{}),n}catch{}}(),i2=te.clearTimeout!==Nt.clearTimeout&&te.clearTimeout,n2=Oe&&Oe.now!==Nt.Date.now&&Oe.now,s2=te.setTimeout!==Nt.setTimeout&&te.setTimeout,zc=fr.ceil,Uc=fr.floor,qf=Ft.getOwnPropertySymbols,a2=Dc?Dc.isBuffer:t,gl=te.isFinite,o2=Cc.join,c2=cl(Ft.keys,Ft),ur=fr.max,qr=fr.min,h2=Oe.now,f2=te.parseInt,vl=fr.random,u2=Cc.reverse,Df=js(te,"DataView"),lo=js(te,"Map"),Bf=js(te,"Promise"),Aa=js(te,"Set"),po=js(te,"WeakMap"),go=js(Ft,"create"),jc=po&&new po,xa={},d2=Fs(Df),l2=Fs(lo),p2=Fs(Bf),g2=Fs(Aa),v2=Fs(po),Fc=ps?ps.prototype:t,vo=Fc?Fc.valueOf:t,bl=Fc?Fc.toString:t;function C(n){if(Xt(n)&&!gt(n)&&!(n instanceof Mt)){if(n instanceof Mi)return n;if($t.call(n,"__wrapped__"))return m0(n)}return new Mi(n)}var Ia=function(){function n(){}return function(o){if(!Qt(o))return{};if(dl)return dl(o);n.prototype=o;var f=new n;return n.prototype=t,f}}();function Kc(){}function Mi(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=t}C.templateSettings={escape:Qe,evaluate:Ie,interpolate:Je,variable:"",imports:{_:C}},C.prototype=Kc.prototype,C.prototype.constructor=C,Mi.prototype=Ia(Kc.prototype),Mi.prototype.constructor=Mi;function Mt(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=l,this.__views__=[]}function b2(){var n=new Mt(this.__wrapped__);return n.__actions__=Xr(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=Xr(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=Xr(this.__views__),n}function m2(){if(this.__filtered__){var n=new Mt(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function y2(){var n=this.__wrapped__.value(),o=this.__dir__,f=gt(n),w=o<0,P=f?n.length:0,T=Cm(0,P,this.__views__),U=T.start,F=T.end,G=F-U,ie=w?F:U-1,ne=this.__iteratees__,he=ne.length,ye=0,$e=qr(G,this.__takeCount__);if(!f||!w&&P==G&&$e==G)return Ul(n,this.__actions__);var rt=[];e:for(;G--&&ye<$e;){ie+=o;for(var yt=-1,it=n[ie];++yt<he;){var xt=ne[yt],Ct=xt.iteratee,gi=xt.type,Ur=Ct(it);if(gi==g)it=Ur;else if(!Ur){if(gi==d)continue e;break e}}rt[ye++]=it}return rt}Mt.prototype=Ia(Kc.prototype),Mt.prototype.constructor=Mt;function ks(n){var o=-1,f=n==null?0:n.length;for(this.clear();++o<f;){var w=n[o];this.set(w[0],w[1])}}function w2(){this.__data__=go?go(null):{},this.size=0}function _2(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o}function A2(n){var o=this.__data__;if(go){var f=o[n];return f===m?t:f}return $t.call(o,n)?o[n]:t}function x2(n){var o=this.__data__;return go?o[n]!==t:$t.call(o,n)}function I2(n,o){var f=this.__data__;return this.size+=this.has(n)?0:1,f[n]=go&&o===t?m:o,this}ks.prototype.clear=w2,ks.prototype.delete=_2,ks.prototype.get=A2,ks.prototype.has=x2,ks.prototype.set=I2;function Fn(n){var o=-1,f=n==null?0:n.length;for(this.clear();++o<f;){var w=n[o];this.set(w[0],w[1])}}function E2(){this.__data__=[],this.size=0}function M2(n){var o=this.__data__,f=Hc(o,n);if(f<0)return!1;var w=o.length-1;return f==w?o.pop():kc.call(o,f,1),--this.size,!0}function S2(n){var o=this.__data__,f=Hc(o,n);return f<0?t:o[f][1]}function P2(n){return Hc(this.__data__,n)>-1}function R2(n,o){var f=this.__data__,w=Hc(f,n);return w<0?(++this.size,f.push([n,o])):f[w][1]=o,this}Fn.prototype.clear=E2,Fn.prototype.delete=M2,Fn.prototype.get=S2,Fn.prototype.has=P2,Fn.prototype.set=R2;function Kn(n){var o=-1,f=n==null?0:n.length;for(this.clear();++o<f;){var w=n[o];this.set(w[0],w[1])}}function N2(){this.size=0,this.__data__={hash:new ks,map:new(lo||Fn),string:new ks}}function C2(n){var o=ih(this,n).delete(n);return this.size-=o?1:0,o}function O2(n){return ih(this,n).get(n)}function T2(n){return ih(this,n).has(n)}function q2(n,o){var f=ih(this,n),w=f.size;return f.set(n,o),this.size+=f.size==w?0:1,this}Kn.prototype.clear=N2,Kn.prototype.delete=C2,Kn.prototype.get=O2,Kn.prototype.has=T2,Kn.prototype.set=q2;function Ls(n){var o=-1,f=n==null?0:n.length;for(this.__data__=new Kn;++o<f;)this.add(n[o])}function D2(n){return this.__data__.set(n,m),this}function B2(n){return this.__data__.has(n)}Ls.prototype.add=Ls.prototype.push=D2,Ls.prototype.has=B2;function Qi(n){var o=this.__data__=new Fn(n);this.size=o.size}function $2(){this.__data__=new Fn,this.size=0}function k2(n){var o=this.__data__,f=o.delete(n);return this.size=o.size,f}function L2(n){return this.__data__.get(n)}function z2(n){return this.__data__.has(n)}function U2(n,o){var f=this.__data__;if(f instanceof Fn){var w=f.__data__;if(!lo||w.length<s-1)return w.push([n,o]),this.size=++f.size,this;f=this.__data__=new Kn(w)}return f.set(n,o),this.size=f.size,this}Qi.prototype.clear=$2,Qi.prototype.delete=k2,Qi.prototype.get=L2,Qi.prototype.has=z2,Qi.prototype.set=U2;function ml(n,o){var f=gt(n),w=!f&&Ks(n),P=!f&&!w&&ys(n),T=!f&&!w&&!P&&Pa(n),U=f||w||P||T,F=U?Nf(n.length,Yb):[],G=F.length;for(var ie in n)(o||$t.call(n,ie))&&!(U&&(ie=="length"||P&&(ie=="offset"||ie=="parent")||T&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||Jn(ie,G)))&&F.push(ie);return F}function yl(n){var o=n.length;return o?n[Gf(0,o-1)]:t}function j2(n,o){return nh(Xr(n),zs(o,0,n.length))}function F2(n){return nh(Xr(n))}function $f(n,o,f){(f!==t&&!Yi(n[o],f)||f===t&&!(o in n))&&Hn(n,o,f)}function bo(n,o,f){var w=n[o];(!($t.call(n,o)&&Yi(w,f))||f===t&&!(o in n))&&Hn(n,o,f)}function Hc(n,o){for(var f=n.length;f--;)if(Yi(n[f][0],o))return f;return-1}function K2(n,o,f,w){return gs(n,function(P,T,U){o(w,P,f(P),U)}),w}function wl(n,o){return n&&vn(o,gr(o),n)}function H2(n,o){return n&&vn(o,ei(o),n)}function Hn(n,o,f){o=="__proto__"&&Lc?Lc(n,o,{configurable:!0,enumerable:!0,value:f,writable:!0}):n[o]=f}function kf(n,o){for(var f=-1,w=o.length,P=Q(w),T=n==null;++f<w;)P[f]=T?t:mu(n,o[f]);return P}function zs(n,o,f){return n===n&&(f!==t&&(n=n<=f?n:f),o!==t&&(n=n>=o?n:o)),n}function Si(n,o,f,w,P,T){var U,F=o&I,G=o&N,ie=o&O;if(f&&(U=P?f(n,w,P,T):f(n)),U!==t)return U;if(!Qt(n))return n;var ne=gt(n);if(ne){if(U=Tm(n),!F)return Xr(n,U)}else{var he=Dr(n),ye=he==Y||he==se;if(ys(n))return Kl(n,F);if(he==Te||he==E||ye&&!P){if(U=G||ye?{}:h0(n),!F)return G?Am(n,H2(U,n)):_m(n,wl(U,n))}else{if(!Lt[he])return P?n:{};U=qm(n,he,F)}}T||(T=new Qi);var $e=T.get(n);if($e)return $e;T.set(n,U),k0(n)?n.forEach(function(it){U.add(Si(it,o,f,it,n,T))}):B0(n)&&n.forEach(function(it,xt){U.set(xt,Si(it,o,f,xt,n,T))});var rt=ie?G?nu:iu:G?ei:gr,yt=ne?t:rt(n);return Ii(yt||n,function(it,xt){yt&&(xt=it,it=n[xt]),bo(U,xt,Si(it,o,f,xt,n,T))}),U}function V2(n){var o=gr(n);return function(f){return _l(f,n,o)}}function _l(n,o,f){var w=f.length;if(n==null)return!w;for(n=Ft(n);w--;){var P=f[w],T=o[P],U=n[P];if(U===t&&!(P in n)||!T(U))return!1}return!0}function Al(n,o,f){if(typeof n!="function")throw new Ei(h);return Io(function(){n.apply(t,f)},o)}function mo(n,o,f,w){var P=-1,T=Pc,U=!0,F=n.length,G=[],ie=o.length;if(!F)return G;f&&(o=Wt(o,di(f))),w?(T=If,U=!1):o.length>=s&&(T=fo,U=!1,o=new Ls(o));e:for(;++P<F;){var ne=n[P],he=f==null?ne:f(ne);if(ne=w||ne!==0?ne:0,U&&he===he){for(var ye=ie;ye--;)if(o[ye]===he)continue e;G.push(ne)}else T(o,he,w)||G.push(ne)}return G}var gs=Wl(gn),xl=Wl(zf,!0);function G2(n,o){var f=!0;return gs(n,function(w,P,T){return f=!!o(w,P,T),f}),f}function Vc(n,o,f){for(var w=-1,P=n.length;++w<P;){var T=n[w],U=o(T);if(U!=null&&(F===t?U===U&&!pi(U):f(U,F)))var F=U,G=T}return G}function J2(n,o,f,w){var P=n.length;for(f=mt(f),f<0&&(f=-f>P?0:P+f),w=w===t||w>P?P:mt(w),w<0&&(w+=P),w=f>w?0:z0(w);f<w;)n[f++]=o;return n}function Il(n,o){var f=[];return gs(n,function(w,P,T){o(w,P,T)&&f.push(w)}),f}function Ir(n,o,f,w,P){var T=-1,U=n.length;for(f||(f=Bm),P||(P=[]);++T<U;){var F=n[T];o>0&&f(F)?o>1?Ir(F,o-1,f,w,P):ds(P,F):w||(P[P.length]=F)}return P}var Lf=Ql(),El=Ql(!0);function gn(n,o){return n&&Lf(n,o,gr)}function zf(n,o){return n&&El(n,o,gr)}function Gc(n,o){return us(o,function(f){return Wn(n[f])})}function Us(n,o){o=bs(o,n);for(var f=0,w=o.length;n!=null&&f<w;)n=n[bn(o[f++])];return f&&f==w?n:t}function Ml(n,o,f){var w=o(n);return gt(n)?w:ds(w,f(n))}function Lr(n){return n==null?n===t?Ge:ve:$s&&$s in Ft(n)?Nm(n):Fm(n)}function Uf(n,o){return n>o}function W2(n,o){return n!=null&&$t.call(n,o)}function Q2(n,o){return n!=null&&o in Ft(n)}function Y2(n,o,f){return n>=qr(o,f)&&n<ur(o,f)}function jf(n,o,f){for(var w=f?If:Pc,P=n[0].length,T=n.length,U=T,F=Q(T),G=1/0,ie=[];U--;){var ne=n[U];U&&o&&(ne=Wt(ne,di(o))),G=qr(ne.length,G),F[U]=!f&&(o||P>=120&&ne.length>=120)?new Ls(U&&ne):t}ne=n[0];var he=-1,ye=F[0];e:for(;++he<P&&ie.length<G;){var $e=ne[he],rt=o?o($e):$e;if($e=f||$e!==0?$e:0,!(ye?fo(ye,rt):w(ie,rt,f))){for(U=T;--U;){var yt=F[U];if(!(yt?fo(yt,rt):w(n[U],rt,f)))continue e}ye&&ye.push(rt),ie.push($e)}}return ie}function X2(n,o,f,w){return gn(n,function(P,T,U){o(w,f(P),T,U)}),w}function yo(n,o,f){o=bs(o,n),n=l0(n,o);var w=n==null?n:n[bn(Ri(o))];return w==null?t:pr(w,n,f)}function Sl(n){return Xt(n)&&Lr(n)==E}function Z2(n){return Xt(n)&&Lr(n)==De}function em(n){return Xt(n)&&Lr(n)==z}function wo(n,o,f,w,P){return n===o?!0:n==null||o==null||!Xt(n)&&!Xt(o)?n!==n&&o!==o:tm(n,o,f,w,wo,P)}function tm(n,o,f,w,P,T){var U=gt(n),F=gt(o),G=U?W:Dr(n),ie=F?W:Dr(o);G=G==E?Te:G,ie=ie==E?Te:ie;var ne=G==Te,he=ie==Te,ye=G==ie;if(ye&&ys(n)){if(!ys(o))return!1;U=!0,ne=!1}if(ye&&!ne)return T||(T=new Qi),U||Pa(n)?a0(n,o,f,w,P,T):Pm(n,o,G,f,w,P,T);if(!(f&q)){var $e=ne&&$t.call(n,"__wrapped__"),rt=he&&$t.call(o,"__wrapped__");if($e||rt){var yt=$e?n.value():n,it=rt?o.value():o;return T||(T=new Qi),P(yt,it,f,w,T)}}return ye?(T||(T=new Qi),Rm(n,o,f,w,P,T)):!1}function rm(n){return Xt(n)&&Dr(n)==ae}function Ff(n,o,f,w){var P=f.length,T=P,U=!w;if(n==null)return!T;for(n=Ft(n);P--;){var F=f[P];if(U&&F[2]?F[1]!==n[F[0]]:!(F[0]in n))return!1}for(;++P<T;){F=f[P];var G=F[0],ie=n[G],ne=F[1];if(U&&F[2]){if(ie===t&&!(G in n))return!1}else{var he=new Qi;if(w)var ye=w(ie,ne,G,n,o,he);if(!(ye===t?wo(ne,ie,q|j,w,he):ye))return!1}}return!0}function Pl(n){if(!Qt(n)||km(n))return!1;var o=Wn(n)?r2:Cr;return o.test(Fs(n))}function im(n){return Xt(n)&&Lr(n)==Ve}function nm(n){return Xt(n)&&Dr(n)==ke}function sm(n){return Xt(n)&&fh(n.length)&&!!zt[Lr(n)]}function Rl(n){return typeof n=="function"?n:n==null?ti:typeof n=="object"?gt(n)?Ol(n[0],n[1]):Cl(n):Y0(n)}function Kf(n){if(!xo(n))return c2(n);var o=[];for(var f in Ft(n))$t.call(n,f)&&f!="constructor"&&o.push(f);return o}function am(n){if(!Qt(n))return jm(n);var o=xo(n),f=[];for(var w in n)w=="constructor"&&(o||!$t.call(n,w))||f.push(w);return f}function Hf(n,o){return n<o}function Nl(n,o){var f=-1,w=Zr(n)?Q(n.length):[];return gs(n,function(P,T,U){w[++f]=o(P,T,U)}),w}function Cl(n){var o=au(n);return o.length==1&&o[0][2]?u0(o[0][0],o[0][1]):function(f){return f===n||Ff(f,n,o)}}function Ol(n,o){return cu(n)&&f0(o)?u0(bn(n),o):function(f){var w=mu(f,n);return w===t&&w===o?yu(f,n):wo(o,w,q|j)}}function Jc(n,o,f,w,P){n!==o&&Lf(o,function(T,U){if(P||(P=new Qi),Qt(T))om(n,o,U,f,Jc,w,P);else{var F=w?w(fu(n,U),T,U+"",n,o,P):t;F===t&&(F=T),$f(n,U,F)}},ei)}function om(n,o,f,w,P,T,U){var F=fu(n,f),G=fu(o,f),ie=U.get(G);if(ie){$f(n,f,ie);return}var ne=T?T(F,G,f+"",n,o,U):t,he=ne===t;if(he){var ye=gt(G),$e=!ye&&ys(G),rt=!ye&&!$e&&Pa(G);ne=G,ye||$e||rt?gt(F)?ne=F:ir(F)?ne=Xr(F):$e?(he=!1,ne=Kl(G,!0)):rt?(he=!1,ne=Hl(G,!0)):ne=[]:Eo(G)||Ks(G)?(ne=F,Ks(F)?ne=U0(F):(!Qt(F)||Wn(F))&&(ne=h0(G))):he=!1}he&&(U.set(G,ne),P(ne,G,w,T,U),U.delete(G)),$f(n,f,ne)}function Tl(n,o){var f=n.length;if(f)return o+=o<0?f:0,Jn(o,f)?n[o]:t}function ql(n,o,f){o.length?o=Wt(o,function(T){return gt(T)?function(U){return Us(U,T.length===1?T[0]:T)}:T}):o=[ti];var w=-1;o=Wt(o,di(Ze()));var P=Nl(n,function(T,U,F){var G=Wt(o,function(ie){return ie(T)});return{criteria:G,index:++w,value:T}});return qb(P,function(T,U){return wm(T,U,f)})}function cm(n,o){return Dl(n,o,function(f,w){return yu(n,w)})}function Dl(n,o,f){for(var w=-1,P=o.length,T={};++w<P;){var U=o[w],F=Us(n,U);f(F,U)&&_o(T,bs(U,n),F)}return T}function hm(n){return function(o){return Us(o,n)}}function Vf(n,o,f,w){var P=w?Tb:ba,T=-1,U=o.length,F=n;for(n===o&&(o=Xr(o)),f&&(F=Wt(n,di(f)));++T<U;)for(var G=0,ie=o[T],ne=f?f(ie):ie;(G=P(F,ne,G,w))>-1;)F!==n&&kc.call(F,G,1),kc.call(n,G,1);return n}function Bl(n,o){for(var f=n?o.length:0,w=f-1;f--;){var P=o[f];if(f==w||P!==T){var T=P;Jn(P)?kc.call(n,P,1):Qf(n,P)}}return n}function Gf(n,o){return n+Uc(vl()*(o-n+1))}function fm(n,o,f,w){for(var P=-1,T=ur(zc((o-n)/(f||1)),0),U=Q(T);T--;)U[w?T:++P]=n,n+=f;return U}function Jf(n,o){var f="";if(!n||o<1||o>S)return f;do o%2&&(f+=n),o=Uc(o/2),o&&(n+=n);while(o);return f}function _t(n,o){return uu(d0(n,o,ti),n+"")}function um(n){return yl(Ra(n))}function dm(n,o){var f=Ra(n);return nh(f,zs(o,0,f.length))}function _o(n,o,f,w){if(!Qt(n))return n;o=bs(o,n);for(var P=-1,T=o.length,U=T-1,F=n;F!=null&&++P<T;){var G=bn(o[P]),ie=f;if(G==="__proto__"||G==="constructor"||G==="prototype")return n;if(P!=U){var ne=F[G];ie=w?w(ne,G,F):t,ie===t&&(ie=Qt(ne)?ne:Jn(o[P+1])?[]:{})}bo(F,G,ie),F=F[G]}return n}var $l=jc?function(n,o){return jc.set(n,o),n}:ti,lm=Lc?function(n,o){return Lc(n,"toString",{configurable:!0,enumerable:!1,value:_u(o),writable:!0})}:ti;function pm(n){return nh(Ra(n))}function Pi(n,o,f){var w=-1,P=n.length;o<0&&(o=-o>P?0:P+o),f=f>P?P:f,f<0&&(f+=P),P=o>f?0:f-o>>>0,o>>>=0;for(var T=Q(P);++w<P;)T[w]=n[w+o];return T}function gm(n,o){var f;return gs(n,function(w,P,T){return f=o(w,P,T),!f}),!!f}function Wc(n,o,f){var w=0,P=n==null?w:n.length;if(typeof o=="number"&&o===o&&P<=X){for(;w<P;){var T=w+P>>>1,U=n[T];U!==null&&!pi(U)&&(f?U<=o:U<o)?w=T+1:P=T}return P}return Wf(n,o,ti,f)}function Wf(n,o,f,w){var P=0,T=n==null?0:n.length;if(T===0)return 0;o=f(o);for(var U=o!==o,F=o===null,G=pi(o),ie=o===t;P<T;){var ne=Uc((P+T)/2),he=f(n[ne]),ye=he!==t,$e=he===null,rt=he===he,yt=pi(he);if(U)var it=w||rt;else ie?it=rt&&(w||ye):F?it=rt&&ye&&(w||!$e):G?it=rt&&ye&&!$e&&(w||!yt):$e||yt?it=!1:it=w?he<=o:he<o;it?P=ne+1:T=ne}return qr(T,R)}function kl(n,o){for(var f=-1,w=n.length,P=0,T=[];++f<w;){var U=n[f],F=o?o(U):U;if(!f||!Yi(F,G)){var G=F;T[P++]=U===0?0:U}}return T}function Ll(n){return typeof n=="number"?n:pi(n)?u:+n}function li(n){if(typeof n=="string")return n;if(gt(n))return Wt(n,li)+"";if(pi(n))return bl?bl.call(n):"";var o=n+"";return o=="0"&&1/n==-M?"-0":o}function vs(n,o,f){var w=-1,P=Pc,T=n.length,U=!0,F=[],G=F;if(f)U=!1,P=If;else if(T>=s){var ie=o?null:Mm(n);if(ie)return Nc(ie);U=!1,P=fo,G=new Ls}else G=o?[]:F;e:for(;++w<T;){var ne=n[w],he=o?o(ne):ne;if(ne=f||ne!==0?ne:0,U&&he===he){for(var ye=G.length;ye--;)if(G[ye]===he)continue e;o&&G.push(he),F.push(ne)}else P(G,he,f)||(G!==F&&G.push(he),F.push(ne))}return F}function Qf(n,o){return o=bs(o,n),n=l0(n,o),n==null||delete n[bn(Ri(o))]}function zl(n,o,f,w){return _o(n,o,f(Us(n,o)),w)}function Qc(n,o,f,w){for(var P=n.length,T=w?P:-1;(w?T--:++T<P)&&o(n[T],T,n););return f?Pi(n,w?0:T,w?T+1:P):Pi(n,w?T+1:0,w?P:T)}function Ul(n,o){var f=n;return f instanceof Mt&&(f=f.value()),Ef(o,function(w,P){return P.func.apply(P.thisArg,ds([w],P.args))},f)}function Yf(n,o,f){var w=n.length;if(w<2)return w?vs(n[0]):[];for(var P=-1,T=Q(w);++P<w;)for(var U=n[P],F=-1;++F<w;)F!=P&&(T[P]=mo(T[P]||U,n[F],o,f));return vs(Ir(T,1),o,f)}function jl(n,o,f){for(var w=-1,P=n.length,T=o.length,U={};++w<P;){var F=w<T?o[w]:t;f(U,n[w],F)}return U}function Xf(n){return ir(n)?n:[]}function Zf(n){return typeof n=="function"?n:ti}function bs(n,o){return gt(n)?n:cu(n,o)?[n]:b0(Dt(n))}var vm=_t;function ms(n,o,f){var w=n.length;return f=f===t?w:f,!o&&f>=w?n:Pi(n,o,f)}var Fl=i2||function(n){return Nt.clearTimeout(n)};function Kl(n,o){if(o)return n.slice();var f=n.length,w=ul?ul(f):new n.constructor(f);return n.copy(w),w}function eu(n){var o=new n.constructor(n.byteLength);return new Bc(o).set(new Bc(n)),o}function bm(n,o){var f=o?eu(n.buffer):n.buffer;return new n.constructor(f,n.byteOffset,n.byteLength)}function mm(n){var o=new n.constructor(n.source,bt.exec(n));return o.lastIndex=n.lastIndex,o}function ym(n){return vo?Ft(vo.call(n)):{}}function Hl(n,o){var f=o?eu(n.buffer):n.buffer;return new n.constructor(f,n.byteOffset,n.length)}function Vl(n,o){if(n!==o){var f=n!==t,w=n===null,P=n===n,T=pi(n),U=o!==t,F=o===null,G=o===o,ie=pi(o);if(!F&&!ie&&!T&&n>o||T&&U&&G&&!F&&!ie||w&&U&&G||!f&&G||!P)return 1;if(!w&&!T&&!ie&&n<o||ie&&f&&P&&!w&&!T||F&&f&&P||!U&&P||!G)return-1}return 0}function wm(n,o,f){for(var w=-1,P=n.criteria,T=o.criteria,U=P.length,F=f.length;++w<U;){var G=Vl(P[w],T[w]);if(G){if(w>=F)return G;var ie=f[w];return G*(ie=="desc"?-1:1)}}return n.index-o.index}function Gl(n,o,f,w){for(var P=-1,T=n.length,U=f.length,F=-1,G=o.length,ie=ur(T-U,0),ne=Q(G+ie),he=!w;++F<G;)ne[F]=o[F];for(;++P<U;)(he||P<T)&&(ne[f[P]]=n[P]);for(;ie--;)ne[F++]=n[P++];return ne}function Jl(n,o,f,w){for(var P=-1,T=n.length,U=-1,F=f.length,G=-1,ie=o.length,ne=ur(T-F,0),he=Q(ne+ie),ye=!w;++P<ne;)he[P]=n[P];for(var $e=P;++G<ie;)he[$e+G]=o[G];for(;++U<F;)(ye||P<T)&&(he[$e+f[U]]=n[P++]);return he}function Xr(n,o){var f=-1,w=n.length;for(o||(o=Q(w));++f<w;)o[f]=n[f];return o}function vn(n,o,f,w){var P=!f;f||(f={});for(var T=-1,U=o.length;++T<U;){var F=o[T],G=w?w(f[F],n[F],F,f,n):t;G===t&&(G=n[F]),P?Hn(f,F,G):bo(f,F,G)}return f}function _m(n,o){return vn(n,ou(n),o)}function Am(n,o){return vn(n,o0(n),o)}function Yc(n,o){return function(f,w){var P=gt(f)?Sb:K2,T=o?o():{};return P(f,n,Ze(w,2),T)}}function Ea(n){return _t(function(o,f){var w=-1,P=f.length,T=P>1?f[P-1]:t,U=P>2?f[2]:t;for(T=n.length>3&&typeof T=="function"?(P--,T):t,U&&zr(f[0],f[1],U)&&(T=P<3?t:T,P=1),o=Ft(o);++w<P;){var F=f[w];F&&n(o,F,w,T)}return o})}function Wl(n,o){return function(f,w){if(f==null)return f;if(!Zr(f))return n(f,w);for(var P=f.length,T=o?P:-1,U=Ft(f);(o?T--:++T<P)&&w(U[T],T,U)!==!1;);return f}}function Ql(n){return function(o,f,w){for(var P=-1,T=Ft(o),U=w(o),F=U.length;F--;){var G=U[n?F:++P];if(f(T[G],G,T)===!1)break}return o}}function xm(n,o,f){var w=o&K,P=Ao(n);function T(){var U=this&&this!==Nt&&this instanceof T?P:n;return U.apply(w?f:this,arguments)}return T}function Yl(n){return function(o){o=Dt(o);var f=ma(o)?Wi(o):t,w=f?f[0]:o.charAt(0),P=f?ms(f,1).join(""):o.slice(1);return w[n]()+P}}function Ma(n){return function(o){return Ef(W0(J0(o).replace(co,"")),n,"")}}function Ao(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var f=Ia(n.prototype),w=n.apply(f,o);return Qt(w)?w:f}}function Im(n,o,f){var w=Ao(n);function P(){for(var T=arguments.length,U=Q(T),F=T,G=Sa(P);F--;)U[F]=arguments[F];var ie=T<3&&U[0]!==G&&U[T-1]!==G?[]:ls(U,G);if(T-=ie.length,T<f)return r0(n,o,Xc,P.placeholder,t,U,ie,t,t,f-T);var ne=this&&this!==Nt&&this instanceof P?w:n;return pr(ne,this,U)}return P}function Xl(n){return function(o,f,w){var P=Ft(o);if(!Zr(o)){var T=Ze(f,3);o=gr(o),f=function(F){return T(P[F],F,P)}}var U=n(o,f,w);return U>-1?P[T?o[U]:U]:t}}function Zl(n){return Gn(function(o){var f=o.length,w=f,P=Mi.prototype.thru;for(n&&o.reverse();w--;){var T=o[w];if(typeof T!="function")throw new Ei(h);if(P&&!U&&rh(T)=="wrapper")var U=new Mi([],!0)}for(w=U?w:f;++w<f;){T=o[w];var F=rh(T),G=F=="wrapper"?su(T):t;G&&hu(G[0])&&G[1]==(ue|de|re|le)&&!G[4].length&&G[9]==1?U=U[rh(G[0])].apply(U,G[3]):U=T.length==1&&hu(T)?U[F]():U.thru(T)}return function(){var ie=arguments,ne=ie[0];if(U&&ie.length==1&&gt(ne))return U.plant(ne).value();for(var he=0,ye=f?o[he].apply(this,ie):ne;++he<f;)ye=o[he].call(this,ye);return ye}})}function Xc(n,o,f,w,P,T,U,F,G,ie){var ne=o&ue,he=o&K,ye=o&J,$e=o&(de|oe),rt=o&Ae,yt=ye?t:Ao(n);function it(){for(var xt=arguments.length,Ct=Q(xt),gi=xt;gi--;)Ct[gi]=arguments[gi];if($e)var Ur=Sa(it),vi=Bb(Ct,Ur);if(w&&(Ct=Gl(Ct,w,P,$e)),T&&(Ct=Jl(Ct,T,U,$e)),xt-=vi,$e&&xt<ie){var nr=ls(Ct,Ur);return r0(n,o,Xc,it.placeholder,f,Ct,nr,F,G,ie-xt)}var Xi=he?f:this,Yn=ye?Xi[n]:n;return xt=Ct.length,F?Ct=Km(Ct,F):rt&&xt>1&&Ct.reverse(),ne&&G<xt&&(Ct.length=G),this&&this!==Nt&&this instanceof it&&(Yn=yt||Ao(Yn)),Yn.apply(Xi,Ct)}return it}function e0(n,o){return function(f,w){return X2(f,n,o(w),{})}}function Zc(n,o){return function(f,w){var P;if(f===t&&w===t)return o;if(f!==t&&(P=f),w!==t){if(P===t)return w;typeof f=="string"||typeof w=="string"?(f=li(f),w=li(w)):(f=Ll(f),w=Ll(w)),P=n(f,w)}return P}}function tu(n){return Gn(function(o){return o=Wt(o,di(Ze())),_t(function(f){var w=this;return n(o,function(P){return pr(P,w,f)})})})}function eh(n,o){o=o===t?" ":li(o);var f=o.length;if(f<2)return f?Jf(o,n):o;var w=Jf(o,zc(n/ya(o)));return ma(o)?ms(Wi(w),0,n).join(""):w.slice(0,n)}function Em(n,o,f,w){var P=o&K,T=Ao(n);function U(){for(var F=-1,G=arguments.length,ie=-1,ne=w.length,he=Q(ne+G),ye=this&&this!==Nt&&this instanceof U?T:n;++ie<ne;)he[ie]=w[ie];for(;G--;)he[ie++]=arguments[++F];return pr(ye,P?f:this,he)}return U}function t0(n){return function(o,f,w){return w&&typeof w!="number"&&zr(o,f,w)&&(f=w=t),o=Qn(o),f===t?(f=o,o=0):f=Qn(f),w=w===t?o<f?1:-1:Qn(w),fm(o,f,w,n)}}function th(n){return function(o,f){return typeof o=="string"&&typeof f=="string"||(o=Ni(o),f=Ni(f)),n(o,f)}}function r0(n,o,f,w,P,T,U,F,G,ie){var ne=o&de,he=ne?U:t,ye=ne?t:U,$e=ne?T:t,rt=ne?t:T;o|=ne?re:fe,o&=~(ne?fe:re),o&Z||(o&=~(K|J));var yt=[n,o,P,$e,he,rt,ye,F,G,ie],it=f.apply(t,yt);return hu(n)&&p0(it,yt),it.placeholder=w,g0(it,n,o)}function ru(n){var o=fr[n];return function(f,w){if(f=Ni(f),w=w==null?0:qr(mt(w),292),w&&gl(f)){var P=(Dt(f)+"e").split("e"),T=o(P[0]+"e"+(+P[1]+w));return P=(Dt(T)+"e").split("e"),+(P[0]+"e"+(+P[1]-w))}return o(f)}}var Mm=Aa&&1/Nc(new Aa([,-0]))[1]==M?function(n){return new Aa(n)}:Iu;function i0(n){return function(o){var f=Dr(o);return f==ae?Of(o):f==ke?Fb(o):Db(o,n(o))}}function Vn(n,o,f,w,P,T,U,F){var G=o&J;if(!G&&typeof n!="function")throw new Ei(h);var ie=w?w.length:0;if(ie||(o&=~(re|fe),w=P=t),U=U===t?U:ur(mt(U),0),F=F===t?F:mt(F),ie-=P?P.length:0,o&fe){var ne=w,he=P;w=P=t}var ye=G?t:su(n),$e=[n,o,f,w,P,ne,he,T,U,F];if(ye&&Um($e,ye),n=$e[0],o=$e[1],f=$e[2],w=$e[3],P=$e[4],F=$e[9]=$e[9]===t?G?0:n.length:ur($e[9]-ie,0),!F&&o&(de|oe)&&(o&=~(de|oe)),!o||o==K)var rt=xm(n,o,f);else o==de||o==oe?rt=Im(n,o,F):(o==re||o==(K|re))&&!P.length?rt=Em(n,o,f,w):rt=Xc.apply(t,$e);var yt=ye?$l:p0;return g0(yt(rt,$e),n,o)}function n0(n,o,f,w){return n===t||Yi(n,_a[f])&&!$t.call(w,f)?o:n}function s0(n,o,f,w,P,T){return Qt(n)&&Qt(o)&&(T.set(o,n),Jc(n,o,t,s0,T),T.delete(o)),n}function Sm(n){return Eo(n)?t:n}function a0(n,o,f,w,P,T){var U=f&q,F=n.length,G=o.length;if(F!=G&&!(U&&G>F))return!1;var ie=T.get(n),ne=T.get(o);if(ie&&ne)return ie==o&&ne==n;var he=-1,ye=!0,$e=f&j?new Ls:t;for(T.set(n,o),T.set(o,n);++he<F;){var rt=n[he],yt=o[he];if(w)var it=U?w(yt,rt,he,o,n,T):w(rt,yt,he,n,o,T);if(it!==t){if(it)continue;ye=!1;break}if($e){if(!Mf(o,function(xt,Ct){if(!fo($e,Ct)&&(rt===xt||P(rt,xt,f,w,T)))return $e.push(Ct)})){ye=!1;break}}else if(!(rt===yt||P(rt,yt,f,w,T))){ye=!1;break}}return T.delete(n),T.delete(o),ye}function Pm(n,o,f,w,P,T,U){switch(f){case we:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case De:return!(n.byteLength!=o.byteLength||!T(new Bc(n),new Bc(o)));case L:case z:case ge:return Yi(+n,+o);case $:return n.name==o.name&&n.message==o.message;case Ve:case _e:return n==o+"";case ae:var F=Of;case ke:var G=w&q;if(F||(F=Nc),n.size!=o.size&&!G)return!1;var ie=U.get(n);if(ie)return ie==o;w|=j,U.set(n,o);var ne=a0(F(n),F(o),w,P,T,U);return U.delete(n),ne;case je:if(vo)return vo.call(n)==vo.call(o)}return!1}function Rm(n,o,f,w,P,T){var U=f&q,F=iu(n),G=F.length,ie=iu(o),ne=ie.length;if(G!=ne&&!U)return!1;for(var he=G;he--;){var ye=F[he];if(!(U?ye in o:$t.call(o,ye)))return!1}var $e=T.get(n),rt=T.get(o);if($e&&rt)return $e==o&&rt==n;var yt=!0;T.set(n,o),T.set(o,n);for(var it=U;++he<G;){ye=F[he];var xt=n[ye],Ct=o[ye];if(w)var gi=U?w(Ct,xt,ye,o,n,T):w(xt,Ct,ye,n,o,T);if(!(gi===t?xt===Ct||P(xt,Ct,f,w,T):gi)){yt=!1;break}it||(it=ye=="constructor")}if(yt&&!it){var Ur=n.constructor,vi=o.constructor;Ur!=vi&&"constructor"in n&&"constructor"in o&&!(typeof Ur=="function"&&Ur instanceof Ur&&typeof vi=="function"&&vi instanceof vi)&&(yt=!1)}return T.delete(n),T.delete(o),yt}function Gn(n){return uu(d0(n,t,_0),n+"")}function iu(n){return Ml(n,gr,ou)}function nu(n){return Ml(n,ei,o0)}var su=jc?function(n){return jc.get(n)}:Iu;function rh(n){for(var o=n.name+"",f=xa[o],w=$t.call(xa,o)?f.length:0;w--;){var P=f[w],T=P.func;if(T==null||T==n)return P.name}return o}function Sa(n){var o=$t.call(C,"placeholder")?C:n;return o.placeholder}function Ze(){var n=C.iteratee||Au;return n=n===Au?Rl:n,arguments.length?n(arguments[0],arguments[1]):n}function ih(n,o){var f=n.__data__;return $m(o)?f[typeof o=="string"?"string":"hash"]:f.map}function au(n){for(var o=gr(n),f=o.length;f--;){var w=o[f],P=n[w];o[f]=[w,P,f0(P)]}return o}function js(n,o){var f=zb(n,o);return Pl(f)?f:t}function Nm(n){var o=$t.call(n,$s),f=n[$s];try{n[$s]=t;var w=!0}catch{}var P=qc.call(n);return w&&(o?n[$s]=f:delete n[$s]),P}var ou=qf?function(n){return n==null?[]:(n=Ft(n),us(qf(n),function(o){return ll.call(n,o)}))}:Eu,o0=qf?function(n){for(var o=[];n;)ds(o,ou(n)),n=$c(n);return o}:Eu,Dr=Lr;(Df&&Dr(new Df(new ArrayBuffer(1)))!=we||lo&&Dr(new lo)!=ae||Bf&&Dr(Bf.resolve())!=nt||Aa&&Dr(new Aa)!=ke||po&&Dr(new po)!=me)&&(Dr=function(n){var o=Lr(n),f=o==Te?n.constructor:t,w=f?Fs(f):"";if(w)switch(w){case d2:return we;case l2:return ae;case p2:return nt;case g2:return ke;case v2:return me}return o});function Cm(n,o,f){for(var w=-1,P=f.length;++w<P;){var T=f[w],U=T.size;switch(T.type){case"drop":n+=U;break;case"dropRight":o-=U;break;case"take":o=qr(o,n+U);break;case"takeRight":n=ur(n,o-U);break}}return{start:n,end:o}}function Om(n){var o=n.match(Ue);return o?o[1].split(at):[]}function c0(n,o,f){o=bs(o,n);for(var w=-1,P=o.length,T=!1;++w<P;){var U=bn(o[w]);if(!(T=n!=null&&f(n,U)))break;n=n[U]}return T||++w!=P?T:(P=n==null?0:n.length,!!P&&fh(P)&&Jn(U,P)&&(gt(n)||Ks(n)))}function Tm(n){var o=n.length,f=new n.constructor(o);return o&&typeof n[0]=="string"&&$t.call(n,"index")&&(f.index=n.index,f.input=n.input),f}function h0(n){return typeof n.constructor=="function"&&!xo(n)?Ia($c(n)):{}}function qm(n,o,f){var w=n.constructor;switch(o){case De:return eu(n);case L:case z:return new w(+n);case we:return bm(n,f);case We:case Le:case Pe:case ot:case ft:case qe:case ct:case ut:case Be:return Hl(n,f);case ae:return new w;case ge:case _e:return new w(n);case Ve:return mm(n);case ke:return new w;case je:return ym(n)}}function Dm(n,o){var f=o.length;if(!f)return n;var w=f-1;return o[w]=(f>1?"& ":"")+o[w],o=o.join(f>2?", ":" "),n.replace(Ee,`{
/* [wrapped with `+o+`] */
`)}function Bm(n){return gt(n)||Ks(n)||!!(pl&&n&&n[pl])}function Jn(n,o){var f=typeof n;return o=o??S,!!o&&(f=="number"||f!="symbol"&&Tr.test(n))&&n>-1&&n%1==0&&n<o}function zr(n,o,f){if(!Qt(f))return!1;var w=typeof o;return(w=="number"?Zr(f)&&Jn(o,f.length):w=="string"&&o in f)?Yi(f[o],n):!1}function cu(n,o){if(gt(n))return!1;var f=typeof n;return f=="number"||f=="symbol"||f=="boolean"||n==null||pi(n)?!0:Re.test(n)||!He.test(n)||o!=null&&n in Ft(o)}function $m(n){var o=typeof n;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null}function hu(n){var o=rh(n),f=C[o];if(typeof f!="function"||!(o in Mt.prototype))return!1;if(n===f)return!0;var w=su(f);return!!w&&n===w[0]}function km(n){return!!fl&&fl in n}var Lm=Oc?Wn:Mu;function xo(n){var o=n&&n.constructor,f=typeof o=="function"&&o.prototype||_a;return n===f}function f0(n){return n===n&&!Qt(n)}function u0(n,o){return function(f){return f==null?!1:f[n]===o&&(o!==t||n in Ft(f))}}function zm(n){var o=ch(n,function(w){return f.size===v&&f.clear(),w}),f=o.cache;return o}function Um(n,o){var f=n[1],w=o[1],P=f|w,T=P<(K|J|ue),U=w==ue&&f==de||w==ue&&f==le&&n[7].length<=o[8]||w==(ue|le)&&o[7].length<=o[8]&&f==de;if(!(T||U))return n;w&K&&(n[2]=o[2],P|=f&K?0:Z);var F=o[3];if(F){var G=n[3];n[3]=G?Gl(G,F,o[4]):F,n[4]=G?ls(n[3],_):o[4]}return F=o[5],F&&(G=n[5],n[5]=G?Jl(G,F,o[6]):F,n[6]=G?ls(n[5],_):o[6]),F=o[7],F&&(n[7]=F),w&ue&&(n[8]=n[8]==null?o[8]:qr(n[8],o[8])),n[9]==null&&(n[9]=o[9]),n[0]=o[0],n[1]=P,n}function jm(n){var o=[];if(n!=null)for(var f in Ft(n))o.push(f);return o}function Fm(n){return qc.call(n)}function d0(n,o,f){return o=ur(o===t?n.length-1:o,0),function(){for(var w=arguments,P=-1,T=ur(w.length-o,0),U=Q(T);++P<T;)U[P]=w[o+P];P=-1;for(var F=Q(o+1);++P<o;)F[P]=w[P];return F[o]=f(U),pr(n,this,F)}}function l0(n,o){return o.length<2?n:Us(n,Pi(o,0,-1))}function Km(n,o){for(var f=n.length,w=qr(o.length,f),P=Xr(n);w--;){var T=o[w];n[w]=Jn(T,f)?P[T]:t}return n}function fu(n,o){if(!(o==="constructor"&&typeof n[o]=="function")&&o!="__proto__")return n[o]}var p0=v0($l),Io=s2||function(n,o){return Nt.setTimeout(n,o)},uu=v0(lm);function g0(n,o,f){var w=o+"";return uu(n,Dm(w,Hm(Om(w),f)))}function v0(n){var o=0,f=0;return function(){var w=h2(),P=c-(w-f);if(f=w,P>0){if(++o>=b)return arguments[0]}else o=0;return n.apply(t,arguments)}}function nh(n,o){var f=-1,w=n.length,P=w-1;for(o=o===t?w:o;++f<o;){var T=Gf(f,P),U=n[T];n[T]=n[f],n[f]=U}return n.length=o,n}var b0=zm(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(st,function(f,w,P,T){o.push(P?T.replace(Tt,"$1"):w||f)}),o});function bn(n){if(typeof n=="string"||pi(n))return n;var o=n+"";return o=="0"&&1/n==-M?"-0":o}function Fs(n){if(n!=null){try{return Tc.call(n)}catch{}try{return n+""}catch{}}return""}function Hm(n,o){return Ii(ee,function(f){var w="_."+f[0];o&f[1]&&!Pc(n,w)&&n.push(w)}),n.sort()}function m0(n){if(n instanceof Mt)return n.clone();var o=new Mi(n.__wrapped__,n.__chain__);return o.__actions__=Xr(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}function Vm(n,o,f){(f?zr(n,o,f):o===t)?o=1:o=ur(mt(o),0);var w=n==null?0:n.length;if(!w||o<1)return[];for(var P=0,T=0,U=Q(zc(w/o));P<w;)U[T++]=Pi(n,P,P+=o);return U}function Gm(n){for(var o=-1,f=n==null?0:n.length,w=0,P=[];++o<f;){var T=n[o];T&&(P[w++]=T)}return P}function Jm(){var n=arguments.length;if(!n)return[];for(var o=Q(n-1),f=arguments[0],w=n;w--;)o[w-1]=arguments[w];return ds(gt(f)?Xr(f):[f],Ir(o,1))}var Wm=_t(function(n,o){return ir(n)?mo(n,Ir(o,1,ir,!0)):[]}),Qm=_t(function(n,o){var f=Ri(o);return ir(f)&&(f=t),ir(n)?mo(n,Ir(o,1,ir,!0),Ze(f,2)):[]}),Ym=_t(function(n,o){var f=Ri(o);return ir(f)&&(f=t),ir(n)?mo(n,Ir(o,1,ir,!0),t,f):[]});function Xm(n,o,f){var w=n==null?0:n.length;return w?(o=f||o===t?1:mt(o),Pi(n,o<0?0:o,w)):[]}function Zm(n,o,f){var w=n==null?0:n.length;return w?(o=f||o===t?1:mt(o),o=w-o,Pi(n,0,o<0?0:o)):[]}function e6(n,o){return n&&n.length?Qc(n,Ze(o,3),!0,!0):[]}function t6(n,o){return n&&n.length?Qc(n,Ze(o,3),!0):[]}function r6(n,o,f,w){var P=n==null?0:n.length;return P?(f&&typeof f!="number"&&zr(n,o,f)&&(f=0,w=P),J2(n,o,f,w)):[]}function y0(n,o,f){var w=n==null?0:n.length;if(!w)return-1;var P=f==null?0:mt(f);return P<0&&(P=ur(w+P,0)),Rc(n,Ze(o,3),P)}function w0(n,o,f){var w=n==null?0:n.length;if(!w)return-1;var P=w-1;return f!==t&&(P=mt(f),P=f<0?ur(w+P,0):qr(P,w-1)),Rc(n,Ze(o,3),P,!0)}function _0(n){var o=n==null?0:n.length;return o?Ir(n,1):[]}function i6(n){var o=n==null?0:n.length;return o?Ir(n,M):[]}function n6(n,o){var f=n==null?0:n.length;return f?(o=o===t?1:mt(o),Ir(n,o)):[]}function s6(n){for(var o=-1,f=n==null?0:n.length,w={};++o<f;){var P=n[o];w[P[0]]=P[1]}return w}function A0(n){return n&&n.length?n[0]:t}function a6(n,o,f){var w=n==null?0:n.length;if(!w)return-1;var P=f==null?0:mt(f);return P<0&&(P=ur(w+P,0)),ba(n,o,P)}function o6(n){var o=n==null?0:n.length;return o?Pi(n,0,-1):[]}var c6=_t(function(n){var o=Wt(n,Xf);return o.length&&o[0]===n[0]?jf(o):[]}),h6=_t(function(n){var o=Ri(n),f=Wt(n,Xf);return o===Ri(f)?o=t:f.pop(),f.length&&f[0]===n[0]?jf(f,Ze(o,2)):[]}),f6=_t(function(n){var o=Ri(n),f=Wt(n,Xf);return o=typeof o=="function"?o:t,o&&f.pop(),f.length&&f[0]===n[0]?jf(f,t,o):[]});function u6(n,o){return n==null?"":o2.call(n,o)}function Ri(n){var o=n==null?0:n.length;return o?n[o-1]:t}function d6(n,o,f){var w=n==null?0:n.length;if(!w)return-1;var P=w;return f!==t&&(P=mt(f),P=P<0?ur(w+P,0):qr(P,w-1)),o===o?Hb(n,o,P):Rc(n,rl,P,!0)}function l6(n,o){return n&&n.length?Tl(n,mt(o)):t}var p6=_t(x0);function x0(n,o){return n&&n.length&&o&&o.length?Vf(n,o):n}function g6(n,o,f){return n&&n.length&&o&&o.length?Vf(n,o,Ze(f,2)):n}function v6(n,o,f){return n&&n.length&&o&&o.length?Vf(n,o,t,f):n}var b6=Gn(function(n,o){var f=n==null?0:n.length,w=kf(n,o);return Bl(n,Wt(o,function(P){return Jn(P,f)?+P:P}).sort(Vl)),w});function m6(n,o){var f=[];if(!(n&&n.length))return f;var w=-1,P=[],T=n.length;for(o=Ze(o,3);++w<T;){var U=n[w];o(U,w,n)&&(f.push(U),P.push(w))}return Bl(n,P),f}function du(n){return n==null?n:u2.call(n)}function y6(n,o,f){var w=n==null?0:n.length;return w?(f&&typeof f!="number"&&zr(n,o,f)?(o=0,f=w):(o=o==null?0:mt(o),f=f===t?w:mt(f)),Pi(n,o,f)):[]}function w6(n,o){return Wc(n,o)}function _6(n,o,f){return Wf(n,o,Ze(f,2))}function A6(n,o){var f=n==null?0:n.length;if(f){var w=Wc(n,o);if(w<f&&Yi(n[w],o))return w}return-1}function x6(n,o){return Wc(n,o,!0)}function I6(n,o,f){return Wf(n,o,Ze(f,2),!0)}function E6(n,o){var f=n==null?0:n.length;if(f){var w=Wc(n,o,!0)-1;if(Yi(n[w],o))return w}return-1}function M6(n){return n&&n.length?kl(n):[]}function S6(n,o){return n&&n.length?kl(n,Ze(o,2)):[]}function P6(n){var o=n==null?0:n.length;return o?Pi(n,1,o):[]}function R6(n,o,f){return n&&n.length?(o=f||o===t?1:mt(o),Pi(n,0,o<0?0:o)):[]}function N6(n,o,f){var w=n==null?0:n.length;return w?(o=f||o===t?1:mt(o),o=w-o,Pi(n,o<0?0:o,w)):[]}function C6(n,o){return n&&n.length?Qc(n,Ze(o,3),!1,!0):[]}function O6(n,o){return n&&n.length?Qc(n,Ze(o,3)):[]}var T6=_t(function(n){return vs(Ir(n,1,ir,!0))}),q6=_t(function(n){var o=Ri(n);return ir(o)&&(o=t),vs(Ir(n,1,ir,!0),Ze(o,2))}),D6=_t(function(n){var o=Ri(n);return o=typeof o=="function"?o:t,vs(Ir(n,1,ir,!0),t,o)});function B6(n){return n&&n.length?vs(n):[]}function $6(n,o){return n&&n.length?vs(n,Ze(o,2)):[]}function k6(n,o){return o=typeof o=="function"?o:t,n&&n.length?vs(n,t,o):[]}function lu(n){if(!(n&&n.length))return[];var o=0;return n=us(n,function(f){if(ir(f))return o=ur(f.length,o),!0}),Nf(o,function(f){return Wt(n,Sf(f))})}function I0(n,o){if(!(n&&n.length))return[];var f=lu(n);return o==null?f:Wt(f,function(w){return pr(o,t,w)})}var L6=_t(function(n,o){return ir(n)?mo(n,o):[]}),z6=_t(function(n){return Yf(us(n,ir))}),U6=_t(function(n){var o=Ri(n);return ir(o)&&(o=t),Yf(us(n,ir),Ze(o,2))}),j6=_t(function(n){var o=Ri(n);return o=typeof o=="function"?o:t,Yf(us(n,ir),t,o)}),F6=_t(lu);function K6(n,o){return jl(n||[],o||[],bo)}function H6(n,o){return jl(n||[],o||[],_o)}var V6=_t(function(n){var o=n.length,f=o>1?n[o-1]:t;return f=typeof f=="function"?(n.pop(),f):t,I0(n,f)});function E0(n){var o=C(n);return o.__chain__=!0,o}function G6(n,o){return o(n),n}function sh(n,o){return o(n)}var J6=Gn(function(n){var o=n.length,f=o?n[0]:0,w=this.__wrapped__,P=function(T){return kf(T,n)};return o>1||this.__actions__.length||!(w instanceof Mt)||!Jn(f)?this.thru(P):(w=w.slice(f,+f+(o?1:0)),w.__actions__.push({func:sh,args:[P],thisArg:t}),new Mi(w,this.__chain__).thru(function(T){return o&&!T.length&&T.push(t),T}))});function W6(){return E0(this)}function Q6(){return new Mi(this.value(),this.__chain__)}function Y6(){this.__values__===t&&(this.__values__=L0(this.value()));var n=this.__index__>=this.__values__.length,o=n?t:this.__values__[this.__index__++];return{done:n,value:o}}function X6(){return this}function Z6(n){for(var o,f=this;f instanceof Kc;){var w=m0(f);w.__index__=0,w.__values__=t,o?P.__wrapped__=w:o=w;var P=w;f=f.__wrapped__}return P.__wrapped__=n,o}function e3(){var n=this.__wrapped__;if(n instanceof Mt){var o=n;return this.__actions__.length&&(o=new Mt(this)),o=o.reverse(),o.__actions__.push({func:sh,args:[du],thisArg:t}),new Mi(o,this.__chain__)}return this.thru(du)}function t3(){return Ul(this.__wrapped__,this.__actions__)}var r3=Yc(function(n,o,f){$t.call(n,f)?++n[f]:Hn(n,f,1)});function i3(n,o,f){var w=gt(n)?el:G2;return f&&zr(n,o,f)&&(o=t),w(n,Ze(o,3))}function n3(n,o){var f=gt(n)?us:Il;return f(n,Ze(o,3))}var s3=Xl(y0),a3=Xl(w0);function o3(n,o){return Ir(ah(n,o),1)}function c3(n,o){return Ir(ah(n,o),M)}function h3(n,o,f){return f=f===t?1:mt(f),Ir(ah(n,o),f)}function M0(n,o){var f=gt(n)?Ii:gs;return f(n,Ze(o,3))}function S0(n,o){var f=gt(n)?Pb:xl;return f(n,Ze(o,3))}var f3=Yc(function(n,o,f){$t.call(n,f)?n[f].push(o):Hn(n,f,[o])});function u3(n,o,f,w){n=Zr(n)?n:Ra(n),f=f&&!w?mt(f):0;var P=n.length;return f<0&&(f=ur(P+f,0)),uh(n)?f<=P&&n.indexOf(o,f)>-1:!!P&&ba(n,o,f)>-1}var d3=_t(function(n,o,f){var w=-1,P=typeof o=="function",T=Zr(n)?Q(n.length):[];return gs(n,function(U){T[++w]=P?pr(o,U,f):yo(U,o,f)}),T}),l3=Yc(function(n,o,f){Hn(n,f,o)});function ah(n,o){var f=gt(n)?Wt:Nl;return f(n,Ze(o,3))}function p3(n,o,f,w){return n==null?[]:(gt(o)||(o=o==null?[]:[o]),f=w?t:f,gt(f)||(f=f==null?[]:[f]),ql(n,o,f))}var g3=Yc(function(n,o,f){n[f?0:1].push(o)},function(){return[[],[]]});function v3(n,o,f){var w=gt(n)?Ef:nl,P=arguments.length<3;return w(n,Ze(o,4),f,P,gs)}function b3(n,o,f){var w=gt(n)?Rb:nl,P=arguments.length<3;return w(n,Ze(o,4),f,P,xl)}function m3(n,o){var f=gt(n)?us:Il;return f(n,hh(Ze(o,3)))}function y3(n){var o=gt(n)?yl:um;return o(n)}function w3(n,o,f){(f?zr(n,o,f):o===t)?o=1:o=mt(o);var w=gt(n)?j2:dm;return w(n,o)}function _3(n){var o=gt(n)?F2:pm;return o(n)}function A3(n){if(n==null)return 0;if(Zr(n))return uh(n)?ya(n):n.length;var o=Dr(n);return o==ae||o==ke?n.size:Kf(n).length}function x3(n,o,f){var w=gt(n)?Mf:gm;return f&&zr(n,o,f)&&(o=t),w(n,Ze(o,3))}var I3=_t(function(n,o){if(n==null)return[];var f=o.length;return f>1&&zr(n,o[0],o[1])?o=[]:f>2&&zr(o[0],o[1],o[2])&&(o=[o[0]]),ql(n,Ir(o,1),[])}),oh=n2||function(){return Nt.Date.now()};function E3(n,o){if(typeof o!="function")throw new Ei(h);return n=mt(n),function(){if(--n<1)return o.apply(this,arguments)}}function P0(n,o,f){return o=f?t:o,o=n&&o==null?n.length:o,Vn(n,ue,t,t,t,t,o)}function R0(n,o){var f;if(typeof o!="function")throw new Ei(h);return n=mt(n),function(){return--n>0&&(f=o.apply(this,arguments)),n<=1&&(o=t),f}}var pu=_t(function(n,o,f){var w=K;if(f.length){var P=ls(f,Sa(pu));w|=re}return Vn(n,w,o,f,P)}),N0=_t(function(n,o,f){var w=K|J;if(f.length){var P=ls(f,Sa(N0));w|=re}return Vn(o,w,n,f,P)});function C0(n,o,f){o=f?t:o;var w=Vn(n,de,t,t,t,t,t,o);return w.placeholder=C0.placeholder,w}function O0(n,o,f){o=f?t:o;var w=Vn(n,oe,t,t,t,t,t,o);return w.placeholder=O0.placeholder,w}function T0(n,o,f){var w,P,T,U,F,G,ie=0,ne=!1,he=!1,ye=!0;if(typeof n!="function")throw new Ei(h);o=Ni(o)||0,Qt(f)&&(ne=!!f.leading,he="maxWait"in f,T=he?ur(Ni(f.maxWait)||0,o):T,ye="trailing"in f?!!f.trailing:ye);function $e(nr){var Xi=w,Yn=P;return w=P=t,ie=nr,U=n.apply(Yn,Xi),U}function rt(nr){return ie=nr,F=Io(xt,o),ne?$e(nr):U}function yt(nr){var Xi=nr-G,Yn=nr-ie,X0=o-Xi;return he?qr(X0,T-Yn):X0}function it(nr){var Xi=nr-G,Yn=nr-ie;return G===t||Xi>=o||Xi<0||he&&Yn>=T}function xt(){var nr=oh();if(it(nr))return Ct(nr);F=Io(xt,yt(nr))}function Ct(nr){return F=t,ye&&w?$e(nr):(w=P=t,U)}function gi(){F!==t&&Fl(F),ie=0,w=G=P=F=t}function Ur(){return F===t?U:Ct(oh())}function vi(){var nr=oh(),Xi=it(nr);if(w=arguments,P=this,G=nr,Xi){if(F===t)return rt(G);if(he)return Fl(F),F=Io(xt,o),$e(G)}return F===t&&(F=Io(xt,o)),U}return vi.cancel=gi,vi.flush=Ur,vi}var M3=_t(function(n,o){return Al(n,1,o)}),S3=_t(function(n,o,f){return Al(n,Ni(o)||0,f)});function P3(n){return Vn(n,Ae)}function ch(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new Ei(h);var f=function(){var w=arguments,P=o?o.apply(this,w):w[0],T=f.cache;if(T.has(P))return T.get(P);var U=n.apply(this,w);return f.cache=T.set(P,U)||T,U};return f.cache=new(ch.Cache||Kn),f}ch.Cache=Kn;function hh(n){if(typeof n!="function")throw new Ei(h);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}function R3(n){return R0(2,n)}var N3=vm(function(n,o){o=o.length==1&&gt(o[0])?Wt(o[0],di(Ze())):Wt(Ir(o,1),di(Ze()));var f=o.length;return _t(function(w){for(var P=-1,T=qr(w.length,f);++P<T;)w[P]=o[P].call(this,w[P]);return pr(n,this,w)})}),gu=_t(function(n,o){var f=ls(o,Sa(gu));return Vn(n,re,t,o,f)}),q0=_t(function(n,o){var f=ls(o,Sa(q0));return Vn(n,fe,t,o,f)}),C3=Gn(function(n,o){return Vn(n,le,t,t,t,o)});function O3(n,o){if(typeof n!="function")throw new Ei(h);return o=o===t?o:mt(o),_t(n,o)}function T3(n,o){if(typeof n!="function")throw new Ei(h);return o=o==null?0:ur(mt(o),0),_t(function(f){var w=f[o],P=ms(f,0,o);return w&&ds(P,w),pr(n,this,P)})}function q3(n,o,f){var w=!0,P=!0;if(typeof n!="function")throw new Ei(h);return Qt(f)&&(w="leading"in f?!!f.leading:w,P="trailing"in f?!!f.trailing:P),T0(n,o,{leading:w,maxWait:o,trailing:P})}function D3(n){return P0(n,1)}function B3(n,o){return gu(Zf(o),n)}function $3(){if(!arguments.length)return[];var n=arguments[0];return gt(n)?n:[n]}function k3(n){return Si(n,O)}function L3(n,o){return o=typeof o=="function"?o:t,Si(n,O,o)}function z3(n){return Si(n,I|O)}function U3(n,o){return o=typeof o=="function"?o:t,Si(n,I|O,o)}function j3(n,o){return o==null||_l(n,o,gr(o))}function Yi(n,o){return n===o||n!==n&&o!==o}var F3=th(Uf),K3=th(function(n,o){return n>=o}),Ks=Sl(function(){return arguments}())?Sl:function(n){return Xt(n)&&$t.call(n,"callee")&&!ll.call(n,"callee")},gt=Q.isArray,H3=kr?di(kr):Z2;function Zr(n){return n!=null&&fh(n.length)&&!Wn(n)}function ir(n){return Xt(n)&&Zr(n)}function V3(n){return n===!0||n===!1||Xt(n)&&Lr(n)==L}var ys=a2||Mu,G3=Ji?di(Ji):em;function J3(n){return Xt(n)&&n.nodeType===1&&!Eo(n)}function W3(n){if(n==null)return!0;if(Zr(n)&&(gt(n)||typeof n=="string"||typeof n.splice=="function"||ys(n)||Pa(n)||Ks(n)))return!n.length;var o=Dr(n);if(o==ae||o==ke)return!n.size;if(xo(n))return!Kf(n).length;for(var f in n)if($t.call(n,f))return!1;return!0}function Q3(n,o){return wo(n,o)}function Y3(n,o,f){f=typeof f=="function"?f:t;var w=f?f(n,o):t;return w===t?wo(n,o,t,f):!!w}function vu(n){if(!Xt(n))return!1;var o=Lr(n);return o==$||o==y||typeof n.message=="string"&&typeof n.name=="string"&&!Eo(n)}function X3(n){return typeof n=="number"&&gl(n)}function Wn(n){if(!Qt(n))return!1;var o=Lr(n);return o==Y||o==se||o==D||o==Me}function D0(n){return typeof n=="number"&&n==mt(n)}function fh(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=S}function Qt(n){var o=typeof n;return n!=null&&(o=="object"||o=="function")}function Xt(n){return n!=null&&typeof n=="object"}var B0=xi?di(xi):rm;function Z3(n,o){return n===o||Ff(n,o,au(o))}function ey(n,o,f){return f=typeof f=="function"?f:t,Ff(n,o,au(o),f)}function ty(n){return $0(n)&&n!=+n}function ry(n){if(Lm(n))throw new lt(a);return Pl(n)}function iy(n){return n===null}function ny(n){return n==null}function $0(n){return typeof n=="number"||Xt(n)&&Lr(n)==ge}function Eo(n){if(!Xt(n)||Lr(n)!=Te)return!1;var o=$c(n);if(o===null)return!0;var f=$t.call(o,"constructor")&&o.constructor;return typeof f=="function"&&f instanceof f&&Tc.call(f)==e2}var bu=pn?di(pn):im;function sy(n){return D0(n)&&n>=-S&&n<=S}var k0=ho?di(ho):nm;function uh(n){return typeof n=="string"||!gt(n)&&Xt(n)&&Lr(n)==_e}function pi(n){return typeof n=="symbol"||Xt(n)&&Lr(n)==je}var Pa=Bs?di(Bs):sm;function ay(n){return n===t}function oy(n){return Xt(n)&&Dr(n)==me}function cy(n){return Xt(n)&&Lr(n)==Fe}var hy=th(Hf),fy=th(function(n,o){return n<=o});function L0(n){if(!n)return[];if(Zr(n))return uh(n)?Wi(n):Xr(n);if(uo&&n[uo])return jb(n[uo]());var o=Dr(n),f=o==ae?Of:o==ke?Nc:Ra;return f(n)}function Qn(n){if(!n)return n===0?n:0;if(n=Ni(n),n===M||n===-M){var o=n<0?-1:1;return o*x}return n===n?n:0}function mt(n){var o=Qn(n),f=o%1;return o===o?f?o-f:o:0}function z0(n){return n?zs(mt(n),0,l):0}function Ni(n){if(typeof n=="number")return n;if(pi(n))return u;if(Qt(n)){var o=typeof n.valueOf=="function"?n.valueOf():n;n=Qt(o)?o+"":o}if(typeof n!="string")return n===0?n:+n;n=sl(n);var f=Nr.test(n);return f||Or.test(n)?pt(n.slice(2),f?2:8):Rr.test(n)?u:+n}function U0(n){return vn(n,ei(n))}function uy(n){return n?zs(mt(n),-S,S):n===0?n:0}function Dt(n){return n==null?"":li(n)}var dy=Ea(function(n,o){if(xo(o)||Zr(o)){vn(o,gr(o),n);return}for(var f in o)$t.call(o,f)&&bo(n,f,o[f])}),j0=Ea(function(n,o){vn(o,ei(o),n)}),dh=Ea(function(n,o,f,w){vn(o,ei(o),n,w)}),ly=Ea(function(n,o,f,w){vn(o,gr(o),n,w)}),py=Gn(kf);function gy(n,o){var f=Ia(n);return o==null?f:wl(f,o)}var vy=_t(function(n,o){n=Ft(n);var f=-1,w=o.length,P=w>2?o[2]:t;for(P&&zr(o[0],o[1],P)&&(w=1);++f<w;)for(var T=o[f],U=ei(T),F=-1,G=U.length;++F<G;){var ie=U[F],ne=n[ie];(ne===t||Yi(ne,_a[ie])&&!$t.call(n,ie))&&(n[ie]=T[ie])}return n}),by=_t(function(n){return n.push(t,s0),pr(F0,t,n)});function my(n,o){return tl(n,Ze(o,3),gn)}function yy(n,o){return tl(n,Ze(o,3),zf)}function wy(n,o){return n==null?n:Lf(n,Ze(o,3),ei)}function _y(n,o){return n==null?n:El(n,Ze(o,3),ei)}function Ay(n,o){return n&&gn(n,Ze(o,3))}function xy(n,o){return n&&zf(n,Ze(o,3))}function Iy(n){return n==null?[]:Gc(n,gr(n))}function Ey(n){return n==null?[]:Gc(n,ei(n))}function mu(n,o,f){var w=n==null?t:Us(n,o);return w===t?f:w}function My(n,o){return n!=null&&c0(n,o,W2)}function yu(n,o){return n!=null&&c0(n,o,Q2)}var Sy=e0(function(n,o,f){o!=null&&typeof o.toString!="function"&&(o=qc.call(o)),n[o]=f},_u(ti)),Py=e0(function(n,o,f){o!=null&&typeof o.toString!="function"&&(o=qc.call(o)),$t.call(n,o)?n[o].push(f):n[o]=[f]},Ze),Ry=_t(yo);function gr(n){return Zr(n)?ml(n):Kf(n)}function ei(n){return Zr(n)?ml(n,!0):am(n)}function Ny(n,o){var f={};return o=Ze(o,3),gn(n,function(w,P,T){Hn(f,o(w,P,T),w)}),f}function Cy(n,o){var f={};return o=Ze(o,3),gn(n,function(w,P,T){Hn(f,P,o(w,P,T))}),f}var Oy=Ea(function(n,o,f){Jc(n,o,f)}),F0=Ea(function(n,o,f,w){Jc(n,o,f,w)}),Ty=Gn(function(n,o){var f={};if(n==null)return f;var w=!1;o=Wt(o,function(T){return T=bs(T,n),w||(w=T.length>1),T}),vn(n,nu(n),f),w&&(f=Si(f,I|N|O,Sm));for(var P=o.length;P--;)Qf(f,o[P]);return f});function qy(n,o){return K0(n,hh(Ze(o)))}var Dy=Gn(function(n,o){return n==null?{}:cm(n,o)});function K0(n,o){if(n==null)return{};var f=Wt(nu(n),function(w){return[w]});return o=Ze(o),Dl(n,f,function(w,P){return o(w,P[0])})}function By(n,o,f){o=bs(o,n);var w=-1,P=o.length;for(P||(P=1,n=t);++w<P;){var T=n==null?t:n[bn(o[w])];T===t&&(w=P,T=f),n=Wn(T)?T.call(n):T}return n}function $y(n,o,f){return n==null?n:_o(n,o,f)}function ky(n,o,f,w){return w=typeof w=="function"?w:t,n==null?n:_o(n,o,f,w)}var H0=i0(gr),V0=i0(ei);function Ly(n,o,f){var w=gt(n),P=w||ys(n)||Pa(n);if(o=Ze(o,4),f==null){var T=n&&n.constructor;P?f=w?new T:[]:Qt(n)?f=Wn(T)?Ia($c(n)):{}:f={}}return(P?Ii:gn)(n,function(U,F,G){return o(f,U,F,G)}),f}function zy(n,o){return n==null?!0:Qf(n,o)}function Uy(n,o,f){return n==null?n:zl(n,o,Zf(f))}function jy(n,o,f,w){return w=typeof w=="function"?w:t,n==null?n:zl(n,o,Zf(f),w)}function Ra(n){return n==null?[]:Cf(n,gr(n))}function Fy(n){return n==null?[]:Cf(n,ei(n))}function Ky(n,o,f){return f===t&&(f=o,o=t),f!==t&&(f=Ni(f),f=f===f?f:0),o!==t&&(o=Ni(o),o=o===o?o:0),zs(Ni(n),o,f)}function Hy(n,o,f){return o=Qn(o),f===t?(f=o,o=0):f=Qn(f),n=Ni(n),Y2(n,o,f)}function Vy(n,o,f){if(f&&typeof f!="boolean"&&zr(n,o,f)&&(o=f=t),f===t&&(typeof o=="boolean"?(f=o,o=t):typeof n=="boolean"&&(f=n,n=t)),n===t&&o===t?(n=0,o=1):(n=Qn(n),o===t?(o=n,n=0):o=Qn(o)),n>o){var w=n;n=o,o=w}if(f||n%1||o%1){var P=vl();return qr(n+P*(o-n+Ut("1e-"+((P+"").length-1))),o)}return Gf(n,o)}var Gy=Ma(function(n,o,f){return o=o.toLowerCase(),n+(f?G0(o):o)});function G0(n){return wu(Dt(n).toLowerCase())}function J0(n){return n=Dt(n),n&&n.replace(Yt,$b).replace(Af,"")}function Jy(n,o,f){n=Dt(n),o=li(o);var w=n.length;f=f===t?w:zs(mt(f),0,w);var P=f;return f-=o.length,f>=0&&n.slice(f,P)==o}function Wy(n){return n=Dt(n),n&&Ke.test(n)?n.replace(Et,kb):n}function Qy(n){return n=Dt(n),n&&Ne.test(n)?n.replace(Ye,"\\$&"):n}var Yy=Ma(function(n,o,f){return n+(f?"-":"")+o.toLowerCase()}),Xy=Ma(function(n,o,f){return n+(f?" ":"")+o.toLowerCase()}),Zy=Yl("toLowerCase");function e5(n,o,f){n=Dt(n),o=mt(o);var w=o?ya(n):0;if(!o||w>=o)return n;var P=(o-w)/2;return eh(Uc(P),f)+n+eh(zc(P),f)}function t5(n,o,f){n=Dt(n),o=mt(o);var w=o?ya(n):0;return o&&w<o?n+eh(o-w,f):n}function r5(n,o,f){n=Dt(n),o=mt(o);var w=o?ya(n):0;return o&&w<o?eh(o-w,f)+n:n}function i5(n,o,f){return f||o==null?o=0:o&&(o=+o),f2(Dt(n).replace(Xe,""),o||0)}function n5(n,o,f){return(f?zr(n,o,f):o===t)?o=1:o=mt(o),Jf(Dt(n),o)}function s5(){var n=arguments,o=Dt(n[0]);return n.length<3?o:o.replace(n[1],n[2])}var a5=Ma(function(n,o,f){return n+(f?"_":"")+o.toLowerCase()});function o5(n,o,f){return f&&typeof f!="number"&&zr(n,o,f)&&(o=f=t),f=f===t?l:f>>>0,f?(n=Dt(n),n&&(typeof o=="string"||o!=null&&!bu(o))&&(o=li(o),!o&&ma(n))?ms(Wi(n),0,f):n.split(o,f)):[]}var c5=Ma(function(n,o,f){return n+(f?" ":"")+wu(o)});function h5(n,o,f){return n=Dt(n),f=f==null?0:zs(mt(f),0,n.length),o=li(o),n.slice(f,f+o.length)==o}function f5(n,o,f){var w=C.templateSettings;f&&zr(n,o,f)&&(o=t),n=Dt(n),o=dh({},o,w,n0);var P=dh({},o.imports,w.imports,n0),T=gr(P),U=Cf(P,T),F,G,ie=0,ne=o.interpolate||Jr,he="__p += '",ye=Tf((o.escape||Jr).source+"|"+ne.source+"|"+(ne===Je?tt:Jr).source+"|"+(o.evaluate||Jr).source+"|$","g"),$e="//# sourceURL="+($t.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++xf+"]")+`
`;n.replace(ye,function(it,xt,Ct,gi,Ur,vi){return Ct||(Ct=gi),he+=n.slice(ie,vi).replace(ji,Lb),xt&&(F=!0,he+=`' +
__e(`+xt+`) +
'`),Ur&&(G=!0,he+=`';
`+Ur+`;
__p += '`),Ct&&(he+=`' +
((__t = (`+Ct+`)) == null ? '' : __t) +
'`),ie=vi+it.length,it}),he+=`';
`;var rt=$t.call(o,"variable")&&o.variable;if(!rt)he=`with (obj) {
`+he+`
}
`;else if(Ot.test(rt))throw new lt(p);he=(G?he.replace(wt,""):he).replace(dt,"$1").replace(ze,"$1;"),he="function("+(rt||"obj")+`) {
`+(rt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(F?", __e = _.escape":"")+(G?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+he+`return __p
}`;var yt=Q0(function(){return qt(T,$e+"return "+he).apply(t,U)});if(yt.source=he,vu(yt))throw yt;return yt}function u5(n){return Dt(n).toLowerCase()}function d5(n){return Dt(n).toUpperCase()}function l5(n,o,f){if(n=Dt(n),n&&(f||o===t))return sl(n);if(!n||!(o=li(o)))return n;var w=Wi(n),P=Wi(o),T=al(w,P),U=ol(w,P)+1;return ms(w,T,U).join("")}function p5(n,o,f){if(n=Dt(n),n&&(f||o===t))return n.slice(0,hl(n)+1);if(!n||!(o=li(o)))return n;var w=Wi(n),P=ol(w,Wi(o))+1;return ms(w,0,P).join("")}function g5(n,o,f){if(n=Dt(n),n&&(f||o===t))return n.replace(Xe,"");if(!n||!(o=li(o)))return n;var w=Wi(n),P=al(w,Wi(o));return ms(w,P).join("")}function v5(n,o){var f=ht,w=k;if(Qt(o)){var P="separator"in o?o.separator:P;f="length"in o?mt(o.length):f,w="omission"in o?li(o.omission):w}n=Dt(n);var T=n.length;if(ma(n)){var U=Wi(n);T=U.length}if(f>=T)return n;var F=f-ya(w);if(F<1)return w;var G=U?ms(U,0,F).join(""):n.slice(0,F);if(P===t)return G+w;if(U&&(F+=G.length-F),bu(P)){if(n.slice(F).search(P)){var ie,ne=G;for(P.global||(P=Tf(P.source,Dt(bt.exec(P))+"g")),P.lastIndex=0;ie=P.exec(ne);)var he=ie.index;G=G.slice(0,he===t?F:he)}}else if(n.indexOf(li(P),F)!=F){var ye=G.lastIndexOf(P);ye>-1&&(G=G.slice(0,ye))}return G+w}function b5(n){return n=Dt(n),n&&xe.test(n)?n.replace(At,Vb):n}var m5=Ma(function(n,o,f){return n+(f?" ":"")+o.toUpperCase()}),wu=Yl("toUpperCase");function W0(n,o,f){return n=Dt(n),o=f?t:o,o===t?Ub(n)?Wb(n):Ob(n):n.match(o)||[]}var Q0=_t(function(n,o){try{return pr(n,t,o)}catch(f){return vu(f)?f:new lt(f)}}),y5=Gn(function(n,o){return Ii(o,function(f){f=bn(f),Hn(n,f,pu(n[f],n))}),n});function w5(n){var o=n==null?0:n.length,f=Ze();return n=o?Wt(n,function(w){if(typeof w[1]!="function")throw new Ei(h);return[f(w[0]),w[1]]}):[],_t(function(w){for(var P=-1;++P<o;){var T=n[P];if(pr(T[0],this,w))return pr(T[1],this,w)}})}function _5(n){return V2(Si(n,I))}function _u(n){return function(){return n}}function A5(n,o){return n==null||n!==n?o:n}var x5=Zl(),I5=Zl(!0);function ti(n){return n}function Au(n){return Rl(typeof n=="function"?n:Si(n,I))}function E5(n){return Cl(Si(n,I))}function M5(n,o){return Ol(n,Si(o,I))}var S5=_t(function(n,o){return function(f){return yo(f,n,o)}}),P5=_t(function(n,o){return function(f){return yo(n,f,o)}});function xu(n,o,f){var w=gr(o),P=Gc(o,w);f==null&&!(Qt(o)&&(P.length||!w.length))&&(f=o,o=n,n=this,P=Gc(o,gr(o)));var T=!(Qt(f)&&"chain"in f)||!!f.chain,U=Wn(n);return Ii(P,function(F){var G=o[F];n[F]=G,U&&(n.prototype[F]=function(){var ie=this.__chain__;if(T||ie){var ne=n(this.__wrapped__),he=ne.__actions__=Xr(this.__actions__);return he.push({func:G,args:arguments,thisArg:n}),ne.__chain__=ie,ne}return G.apply(n,ds([this.value()],arguments))})}),n}function R5(){return Nt._===this&&(Nt._=t2),this}function Iu(){}function N5(n){return n=mt(n),_t(function(o){return Tl(o,n)})}var C5=tu(Wt),O5=tu(el),T5=tu(Mf);function Y0(n){return cu(n)?Sf(bn(n)):hm(n)}function q5(n){return function(o){return n==null?t:Us(n,o)}}var D5=t0(),B5=t0(!0);function Eu(){return[]}function Mu(){return!1}function $5(){return{}}function k5(){return""}function L5(){return!0}function z5(n,o){if(n=mt(n),n<1||n>S)return[];var f=l,w=qr(n,l);o=Ze(o),n-=l;for(var P=Nf(w,o);++f<n;)o(f);return P}function U5(n){return gt(n)?Wt(n,bn):pi(n)?[n]:Xr(b0(Dt(n)))}function j5(n){var o=++Zb;return Dt(n)+o}var F5=Zc(function(n,o){return n+o},0),K5=ru("ceil"),H5=Zc(function(n,o){return n/o},1),V5=ru("floor");function G5(n){return n&&n.length?Vc(n,ti,Uf):t}function J5(n,o){return n&&n.length?Vc(n,Ze(o,2),Uf):t}function W5(n){return il(n,ti)}function Q5(n,o){return il(n,Ze(o,2))}function Y5(n){return n&&n.length?Vc(n,ti,Hf):t}function X5(n,o){return n&&n.length?Vc(n,Ze(o,2),Hf):t}var Z5=Zc(function(n,o){return n*o},1),ew=ru("round"),tw=Zc(function(n,o){return n-o},0);function rw(n){return n&&n.length?Rf(n,ti):0}function iw(n,o){return n&&n.length?Rf(n,Ze(o,2)):0}return C.after=E3,C.ary=P0,C.assign=dy,C.assignIn=j0,C.assignInWith=dh,C.assignWith=ly,C.at=py,C.before=R0,C.bind=pu,C.bindAll=y5,C.bindKey=N0,C.castArray=$3,C.chain=E0,C.chunk=Vm,C.compact=Gm,C.concat=Jm,C.cond=w5,C.conforms=_5,C.constant=_u,C.countBy=r3,C.create=gy,C.curry=C0,C.curryRight=O0,C.debounce=T0,C.defaults=vy,C.defaultsDeep=by,C.defer=M3,C.delay=S3,C.difference=Wm,C.differenceBy=Qm,C.differenceWith=Ym,C.drop=Xm,C.dropRight=Zm,C.dropRightWhile=e6,C.dropWhile=t6,C.fill=r6,C.filter=n3,C.flatMap=o3,C.flatMapDeep=c3,C.flatMapDepth=h3,C.flatten=_0,C.flattenDeep=i6,C.flattenDepth=n6,C.flip=P3,C.flow=x5,C.flowRight=I5,C.fromPairs=s6,C.functions=Iy,C.functionsIn=Ey,C.groupBy=f3,C.initial=o6,C.intersection=c6,C.intersectionBy=h6,C.intersectionWith=f6,C.invert=Sy,C.invertBy=Py,C.invokeMap=d3,C.iteratee=Au,C.keyBy=l3,C.keys=gr,C.keysIn=ei,C.map=ah,C.mapKeys=Ny,C.mapValues=Cy,C.matches=E5,C.matchesProperty=M5,C.memoize=ch,C.merge=Oy,C.mergeWith=F0,C.method=S5,C.methodOf=P5,C.mixin=xu,C.negate=hh,C.nthArg=N5,C.omit=Ty,C.omitBy=qy,C.once=R3,C.orderBy=p3,C.over=C5,C.overArgs=N3,C.overEvery=O5,C.overSome=T5,C.partial=gu,C.partialRight=q0,C.partition=g3,C.pick=Dy,C.pickBy=K0,C.property=Y0,C.propertyOf=q5,C.pull=p6,C.pullAll=x0,C.pullAllBy=g6,C.pullAllWith=v6,C.pullAt=b6,C.range=D5,C.rangeRight=B5,C.rearg=C3,C.reject=m3,C.remove=m6,C.rest=O3,C.reverse=du,C.sampleSize=w3,C.set=$y,C.setWith=ky,C.shuffle=_3,C.slice=y6,C.sortBy=I3,C.sortedUniq=M6,C.sortedUniqBy=S6,C.split=o5,C.spread=T3,C.tail=P6,C.take=R6,C.takeRight=N6,C.takeRightWhile=C6,C.takeWhile=O6,C.tap=G6,C.throttle=q3,C.thru=sh,C.toArray=L0,C.toPairs=H0,C.toPairsIn=V0,C.toPath=U5,C.toPlainObject=U0,C.transform=Ly,C.unary=D3,C.union=T6,C.unionBy=q6,C.unionWith=D6,C.uniq=B6,C.uniqBy=$6,C.uniqWith=k6,C.unset=zy,C.unzip=lu,C.unzipWith=I0,C.update=Uy,C.updateWith=jy,C.values=Ra,C.valuesIn=Fy,C.without=L6,C.words=W0,C.wrap=B3,C.xor=z6,C.xorBy=U6,C.xorWith=j6,C.zip=F6,C.zipObject=K6,C.zipObjectDeep=H6,C.zipWith=V6,C.entries=H0,C.entriesIn=V0,C.extend=j0,C.extendWith=dh,xu(C,C),C.add=F5,C.attempt=Q0,C.camelCase=Gy,C.capitalize=G0,C.ceil=K5,C.clamp=Ky,C.clone=k3,C.cloneDeep=z3,C.cloneDeepWith=U3,C.cloneWith=L3,C.conformsTo=j3,C.deburr=J0,C.defaultTo=A5,C.divide=H5,C.endsWith=Jy,C.eq=Yi,C.escape=Wy,C.escapeRegExp=Qy,C.every=i3,C.find=s3,C.findIndex=y0,C.findKey=my,C.findLast=a3,C.findLastIndex=w0,C.findLastKey=yy,C.floor=V5,C.forEach=M0,C.forEachRight=S0,C.forIn=wy,C.forInRight=_y,C.forOwn=Ay,C.forOwnRight=xy,C.get=mu,C.gt=F3,C.gte=K3,C.has=My,C.hasIn=yu,C.head=A0,C.identity=ti,C.includes=u3,C.indexOf=a6,C.inRange=Hy,C.invoke=Ry,C.isArguments=Ks,C.isArray=gt,C.isArrayBuffer=H3,C.isArrayLike=Zr,C.isArrayLikeObject=ir,C.isBoolean=V3,C.isBuffer=ys,C.isDate=G3,C.isElement=J3,C.isEmpty=W3,C.isEqual=Q3,C.isEqualWith=Y3,C.isError=vu,C.isFinite=X3,C.isFunction=Wn,C.isInteger=D0,C.isLength=fh,C.isMap=B0,C.isMatch=Z3,C.isMatchWith=ey,C.isNaN=ty,C.isNative=ry,C.isNil=ny,C.isNull=iy,C.isNumber=$0,C.isObject=Qt,C.isObjectLike=Xt,C.isPlainObject=Eo,C.isRegExp=bu,C.isSafeInteger=sy,C.isSet=k0,C.isString=uh,C.isSymbol=pi,C.isTypedArray=Pa,C.isUndefined=ay,C.isWeakMap=oy,C.isWeakSet=cy,C.join=u6,C.kebabCase=Yy,C.last=Ri,C.lastIndexOf=d6,C.lowerCase=Xy,C.lowerFirst=Zy,C.lt=hy,C.lte=fy,C.max=G5,C.maxBy=J5,C.mean=W5,C.meanBy=Q5,C.min=Y5,C.minBy=X5,C.stubArray=Eu,C.stubFalse=Mu,C.stubObject=$5,C.stubString=k5,C.stubTrue=L5,C.multiply=Z5,C.nth=l6,C.noConflict=R5,C.noop=Iu,C.now=oh,C.pad=e5,C.padEnd=t5,C.padStart=r5,C.parseInt=i5,C.random=Vy,C.reduce=v3,C.reduceRight=b3,C.repeat=n5,C.replace=s5,C.result=By,C.round=ew,C.runInContext=V,C.sample=y3,C.size=A3,C.snakeCase=a5,C.some=x3,C.sortedIndex=w6,C.sortedIndexBy=_6,C.sortedIndexOf=A6,C.sortedLastIndex=x6,C.sortedLastIndexBy=I6,C.sortedLastIndexOf=E6,C.startCase=c5,C.startsWith=h5,C.subtract=tw,C.sum=rw,C.sumBy=iw,C.template=f5,C.times=z5,C.toFinite=Qn,C.toInteger=mt,C.toLength=z0,C.toLower=u5,C.toNumber=Ni,C.toSafeInteger=uy,C.toString=Dt,C.toUpper=d5,C.trim=l5,C.trimEnd=p5,C.trimStart=g5,C.truncate=v5,C.unescape=b5,C.uniqueId=j5,C.upperCase=m5,C.upperFirst=wu,C.each=M0,C.eachRight=S0,C.first=A0,xu(C,function(){var n={};return gn(C,function(o,f){$t.call(C.prototype,f)||(n[f]=o)}),n}(),{chain:!1}),C.VERSION=i,Ii(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){C[n].placeholder=C}),Ii(["drop","take"],function(n,o){Mt.prototype[n]=function(f){f=f===t?1:ur(mt(f),0);var w=this.__filtered__&&!o?new Mt(this):this.clone();return w.__filtered__?w.__takeCount__=qr(f,w.__takeCount__):w.__views__.push({size:qr(f,l),type:n+(w.__dir__<0?"Right":"")}),w},Mt.prototype[n+"Right"]=function(f){return this.reverse()[n](f).reverse()}}),Ii(["filter","map","takeWhile"],function(n,o){var f=o+1,w=f==d||f==A;Mt.prototype[n]=function(P){var T=this.clone();return T.__iteratees__.push({iteratee:Ze(P,3),type:f}),T.__filtered__=T.__filtered__||w,T}}),Ii(["head","last"],function(n,o){var f="take"+(o?"Right":"");Mt.prototype[n]=function(){return this[f](1).value()[0]}}),Ii(["initial","tail"],function(n,o){var f="drop"+(o?"":"Right");Mt.prototype[n]=function(){return this.__filtered__?new Mt(this):this[f](1)}}),Mt.prototype.compact=function(){return this.filter(ti)},Mt.prototype.find=function(n){return this.filter(n).head()},Mt.prototype.findLast=function(n){return this.reverse().find(n)},Mt.prototype.invokeMap=_t(function(n,o){return typeof n=="function"?new Mt(this):this.map(function(f){return yo(f,n,o)})}),Mt.prototype.reject=function(n){return this.filter(hh(Ze(n)))},Mt.prototype.slice=function(n,o){n=mt(n);var f=this;return f.__filtered__&&(n>0||o<0)?new Mt(f):(n<0?f=f.takeRight(-n):n&&(f=f.drop(n)),o!==t&&(o=mt(o),f=o<0?f.dropRight(-o):f.take(o-n)),f)},Mt.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},Mt.prototype.toArray=function(){return this.take(l)},gn(Mt.prototype,function(n,o){var f=/^(?:filter|find|map|reject)|While$/.test(o),w=/^(?:head|last)$/.test(o),P=C[w?"take"+(o=="last"?"Right":""):o],T=w||/^find/.test(o);P&&(C.prototype[o]=function(){var U=this.__wrapped__,F=w?[1]:arguments,G=U instanceof Mt,ie=F[0],ne=G||gt(U),he=function(xt){var Ct=P.apply(C,ds([xt],F));return w&&ye?Ct[0]:Ct};ne&&f&&typeof ie=="function"&&ie.length!=1&&(G=ne=!1);var ye=this.__chain__,$e=!!this.__actions__.length,rt=T&&!ye,yt=G&&!$e;if(!T&&ne){U=yt?U:new Mt(this);var it=n.apply(U,F);return it.__actions__.push({func:sh,args:[he],thisArg:t}),new Mi(it,ye)}return rt&&yt?n.apply(this,F):(it=this.thru(he),rt?w?it.value()[0]:it.value():it)})}),Ii(["pop","push","shift","sort","splice","unshift"],function(n){var o=Cc[n],f=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",w=/^(?:pop|shift)$/.test(n);C.prototype[n]=function(){var P=arguments;if(w&&!this.__chain__){var T=this.value();return o.apply(gt(T)?T:[],P)}return this[f](function(U){return o.apply(gt(U)?U:[],P)})}}),gn(Mt.prototype,function(n,o){var f=C[o];if(f){var w=f.name+"";$t.call(xa,w)||(xa[w]=[]),xa[w].push({name:o,func:f})}}),xa[Xc(t,J).name]=[{name:"wrapper",func:t}],Mt.prototype.clone=b2,Mt.prototype.reverse=m2,Mt.prototype.value=y2,C.prototype.at=J6,C.prototype.chain=W6,C.prototype.commit=Q6,C.prototype.next=Y6,C.prototype.plant=Z6,C.prototype.reverse=e3,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=t3,C.prototype.first=C.prototype.head,uo&&(C.prototype[uo]=X6),C},wa=Qb();rr?((rr.exports=wa)._=wa,jt._=wa):Nt._=wa}).call(ko)})(Ed,Ed.exports);var BP=Object.defineProperty,$P=Object.defineProperties,kP=Object.getOwnPropertyDescriptors,eg=Object.getOwnPropertySymbols,LP=Object.prototype.hasOwnProperty,zP=Object.prototype.propertyIsEnumerable,tg=(r,e,t)=>e in r?BP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ah=(r,e)=>{for(var t in e||(e={}))LP.call(e,t)&&tg(r,t,e[t]);if(eg)for(var t of eg(e))zP.call(e,t)&&tg(r,t,e[t]);return r},UP=(r,e)=>$P(r,kP(e));function fn(r,e,t){var i;const s=Ko(r);return((i=e.rpcMap)==null?void 0:i[s.reference])||`${DP}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function da(r){return r.includes(":")?r.split(":")[1]:r}function Eb(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function jP(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const i=[];return t.forEach(s=>{const a=e.namespaces[s].accounts;i.push(...a)}),i}function sd(r={},e={}){const t=rg(r),i=rg(e);return Ed.exports.merge(t,i)}function rg(r){var e,t,i,s;const a={};if(!Zo(r))return a;for(const[h,p]of Object.entries(r)){const m=Jd(h)?[h]:p.chains,v=p.methods||[],_=p.events||[],I=p.rpcMap||{},N=jo(h);a[N]=UP(Ah(Ah({},a[N]),p),{chains:Ph(m,(e=a[N])==null?void 0:e.chains),methods:Ph(v,(t=a[N])==null?void 0:t.methods),events:Ph(_,(i=a[N])==null?void 0:i.events),rpcMap:Ah(Ah({},I),(s=a[N])==null?void 0:s.rpcMap)})}return a}function FP(r){return r.includes(":")?r.split(":")[2]:r}function ig(r){const e={};for(const[t,i]of Object.entries(r)){const s=i.methods||[],a=i.events||[],h=i.accounts||[],p=Jd(t)?[t]:i.chains?i.chains:Eb(i.accounts);e[t]={chains:p,methods:s,events:a,accounts:h}}return e}function ad(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const Mb={},Bt=r=>Mb[r],od=(r,e)=>{Mb[r]=e};class KP{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=da(t);e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}var HP=Object.defineProperty,VP=Object.defineProperties,GP=Object.getOwnPropertyDescriptors,ng=Object.getOwnPropertySymbols,JP=Object.prototype.hasOwnProperty,WP=Object.prototype.propertyIsEnumerable,sg=(r,e,t)=>e in r?HP(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ag=(r,e)=>{for(var t in e||(e={}))JP.call(e,t)&&sg(r,t,e[t]);if(ng)for(var t of ng(e))WP.call(e,t)&&sg(r,t,e[t]);return r},og=(r,e)=>VP(r,GP(e));class QP{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const i=t||fn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=parseInt(da(t));e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,i;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const a=parseInt(s,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,i,s;const a=(i=(t=e.request)==null?void 0:t.params)==null?void 0:i[0];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const h=this.client.session.get(e.topic),p=((s=h==null?void 0:h.sessionProperties)==null?void 0:s.capabilities)||{};if(p!=null&&p[a])return p==null?void 0:p[a];const m=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:og(ag({},h.sessionProperties||{}),{capabilities:og(ag({},p||{}),{[a]:m})})})}catch(v){console.warn("Failed to update session with capabilities",v)}return m}}class YP{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=da(t);e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}class XP{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=da(t);e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}class ZP{constructor(e){this.name="algorand",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||fn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new un(new kn(i,Bt("disableProviderPing")))}}class eR{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const i=this.getCardanoRPCUrl(t),s=da(t);e[s]=this.createHttpProvider(s,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}class tR{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=da(t);e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}class rR{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=da(t);e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}class iR{constructor(e){this.name="near",this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||fn(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace);return typeof i>"u"?void 0:new un(new kn(i,Bt("disableProviderPing")))}}class nR{constructor(e){this.name=Oa,this.namespace=e.namespace,this.events=Bt("events"),this.client=Bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const i={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const a=Ko(s);i[`${a.namespace}:${a.reference}`]=this.createHttpProvider(s)}),i}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||fn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new un(new kn(i,Bt("disableProviderPing")))}}var sR=Object.defineProperty,aR=Object.defineProperties,oR=Object.getOwnPropertyDescriptors,cg=Object.getOwnPropertySymbols,cR=Object.prototype.hasOwnProperty,hR=Object.prototype.propertyIsEnumerable,hg=(r,e,t)=>e in r?sR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xh=(r,e)=>{for(var t in e||(e={}))cR.call(e,t)&&hg(r,t,e[t]);if(cg)for(var t of cg(e))hR.call(e,t)&&hg(r,t,e[t]);return r},cd=(r,e)=>aR(r,oR(e));class Xd{constructor(e){this.events=new Pd,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ec(Zh({level:(e==null?void 0:e.logger)||X1})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Xd(e);return await t.initialize(),t}async request(e,t,i){const[s,a]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:xh({},e),chainId:`${s}:${a}`,topic:this.session.topic,expiry:i})}sendAsync(e,t,i,s){const a=new Date().getTime();this.request(e,i,s).then(h=>t(null,tf(a,h))).catch(h=>t(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:kt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:i,response:s}=await this.client.authenticate(e,t);i&&(this.uri=i,this.events.emit("display_uri",i));const a=await s();if(this.session=a.session,this.session){const h=ig(this.session.namespaces);this.namespaces=sd(this.namespaces,h),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:s}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await s().then(a=>{this.session=a;const h=ig(a.namespaces);this.namespaces=sd(this.namespaces,h),this.persist("namespaces",this.namespaces)}).catch(a=>{if(a.message!==xb)throw a;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[i,s]=this.validateChain(e),a=this.getProvider(i);a.name===Oa?a.setDefaultChain(`${i}:${s}`,t):a.setDefaultChain(s,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Bn(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await CP.init({core:this.providerOpts.core,logger:this.providerOpts.logger||X1,relayUrl:this.providerOpts.relayUrl||OP,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>jo(t)))];od("client",this.client),od("events",this.events),od("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const i=jP(t,this.session),s=Eb(i),a=sd(this.namespaces,this.optionalNamespaces),h=cd(xh({},a[t]),{accounts:i,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new QP({namespace:h});break;case"algorand":this.rpcProviders[t]=new ZP({namespace:h});break;case"solana":this.rpcProviders[t]=new YP({namespace:h});break;case"cosmos":this.rpcProviders[t]=new XP({namespace:h});break;case"polkadot":this.rpcProviders[t]=new KP({namespace:h});break;case"cip34":this.rpcProviders[t]=new eR({namespace:h});break;case"elrond":this.rpcProviders[t]=new tR({namespace:h});break;case"multiversx":this.rpcProviders[t]=new rR({namespace:h});break;case"near":this.rpcProviders[t]=new iR({namespace:h});break;default:this.rpcProviders[Oa]?this.rpcProviders[Oa].updateNamespace(h):this.rpcProviders[Oa]=new nR({namespace:h})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:i}=t;if(i.name==="accountsChanged"){const s=i.data;s&&Bn(s)&&this.events.emit("accountsChanged",s.map(FP))}else if(i.name==="chainChanged"){const s=t.chainId,a=t.event.data,h=jo(s),p=ad(s)!==ad(a)?`${h}:${ad(a)}`:s;this.onChainChanged(p)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;const{namespaces:s}=t,a=(i=this.client)==null?void 0:i.session.get(e);this.session=cd(xh({},a),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",cd(xh({},kt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(dn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Oa]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:i,sessionProperties:s}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=s,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){const[t,i]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(h=>jo(h)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];const s=jo(Object.keys(this.namespaces)[0]),a=this.rpcProviders[s].getDefaultChain();return[s,a]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[i,s]=this.validateChain(e);s&&(t||this.getProvider(i).setDefaultChain(s),this.namespaces[i]?this.namespaces[i].defaultChain=s:this.namespaces[`${i}:${s}`]?this.namespaces[`${i}:${s}`].defaultChain=s:this.namespaces[`${i}:${s}`]={defaultChain:s},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",s))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Z1}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Z1}/${e}`)}}const fR=Xd,uR="wc",dR="ethereum_provider",lR=`${uR}@2:${dR}:`,pR="https://rpc.walletconnect.com/v1/",Md=["eth_sendTransaction","personal_sign"],gR=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],Sd=["chainChanged","accountsChanged"],vR=["chainChanged","accountsChanged","message","disconnect","connect"];var bR=Object.defineProperty,mR=Object.defineProperties,yR=Object.getOwnPropertyDescriptors,fg=Object.getOwnPropertySymbols,wR=Object.prototype.hasOwnProperty,_R=Object.prototype.propertyIsEnumerable,ug=(r,e,t)=>e in r?bR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ta=(r,e)=>{for(var t in e||(e={}))wR.call(e,t)&&ug(r,t,e[t]);if(fg)for(var t of fg(e))_R.call(e,t)&&ug(r,t,e[t]);return r},hd=(r,e)=>mR(r,yR(e));function Qh(r){return Number(r[0].split(":")[1])}function Ih(r){return`0x${r.toString(16)}`}function AR(r){const{chains:e,optionalChains:t,methods:i,optionalMethods:s,events:a,optionalEvents:h,rpcMap:p}=r;if(!Bn(e))throw new Error("Invalid chains");const m={chains:e,methods:i||Md,events:a||Sd,rpcMap:Ta({},e.length?{[Qh(e)]:p[Qh(e)]}:{})},v=a==null?void 0:a.filter(O=>!Sd.includes(O)),_=i==null?void 0:i.filter(O=>!Md.includes(O));if(!t&&!h&&!s&&!(v!=null&&v.length)&&!(_!=null&&_.length))return{required:e.length?m:void 0};const I=(v==null?void 0:v.length)&&(_==null?void 0:_.length)||!t,N={chains:[...new Set(I?m.chains.concat(t||[]):t)],methods:[...new Set(m.methods.concat(s!=null&&s.length?s:gR))],events:[...new Set(m.events.concat(h!=null&&h.length?h:vR))],rpcMap:p};return{required:e.length?m:void 0,optional:t.length?N:void 0}}class Zd{constructor(){this.events=new Li.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=lR,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Zd;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,i){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),i)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:i}=AR(this.rpc);try{const s=await new Promise(async(h,p)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(v=>{!v.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(hd(Ta({namespaces:Ta({},t&&{[this.namespace]:t})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(v=>{h(v)}).catch(v=>{p(new Error(v.message))})});if(!s)return;const a=$p(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Ih(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const i=await new Promise(async(a,h)=>{var p;this.rpc.showQrModal&&((p=this.modal)==null||p.subscribeModal(m=>{!m.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),h(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(hd(Ta({},e),{chains:this.rpc.chains}),t).then(m=>{a(m)}).catch(m=>{h(new Error(m.message))})}),s=i.session;if(s){const a=$p(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Ih(this.chainId)})}return i}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Ih(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",hd(Ta({},kt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,i;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Ih(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,i,s]=e.split(":");return{chainId:`${t}:${i}`,address:s}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,i;const s=(t=e==null?void 0:e.chains)!=null?t:[],a=(i=e==null?void 0:e.optionalChains)!=null?i:[],h=s.concat(a);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=s.length?(e==null?void 0:e.methods)||Md:[],m=s.length?(e==null?void 0:e.events)||Sd:[],v=(e==null?void 0:e.optionalMethods)||[],_=(e==null?void 0:e.optionalEvents)||[],I=(e==null?void 0:e.rpcMap)||this.buildRpcMap(h,e.projectId),N=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(O=>this.formatChainId(O)),optionalChains:a.map(O=>this.formatChainId(O)),methods:p,events:m,optionalMethods:v,optionalEvents:_,rpcMap:I,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:N,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const i={};return e.forEach(s=>{i[s]=this.getRpcUrl(s,t)}),i}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Qh(this.rpc.chains):Qh(this.rpc.optionalChains),this.signer=await fR.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:i}=await aw(()=>import("./index-DP9hJ037.js").then(s=>s.i),__vite__mapDeps([0,1,2]));t=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Ta({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:i,rpcMap:s}=e;t&&Bn(t)&&(this.rpc.chains=t.map(a=>this.formatChainId(a)),t.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)})),i&&Bn(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(a=>this.formatChainId(a)),i.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)}))}getRpcUrl(e,t){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${pR}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const YR=Zd;export{YR as EthereumProvider,vR as OPTIONAL_EVENTS,gR as OPTIONAL_METHODS,Sd as REQUIRED_EVENTS,Md as REQUIRED_METHODS,Zd as default};
